<html>
<head>
<title>Infinite Scrolling In Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Firebaseä¸­çš„æ— é™æ»šåŠ¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/infinite-scrolling-in-firebase-e28bfbc53578?source=collection_archive---------11-----------------------#2017-10-17">https://medium.com/hackernoon/infinite-scrolling-in-firebase-e28bfbc53578?source=collection_archive---------11-----------------------#2017-10-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="9434" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æœ¬æ–‡å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•åœ¨JavaScriptå’Œfirebaseä¸­å®ç°æ— é™æ»šåŠ¨ï¼Œè€Œæ— éœ€ä¿®æ”¹ç°æœ‰çš„firebaseæ•°æ®ç»“æ„ã€‚</p><p id="7a91" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘è¯•å›¾è®©è¿™ç¯‡æ–‡ç« å°½å¯èƒ½åœ°é€šç”¨å¹¶é€‚ç”¨äºæ‚¨é€‰æ‹©çš„ä»»ä½•æ¡†æ¶/åº“ï¼Œæ‰€ä»¥å¸Œæœ›å®ƒèƒ½è®©æ‚¨å¾ˆå¥½åœ°ç†è§£åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­å®ç°å®ƒæ‰€éœ€è¦ç»å†çš„æ­¥éª¤ã€‚</p><p id="dfae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ³¨æ„:å¦‚æœä½ ä¸æƒ³ç»§ç»­ä¸‹å»ï¼Œå¹¶æ€¥äºçœ‹åˆ°ä»£ç ï¼Œä½ å¯ä»¥è·³åˆ°æ–‡ç« çš„åº•éƒ¨ã€‚</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/2c2ff82926d78dee23ae553b331ebb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hyRM50LJZP5sgEg3a76Xw.png"/></div></div></figure><h2 id="0c99" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated"><strong class="ak">æ¦‚è¦</strong></h2><p id="d4d0" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸‹é¢„æœŸè¡Œä¸º:</p><ul class=""><li id="16b1" class="lb lc hu it b iu iv iy iz jc ld jg le jk lf jo lg lh li lj dt translated">åˆå§‹è·å–:æ£€ç´¢5ä¸ªæœ€æ–°çš„é¡¹ç›®</li><li id="57ec" class="lb lc hu it b iu lk iy ll jc lm jg ln jk lo jo lg lh li lj dt translated">åç»­è·å–:æ£€ç´¢æ¥ä¸‹æ¥çš„5ä¸ªæœ€æ–°é¡¹ç›®</li></ul><p id="51e8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è®©æˆ‘ä»¬è¿˜å®šä¹‰æˆ‘ä»¬å°†å‡è£…ä»firebaseä¸­è·å–çš„æµ‹è¯•æ•°æ®â€”â€”ä½¿ç”¨å‡æ•°æ®å°†æ›´å®¹æ˜“å¯è§†åŒ–æŸ¥è¯¢å‘ç”Ÿäº†ä»€ä¹ˆ:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="072a" class="kb kc hu lq b fv lu lv l lw lx">// our firebase database<br/>items: { <br/>   firstInsertedItem: { â€¦ }, // oldest<br/>   SecondInsertedItem: { â€¦ }, <br/>   ThirdInsertedItem: { â€¦ },<br/>   FourthInsertedItem: { â€¦ }, <br/>   FifthInsertedItem: { â€¦ }, <br/>   SixthInsertedItem: { â€¦ }, <br/>   SeventhInsertedItem: { â€¦ },<br/>   EighthInsertedItem: { â€¦ }, <br/>   NinethInsertedItem: { â€¦ }, <br/>   TenthInsertedItem: { â€¦ }, // newest<br/> }</span><span id="84d5" class="kb kc hu lq b fv ly lv l lw lx">// in case you were wondering about the order that I put the items // in, that's just to make it easier to follow along<br/>// and it would make no difference to us if firebase actually <br/>// stored those items in a different order internally</span></pre><h2 id="8af6" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated"><strong class="ak"> FirebaseæŒ‰é”®</strong></h2><p id="5ac5" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">è®©æˆ‘ä»¬é¦–å…ˆä»‹ç»firebaseæŒ‰é”®èƒŒåçš„é­”åŠ›ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•è®©è¿™ä¸€åˆ‡æˆä¸ºå¯èƒ½ã€‚</p><p id="7bab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">äº‹å®è¯æ˜ï¼ŒfirebaseæŒ‰é”®ä¸ä»…ä»…æ˜¯ä¸€äº›éšæœºçš„å­—ç¬¦åºåˆ—ã€‚äº‹å®ä¸Šï¼Œæ‰€æœ‰çš„<a class="ae lz" href="https://firebase.googleblog.com/2015/02/the-2120-ways-to-ensure-unique_68.html" rel="noopener ugc nofollow" target="_blank"> firebaseæŒ‰é”®</a>éƒ½ç”±æ—¶é—´æˆ³å’Œéšæœºæ•°æ®ç»„æˆï¼Œè¿™äº›æ•°æ®ä»¥ä¿®æ”¹åçš„base64å­—æ¯è¡¨ç¼–ç ï¼Œä»¥<strong class="it hv">ä¿å­˜</strong>å®ƒä»¬çš„<strong class="it hv">æ—¶é—´é¡ºåº</strong> <strong class="it hv">é¡ºåº</strong>â€”â€”å³å®ƒä»¬çš„æ’å…¥é¡ºåºã€‚</p><p id="0621" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç‰¹æ€§ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬åˆ©ç”¨firebaseçš„æ’åºæŸ¥è¯¢ã€‚</p><p id="9372" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»å®šä¹‰äº†è¿™ä¸ªé‡è¦çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­å­¦ä¹ æ•™ç¨‹äº†ã€‚</p><h2 id="ae5d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated"><strong class="ak">ç¬¬ä¸€æ­¥</strong></h2><p id="7022" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">ä¸ºäº†è®©æˆ‘ä»¬æ‰€æœ‰çš„è·å–ï¼Œåœ¨ç¬¬ä¸€æ¬¡ä¹‹åï¼Œè¿”å›æˆ‘ä»¬æœŸæœ›å®ƒä»¬è¿”å›çš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜æŸç§å¯¹æœ€æ—©çš„å…ˆå‰è·å–çš„é”®çš„å¼•ç”¨ã€‚</p><p id="0b4f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ‰€ä»¥è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œå«åš:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="cb68" class="kb kc hu lq b fv lu lv l lw lx">let referenceToOldestKey = â€˜â€™;</span></pre><h2 id="158d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated"><strong class="ak">åˆå§‹è·å–</strong></h2><p id="b063" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ¥è·å–å‰5ä¸ªæœ€æ–°æ’å…¥çš„é¡¹ç›®:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="538d" class="kb kc hu lq b fv lu lv l lw lx">firebase.database().ref(â€˜itemsâ€™)<br/> .orderByKey()<br/> .limitToLast(5)<br/> .once(â€˜valueâ€™)<br/> .then((snapshot) =&gt; { â€¦ } )<br/> .catch((error) =&gt; { â€¦ } );</span></pre><p id="9d0e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¯¥æŸ¥è¯¢æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p><p id="a6d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">- <strong class="it hv"> <em class="ma"> orderByKey </em> </strong>å°†é¡¹ç›®æŒ‰å…¶å…³é”®å­—æŒ‰æ—¶é—´é¡ºåºæ’åº(ä»æœ€è€åˆ°æœ€æ–°)<br/>-<strong class="it hv"><em class="ma">limit to last</em></strong>ä»æœ«å°¾é€‰æ‹©5ä¸ªé¡¹ç›®(ä»ç¬¬5ä¸ªå¼€å§‹)</p><p id="648a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿”å›çš„å¯¹è±¡å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="9d18" class="kb kc hu lq b fv lu lv l lw lx">{ <br/>   SixthItemFromTheEnd: { â€¦ },<br/>   SeventhItemFromTheEnd: { â€¦ },<br/>   EighthInsertedItem: { â€¦ },<br/>   NinethInsertedItem: { â€¦ },<br/>   TenthInsertedItem: { â€¦ },<br/> }</span></pre><p id="2291" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦é¢ å€’è¿™ä¸ªå¯¹è±¡çš„é¡ºåºï¼Œä½¿æœ€æ–°çš„é¡¹ç›®åœ¨é¡¶éƒ¨è€Œä¸æ˜¯åº•éƒ¨ã€‚</p><p id="94aa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬è¿™é‡Œæœ‰å‡ ä¸ªé€‰é¡¹ï¼Œå–å†³äºæ‚¨å–œæ¬¢å¦‚ä½•ç®¡ç†æ‚¨çš„åº”ç”¨ç¨‹åºçŠ¶æ€:</p><ul class=""><li id="05a5" class="lb lc hu it b iu iv iy iz jc ld jg le jk lf jo lg lh li lj dt translated">åè½¬å¯¹è±¡</li><li id="c3e9" class="lb lc hu it b iu lk iy ll jc lm jg ln jk lo jo lg lh li lj dt translated">å°†å¯¹è±¡è½¬æ¢ä¸ºå¯¹è±¡æ•°ç»„å¹¶åè½¬æ•°ç»„</li><li id="fc88" class="lb lc hu it b iu lk iy ll jc lm jg ln jk lo jo lg lh li lj dt translated">ä¿æŒå¯¹è±¡åŸæ ·ï¼Œä½†åœ¨å‘ç”¨æˆ·æ˜¾ç¤ºæ—¶è¿›è¡Œæµ…å¤åˆ¶å¹¶å½“åœºåè½¬</li></ul><p id="f2be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬å°†é€‰æ‹©ç¬¬äºŒä¸ªé€‰é¡¹ï¼Œå› ä¸ºè¿™æ˜¯å­˜å‚¨è¿™ç±»æ•°æ®æœ€æµè¡Œçš„æ–¹å¼ã€‚</p><p id="e9ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ‰€ä»¥æˆ‘ä»¬ç»™<strong class="it hv">è¡¥å……ä»¥ä¸‹å†…å®¹ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„è·å–å‡½æ•°çš„</strong>:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="e210" class="kb kc hu lq b fv lu lv l lw lx">let arrayOfKeys = Object.keys(snapshot.val())<br/>   .sort()<br/>   .reverse();</span><span id="7f8c" class="kb kc hu lq b fv ly lv l lw lx">let results = arrayOfKeys<br/>   .map((key) =&gt; snapshot.val()[key]);</span></pre><p id="98f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨åè½¬é”®çš„é¡ºåºä¹‹å‰å¯¹å®ƒä»¬è¿›è¡Œäº†æ’åºâ€”â€”è¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿æ­£ç¡®çš„é¡ºåºï¼Œå› ä¸ºJavaScriptä¸ä¿è¯å¯¹è±¡é”®çš„é¡ºåºã€‚</p><p id="91f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç”¨5ä¸ªé”®ä¸­æœ€è€çš„é”®æ¥åˆå§‹åŒ–æˆ‘ä»¬çš„å¼•ç”¨ï¼Œä»¥ä¾¿å½“ç”¨æˆ·æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨æ—¶ï¼Œæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªè·å–å‡½æ•°çŸ¥é“ä»å“ªé‡Œç»§ç»­:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="5e19" class="kb kc hu lq b fv lu lv l lw lx">referenceToOldestKey = arrayOfKeys[arrayOfKeys.length-1];</span></pre><p id="2011" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">(æœ€è€çš„é”®åœ¨æœ€åä¸€ä¸ªä½ç½®ï¼Œå› ä¸ºè®°ä½<strong class="it hv"> <em class="ma"> limitToLast </em> </strong>æŒ‰æ—¶é—´é¡ºåºè¿”å›é¡¹ç›®ï¼Œæˆ‘ä»¬é¢ å€’äº†å®ƒã€‚)</p><p id="d4c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†ç¬¬ä¸€æ¬¡æå–:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="3ae1" class="kb kc hu lq b fv lu lv l lw lx">// You can do what you want to do with the data, i.e.<br/>// append to page or dispatch({ â€¦ }) if using redux</span></pre><h2 id="80b9" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated"><strong class="ak">ä¸‹ä¸€æ¬¡å–è´§</strong></h2><p id="4ac1" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">å¥½äº†ï¼Œæˆ‘ä»¬çš„ç”¨æˆ·åˆšåˆšç‚¹å‡»äº†é¡µé¢åº•éƒ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡åˆ›å»ºä»¥ä¸‹æŸ¥è¯¢ä¸ºä»–ä»¬è·å–æ¥ä¸‹æ¥çš„5ä¸ªæœ€æ–°é¡¹ç›®:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="deca" class="kb kc hu lq b fv lu lv l lw lx">firebase.database().ref(â€˜itemsâ€™)<br/> .orderByKey()<br/> .endAt(referenceToOldestKey)<br/> .limitToLast(6)<br/> .once(â€˜valueâ€™)<br/> .then((snapshot) =&gt; { â€¦ } )<br/> .catch((error) =&gt; { â€¦ } );</span></pre><p id="3dfa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¯¥æŸ¥è¯¢æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p><ul class=""><li id="9152" class="lb lc hu it b iu iv iy iz jc ld jg le jk lf jo lg lh li lj dt translated"><strong class="it hv"> <em class="ma"> orderByKey </em> </strong>æŒ‰å…³é”®å­—æŒ‰æ—¶é—´é¡ºåº(ä»æœ€æ—©åˆ°æœ€æ–°)å¯¹é¡¹ç›®è¿›è¡Œæ’åº</li><li id="c956" class="lb lc hu it b iu lk iy ll jc lm jg ln jk lo jo lg lh li lj dt translated"><strong class="it hv"> <em class="ma"> endAt </em> </strong>é€‰æ‹©ä»ç¬¬ä¸€ä¸ªæ·»åŠ åˆ°æˆ‘ä»¬çš„å¼•ç”¨å˜é‡(<strong class="it hv">å«</strong>)ä¸­çš„æ‰€æœ‰é¡¹ç›®</li><li id="ae5a" class="lb lc hu it b iu lk iy ll jc lm jg ln jk lo jo lg lh li lj dt translated"><strong class="it hv"> <em class="ma"> limitToLast </em> </strong>ä»æœ«å°¾é€‰æ‹©6ä¸ªé¡¹ç›®(ä»ç¬¬6ä¸ªå¼€å§‹)</li></ul><p id="e898" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿”å›çš„å¯¹è±¡å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="7052" class="kb kc hu lq b fv lu lv l lw lx">{ <br/>   firstInsertedItem: { â€¦ },<br/>   SecondInsertedItem: { â€¦ },<br/>   ThirdInsertedItem: { â€¦ },<br/>   FourthInsertedItem: { â€¦ },<br/>   FifthInsertedItem: { â€¦ },<br/>   SixthInsertedItem: { â€¦ },  // our reference is included!<br/> }</span></pre><ul class=""><li id="8385" class="lb lc hu it b iu iv iy iz jc ld jg le jk lf jo lg lh li lj dt translated">ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬é™åˆ¶åˆ°6ä¸ªæœ€æ–°çš„é¡¹ç›®ï¼Œè€Œä¸æ˜¯5ä¸ªï¼Œå°±åƒæˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡è·å–ä¸­åšçš„é‚£æ ·ï¼Ÿ</li></ul><p id="4379" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å› ä¸º<strong class="it hv"> <em class="ma"> endAt </em> </strong>æ˜¯<strong class="it hv"> inclusive </strong>è¿™æ„å‘³ç€æˆ‘ä»¬çš„<strong class="it hv">å¼•ç”¨é”®</strong>åŒ…å«åœ¨è¿”å›çš„å¯¹è±¡ä¸­ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬é™åˆ¶ä¸º5ä¸ªï¼Œæˆ‘ä»¬å°†æœ€ç»ˆåªæœ‰4ä¸ªæ–°é¡¹ç›®ï¼Œå› ä¸º1ä¸ªå°†æ˜¯é‡å¤çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¯·æ±‚6ä¸ªï¼Œç„¶ååœ¨å®¢æˆ·ç«¯å¤„ç†ç¬¬6ä¸ªçš„åˆ é™¤ã€‚</p><p id="b391" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†æŸ¥è¯¢æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬åè½¬è¿”å›çš„å¯¹è±¡ï¼Œç„¶ååˆ é™¤é‡å¤çš„å¯¹è±¡ã€‚</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="e290" class="kb kc hu lq b fv lu lv l lw lx">let arrayOfKeys = Object.keys(snapshot.val())<br/>   .sort()<br/>   .reverse()<br/>   .slice(1);</span><span id="419d" class="kb kc hu lq b fv ly lv l lw lx">let results = arrayOfKeys<br/>   .map((key) =&gt; snapshot.val()[key]);</span></pre><p id="4b82" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä¸ºä»€ä¹ˆ<strong class="it hv"> <em class="ma">åˆ‡â‘ </em></strong>ï¼Ÿå› ä¸ºåœ¨<strong class="it hv"> <em class="ma">åè½¬()</em> </strong>ä¹‹åï¼Œæˆ‘ä»¬çš„å‰¯æœ¬ä»æœ€åä¸€ä¸ªä½ç½®ç§»åˆ°äº†ç¬¬ä¸€ä¸ªä½ç½®ã€‚æˆ‘ä»¬æ€ä¹ˆçŸ¥é“å®ƒä¸€å¼€å§‹æ˜¯åœ¨æœ€åçš„ä½ç½®ï¼Ÿå› ä¸ºè®°ä½é’¥åŒ™æ˜¯æŒ‰æ—¶é—´é¡ºåºå½’è¿˜çš„ã€‚</p><p id="5550" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æœ€åï¼Œæˆ‘ä»¬éœ€è¦ç”¨å½“å‰è·å–çš„æœ€æ—§çš„é”®æ¥æ›´æ–°æˆ‘ä»¬çš„å¼•ç”¨:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="3871" class="kb kc hu lq b fv lu lv l lw lx">referenceToOldestKey = arrayOfKeys[arrayOfKeys.length-1];</span></pre><p id="53f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†ç¬¬äºŒæ¬¡æå–:</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="7ec9" class="kb kc hu lq b fv lu lv l lw lx">// You can do what you want to do with the data, i.e.<br/>// append to page or dispatch({ â€¦ }) if using redux</span></pre><p id="1ea8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æœ¬æ•™ç¨‹åˆ°æ­¤ç»“æŸï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¸Œæœ›æ‚¨å­¦åˆ°äº†ä¸€äº›æ–°ä¸œè¥¿ã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç ç¤ºä¾‹ã€‚</p><h2 id="a20a" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated"><strong class="ak">å®Œæ•´çš„ä»£ç ç¤ºä¾‹</strong></h2><p id="3ec2" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">æ³¨æ„:<strong class="it hv">å†…ä»£ç é‡å¤ã€‚ç„¶åï¼Œä¸¤ä¸ªæŸ¥è¯¢ä¸­çš„</strong>æ˜¯æœ‰æ„ä½¿å…¶æ›´å®¹æ˜“é˜…è¯»ï¼Œä¸éœ€è¦åˆ°å¤„å¯»æ‰¾ç›¸å…³ä»£ç ï¼Œå¦‚æœä»£ç è¢«ç§»åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­ï¼Œåˆ™éœ€è¦è¿™æ ·åšã€‚</p><pre class="jq jr js jt fq lp lq lr ls aw lt dt"><span id="79de" class="kb kc hu lq b fv lu lv l lw lx">let referenceToOldestKey = â€˜â€™;</span><span id="c8bb" class="kb kc hu lq b fv ly lv l lw lx">if (!referenceToOldestKey) { // if initial fetch<br/> <br/>  firebase.database().ref(â€˜itemsâ€™)<br/>   .orderByKey()<br/>   .limitToLast(5)<br/>   .once(â€˜valueâ€™)<br/>   .then((snapshot) =&gt; { </span><span id="c5b8" class="kb kc hu lq b fv ly lv l lw lx">      // changing to reverse chronological order (latest first)<br/>      let arrayOfKeys = Object.keys(snapshot.val())<br/>         .sort()<br/>         .reverse();</span><span id="8c20" class="kb kc hu lq b fv ly lv l lw lx">      // transforming to array<br/>      let results = arrayOfKeys<br/>         .map((key) =&gt; snapshot.val()[key]);</span><span id="ae06" class="kb kc hu lq b fv ly lv l lw lx">      // storing reference<br/>      referenceToOldestKey = arrayOfKeys[arrayOfKeys.length-1];<br/> <br/>      // Do what you want to do with the data, i.e.<br/>      // append to page or dispatch({ â€¦ }) if using redux</span><span id="3f4d" class="kb kc hu lq b fv ly lv l lw lx">   })<br/>   .catch((error) =&gt; { â€¦ } );<br/> <br/> } else {<br/> <br/>  firebase.database().ref(â€˜itemsâ€™)<br/>   .orderByKey()<br/>   .endAt(oldestKeyReference)<br/>   .limitToLast(6)<br/>   .once(â€˜valueâ€™)<br/>   .then((snapshot) =&gt; {</span><span id="7d6c" class="kb kc hu lq b fv ly lv l lw lx">     // changing to reverse chronological order (latest first)<br/>     // &amp; removing duplicate<br/>     let arrayOfKeys = Object.keys(snapshot.val())<br/>         .sort()<br/>         .reverse()<br/>         .slice(1);</span><span id="d635" class="kb kc hu lq b fv ly lv l lw lx">      // transforming to array<br/>      let results = arrayOfKeys<br/>         .map((key) =&gt; snapshot.val()[key]);</span><span id="6bbb" class="kb kc hu lq b fv ly lv l lw lx">      // updating reference<br/>      referenceToOldestKey = arrayOfKeys[arrayOfKeys.length-1];</span><span id="3fa7" class="kb kc hu lq b fv ly lv l lw lx">      // Do what you want to do with the data, i.e.<br/>      // append to page or dispatch({ â€¦ }) if using redux</span><span id="9238" class="kb kc hu lq b fv ly lv l lw lx">   })<br/>   .catch((error) =&gt; { â€¦ } );<br/> <br/> }</span></pre><p id="4ce1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¸Œæœ›è¿™ç¯‡æ–‡ç« æ²¡æœ‰å®Œå…¨æµªè´¹ä½ çš„æ—¶é—´ï¼Œä½ å®é™…ä¸Šä»ä¸­å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿:)ã€‚</p><p id="dc8e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœä½ æ˜¯ä¸€ä¸ªæ¨ç‰¹ç”¨æˆ·ï¼Œä½ å¯ä»¥é€šè¿‡<a class="ae lz" href="https://twitter.com/linasmnew" rel="noopener ugc nofollow" target="_blank"> linasmnew </a>ï¼Œ<em class="ma">è”ç³»æˆ‘(æˆ‘æ˜¯é‚£é‡Œçš„æ–°æˆå‘˜</em>ğŸ˜… ğŸ˜„)</p></div></div>    
</body>
</html>