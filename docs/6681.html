<html>
<head>
<title>Testing Wordpress Themes and Plugins in Bitbucket Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Bitbucketç®¡é“ä¸­æµ‹è¯•Wordpressä¸»é¢˜å’Œæ’ä»¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/testing-wordpress-themes-and-plugins-in-bitbucket-pipelines-2527f2729064?source=collection_archive---------6-----------------------#2017-09-29">https://medium.com/hackernoon/testing-wordpress-themes-and-plugins-in-bitbucket-pipelines-2527f2729064?source=collection_archive---------6-----------------------#2017-09-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/fb9bf63488ccb43a1e5a902930fe43bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jSZo-wiG5t8uHl3Kzy_zzw.png"/></div></div></figure><p id="2d1c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">åœ¨è¿‡å»çš„å‡ å¤©é‡Œï¼Œæˆ‘å’Œæˆ‘çš„åŒäº‹ä»¬æ­£åœ¨å¯»æ‰¾æµ‹è¯•æ’ä»¶å’Œä¸»é¢˜çš„æœ€ä½³æ–¹æ³•ï¼Œè¿™äº›æµ‹è¯•åº”è¯¥èƒ½å¤Ÿåœ¨æˆ‘ä»¬çš„CIç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶ç¡®ä¿åœ¨éƒ¨ç½²åˆ°æŸä¸ªåœ°æ–¹ä¹‹å‰ä¸€åˆ‡éƒ½ç¬¦åˆè¦æ±‚ï¼Œè¿™æ˜¯æˆ‘å†³å®šåˆ†äº«è¿™ä¸ªçš„ä¸»è¦åŸå› ï¼Œå®ƒå¯èƒ½ä¼šå¸®åŠ©è®¸å¤šå¯»æ‰¾æ·å¾„å’Œä¸æƒ³æµªè´¹æ—¶é—´çš„å¼€å‘äººå‘˜ã€‚</p><p id="29f9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">WordPressæä¾›å¹¶æ”¯æŒä¸€ä¸ªå•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œä½†æ˜¯åªé’ˆå¯¹æ ¸å¿ƒå¼€å‘ã€‚ç„¶è€Œï¼Œå¸¦ç€ä¸€ç‚¹å¥½å¥‡å¿ƒï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æµ‹è¯•ä¸»é¢˜å’Œæ’ä»¶ã€‚</p><h1 id="9013" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">æ­¥éª¤1:å®‰è£…PHPUnit</h1><p id="c2ab" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">å¦‚æœä½¿ç”¨composerï¼Œåªéœ€ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…PHPUnit:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="6ff6" class="ln kc hu lj b fv lo lp l lq lr">curl -sS <a class="ae ka" href="https://getcomposer.org/installer" rel="noopener ugc nofollow" target="_blank">https://getcomposer.org/installer</a> | php â€” â€” install-dir=/usr/local/bin â€” filename=composer</span></pre><p id="2ff0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨æœ¬åœ°ç¯å¢ƒä¸­å®‰è£…äºŒè¿›åˆ¶æ–‡ä»¶:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="ea2e" class="ln kc hu lj b fv lo lp l lq lr">wget https://phar.phpunit.de/phpunit.phar<br/>chmod +x phpunit.phar<br/>mv phpunit.phar /usr/local/bin/phpunit</span></pre><p id="fdbe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ä¸€æ—¦å®‰è£…äº†PHPUnitï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿç›´æ¥ä»ç»ˆç«¯è¿è¡Œè¯¥å‘½ä»¤:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="0878" class="ln kc hu lj b fv lo lp l lq lr">phpunit â€” configuration=path/phpunit.xml </span></pre><p id="deff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">æˆ–ä»æ‚¨çš„ä¾›åº”å•†å¤„è·å¾—:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="1564" class="ln kc hu lj b fv lo lp l lq lr">./vendor/bin/phpunit â€” configuration=path/phpunit.xml</span></pre><h1 id="352f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">æ­¥éª¤2:è·å¾—WordPressæ¡†æ¶å¹¶é…ç½®æ‚¨çš„æµ‹è¯•æ•°æ®åº“</h1><p id="0326" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Wordpresså°†å…¶æ ¸å¿ƒæ¡†æ¶æ†ç»‘åœ¨ä¸€ä¸ªsvn repoä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹includesç›®å½•ä¸‹è½½æˆ‘ä»¬æƒ³è¦çš„å·¥å…·ã€‚</p><p id="a3e1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ä½ æƒ³åœ¨å“ªé‡Œç»„ç»‡ä½ çš„<a class="ae ka" href="https://hackernoon.com/tagged/testing" rel="noopener ugc nofollow" target="_blank">æµ‹è¯•</a>åº“ç”±ä½ å†³å®šã€‚å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°†å‡è®¾æ‚¨å°†å®ƒå…‹éš†åˆ°æ‚¨çš„WordPressæ ¹ç›®å½•ä¸‹çš„â€œtestsâ€æ–‡ä»¶å¤¹ä¸­ã€‚</p><p id="7d8e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ç¡®ä¿ä½ é€‰æ‹©çš„æ–‡ä»¶ä¸ä½ çš„Wordpressæ ¸å¿ƒç‰ˆæœ¬ç›¸åŒ¹é…ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯Wordpress 4.3ï¼Œè¿›å…¥ç»ˆç«¯å¹¶è¾“å…¥:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="2a92" class="ln kc hu lj b fv lo lp l lq lr">svn co develop.svn.wordpress.org/branches/<strong class="lj hv">4.3</strong>/tests/phpunit/includes/</span></pre><p id="326a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ä½ å°†éœ€è¦ç¬¬äºŒä¸ªWordpressé…ç½®æ–‡ä»¶ã€wp-tests-config.php T4ã€‘ï¼Œåœ¨é‚£é‡Œä½ åº”è¯¥é…ç½®ä½ çš„æ•°æ®åº“å’ŒWordpressç«™ç‚¹ä¿¡æ¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="9deb" class="ln kc hu lj b fv lo lp l lq lr">https://develop.svn.wordpress.org/trunk/wp-tests-config-sample.php</span></pre><p id="a783" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">æ³¨æ„:ç¡®ä¿ä½ ä½¿ç”¨å¦ä¸€ä¸ªæ•°æ®åº“ï¼Œå› ä¸ºWordpressåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä¼šåˆ é™¤å¹¶é‡æ–°åˆ›å»ºè¡¨æ ¼ã€‚</p><p id="c536" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">åœ¨Mysql Hostä¸­ï¼Œæˆ‘ä»¬æœ‰2ä¸ªä¸åŒçš„ä¸»æœºï¼Œâ€œMysqlâ€å’Œâ€œ127.0.0.1â€ï¼Œå› æ­¤æˆ‘ä»¬å¯¹é…ç½®æ–‡ä»¶åšäº†ä¸€ç‚¹ä¿®æ”¹ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="d38b" class="ln kc hu lj b fv lo lp l lq lr">$remote = â€œmysqlâ€;</span><span id="9f7d" class="ln kc hu lj b fv lt lp l lq lr">if(getenv(â€˜IS_PIPELINESâ€™))</span><span id="7901" class="ln kc hu lj b fv lt lp l lq lr">   $remote = â€œ127.0.0.1â€;</span></pre><p id="7a60" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">å¦‚æœæˆ‘ä»¬ä»Dockerå®¹å™¨è¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿä½¿ç”¨â€œmysqlâ€ä¸»æœºè¿›è¡Œè¿æ¥ï¼Œä½†åœ¨ç®¡é“ä¸­å´ä¸æ˜¯è¿™æ ·ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰äº†mysqlæœåŠ¡ï¼Œå¹¶ä¸”è§„åˆ™æ˜¯ä¸åŒçš„ï¼Œè¯·å‚è§<a class="ae ka" href="https://confluence.atlassian.com/bitbucket/test-with-databases-in-bitbucket-pipelines-856697462.html" rel="noopener ugc nofollow" target="_blank">https://confluence . atlassian . com/bit bucket/test-with-databases-in-bit bucket-Pipelines-856697462 . html</a></p><h1 id="1a6c" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">æ­¥éª¤3:é…ç½®æ‚¨çš„æµ‹è¯•</h1><p id="cdcc" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸ºâ€œphpunit.xmlâ€çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åœ¨å…¶ä¸­æ”¾ç½®æˆ‘ä»¬çš„æµ‹è¯•è®¾ç½®ï¼Œæ— è®ºæ‚¨å°†å®ƒæ”¾åœ¨å“ªé‡Œï¼Œå› ä¸ºæ‚¨æ€»æ˜¯å¯ä»¥åœ¨å‘½ä»¤ä¸­æŒ‡å®šå®ƒã€‚</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a3da" class="ln kc hu lj b fv lo lp l lq lr">&lt;phpunit <br/>	bootstrap=â€œ./tests/includes/bootstrap.php"<br/>	backupGlobals="false"<br/>	colors="true"<br/>	convertErrorsToExceptions="true"<br/>	convertNoticesToExceptions="true"<br/>	convertWarningsToExceptions="true"&gt;<br/>	&lt;testsuites&gt;<br/>		&lt;testsuite&gt;<br/>			&lt;directory prefix="test-" suffix=".php"&gt;./tests/&lt;/directory&gt;<br/>		&lt;/testsuite&gt;<br/>	&lt;/testsuites&gt;<br/>&lt;/phpunit&gt;</span></pre><p id="7340" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">æˆ‘ä»¬å°†è¿è¡Œå‰ç¼€ä¸ºâ€œtest-â€çš„æ¯ä¸ªæµ‹è¯•æ–‡ä»¶ã€‚/tests/"æ–‡ä»¶å¤¹ã€‚</p><p id="e591" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ç°åœ¨æœ‰äº†è¿™ä¸ªé…ç½®ï¼Œä½ å°†åªåœ¨Wordpressæ ¸å¿ƒä¸Šè¿è¡Œæµ‹è¯•ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦åœ¨ä½ è‡ªå·±çš„æ’ä»¶å’Œä¸»é¢˜ä¸Šè¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å¼•å¯¼æ–‡ä»¶:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="799b" class="ln kc hu lj b fv lo lp l lq lr">&lt;?php</span><span id="866b" class="ln kc hu lj b fv lt lp l lq lr">require_once dirname( dirname( __FILE__ ) ) . â€˜/tests/includes/functions.phpâ€™;</span><span id="80ee" class="ln kc hu lj b fv lt lp l lq lr">function _manually_load_environment() {</span><span id="b32c" class="ln kc hu lj b fv lt lp l lq lr"><em class="ls">//</em> Add your theme â€¦</span><span id="4a7c" class="ln kc hu lj b fv lt lp l lq lr">switch_theme(â€˜my_themeâ€™);</span><span id="547f" class="ln kc hu lj b fv lt lp l lq lr"><em class="ls">//</em> Update array with plugins to include â€¦</span><span id="c267" class="ln kc hu lj b fv lt lp l lq lr"><em class="ls">$plugins_to_active = array(</em></span><span id="df9c" class="ln kc hu lj b fv lt lp l lq lr"><em class="ls">â€˜your-plugin/your-plugin.phpâ€™</em></span><span id="8f3b" class="ln kc hu lj b fv lt lp l lq lr"><em class="ls">);</em></span><span id="3bed" class="ln kc hu lj b fv lt lp l lq lr">update_option( â€˜active_pluginsâ€™, $plugins_to_active );</span><span id="ec58" class="ln kc hu lj b fv lt lp l lq lr">}</span><span id="ea48" class="ln kc hu lj b fv lt lp l lq lr">tests_add_filter( â€˜muplugins_loadedâ€™, â€˜_manually_load_environmentâ€™ );</span><span id="8354" class="ln kc hu lj b fv lt lp l lq lr">require dirname( dirname( __FILE__ ) ) . â€˜/tests/includes/bootstrap.phpâ€™;</span></pre><p id="987d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ç°åœ¨ï¼Œæˆ‘æ­£åœ¨åŠ è½½æˆ‘çš„ä¸»é¢˜ï¼Œä»¥åŠè®©æˆ‘çš„Wordpresså·¥ä½œæ‰€éœ€çš„æ’ä»¶ã€‚</p><p id="eb7f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ä¸è¦å¿˜è®°æŒ‡å‘phpunit.xmlä¸Šçš„æ–°å¼•å¯¼æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="68ac" class="ln kc hu lj b fv lo lp l lq lr">bootstrap="./bootstrap.php"</span><span id="a475" class="ln kc hu lj b fv lt lp l lq lr">backupGlobals="false"</span><span id="57ef" class="ln kc hu lj b fv lt lp l lq lr">...</span></pre><h1 id="3e6f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">ç¬¬å››æ­¥:ç¼–å†™æµ‹è¯•</h1><p id="62cd" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">ä½ ç°åœ¨å·²ç»å‡†å¤‡å¥½äº†ï¼Œåƒä¸‹é¢çš„ä¾‹å­ä¸€æ ·ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªå•å…ƒæµ‹è¯•ï¼Œæ£€æŸ¥ä¸»é¢˜æ˜¯å¦æ­£ç¡®åŠ è½½ã€‚</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="ecbf" class="ln kc hu lj b fv lo lp l lq lr">&lt;?php</span><span id="fe48" class="ln kc hu lj b fv lt lp l lq lr">class VerificationTest extends <strong class="lj hv">WP_UnitTestCase</strong> {</span><span id="616d" class="ln kc hu lj b fv lt lp l lq lr">  function testTheme() {</span><span id="1c69" class="ln kc hu lj b fv lt lp l lq lr">       $this-&gt;assertTrue( â€˜my_themeâ€™ == wp_get_theme() );</span><span id="a58f" class="ln kc hu lj b fv lt lp l lq lr">  }</span><span id="38ea" class="ln kc hu lj b fv lt lp l lq lr">}</span></pre><p id="7e50" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">è¿è¡Œphpunitå‘½ä»¤ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä»¥ä¸‹å…³äºæ‚¨çš„æµ‹è¯•çš„ä¿¡æ¯:</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lu"><img src="../Images/b8acb357963c0d24a7848398c5bc1704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xel6wKjiLaE81ggvgqYbSw.png"/></div></div></figure><h1 id="23bd" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">æ­¥éª¤5:è¿™å®Œå…¨æ˜¯å…³äºCI(ä½æ¡¶ç®¡é“)</h1><p id="f148" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">å—¯ï¼Œæˆ‘æƒ³æˆ‘ä»¬å·²ç»è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒæ•´å®ƒæ¥è¿è¡ŒBitbucketå†…éƒ¨çš„æ„å»ºã€‚é˜…è¯»æ–‡æ¡£ï¼Œæˆ‘ä¸ºæˆ‘ä»¬çš„æµ‹è¯•æ•°æ®åº“ä½¿ç”¨äº†ä¸€ä¸ªâ€œmysqlâ€æœåŠ¡ã€‚</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lv"><img src="../Images/f359998e541b37daf3fa11a85f2171d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFSRwACoksB5XULpmvZuLQ.png"/></div></div></figure><p id="1f32" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">è¯·æ³¨æ„ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨æ‚¨åœ¨wp-tests-config.phpæ–‡ä»¶ä¸­æåˆ°çš„ç›¸åŒå‡­æ®ã€‚</p><p id="f888" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">æˆ‘å¸Œæœ›è¿™å°†å¯¹ä½ æœ‰ç”¨ï¼Œå¦‚æœæœ‰ä»€ä¹ˆå¯ä»¥è®¨è®ºæˆ–çº æ­£çš„ï¼Œæ¬¢è¿ä½ çš„è¯„è®ºã€‚</p><p id="a96b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">è°¢è°¢ä½ ğŸ˜ƒ</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure></div></div>    
</body>
</html>