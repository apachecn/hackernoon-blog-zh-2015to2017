<html>
<head>
<title>Deploy Angular Universal w/ Firebase ğŸš€ğŸ”¥</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">éƒ¨ç½²å¸¦ç«ç„°åŸºåº§çš„è§’å½¢é€šç”¨ğŸš€ğŸ”¥</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/deploy-angular-universal-w-firebase-ad70ea2413a1?source=collection_archive---------5-----------------------#2017-08-28">https://medium.com/hackernoon/deploy-angular-universal-w-firebase-ad70ea2413a1?source=collection_archive---------5-----------------------#2017-08-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/aa43a87d945be5de2898810f26b2232d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AyVeOIKqYMkpeZRxNOxRjg.png"/></div></div></figure><p id="a581" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">å…è´£å£°æ˜:è¿™ç¯‡åšå®¢æ–‡ç« å°†ä¸€æ­¥ä¸€æ­¥åœ°è®²è¿°å¦‚ä½•ä½¿ç”¨<a class="ae ka" href="https://hackernoon.com/tagged/firebase" rel="noopener ugc nofollow" target="_blank"> Firebase </a>ä¸»æœºéƒ¨ç½²ä¸€ä¸ªé€šç”¨çš„<a class="ae ka" href="https://hackernoon.com/tagged/angular" rel="noopener ugc nofollow" target="_blank"> Angular </a>åº”ç”¨ç¨‹åºã€‚å¯¹äºä»»ä½•å…³äºè§’åº¦é€šç”¨å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“çš„è§£é‡Šï¼Œè¿™é‡Œæœ‰ä¸€äº›æœ‰ç”¨çš„èµ„æº:</p><ul class=""><li id="90b9" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/angular/universal" rel="noopener ugc nofollow" target="_blank">è§’åº¦é€šç”¨</a></li><li id="139c" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://medium.freecodecamp.org/what-exactly-is-client-side-rendering-and-hows-it-different-from-server-side-rendering-bd5c786b340d" rel="noopener ugc nofollow" target="_blank">æœåŠ¡å™¨ç«¯æ¸²æŸ“</a></li></ul><p id="f21b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">å¦‚æœä½ æƒ³ç»§ç»­ä¸‹å»ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æºä»£ç ã€‚</p><h1 id="81af" class="kp kq hu bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">è¦æ±‚</h1><ul class=""><li id="260e" class="kb kc hu je b jf ln jj lo jn lp jr lq jv lr jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/nodejs/node" rel="noopener ugc nofollow" target="_blank"> node.js </a>(æœ¬æ•™ç¨‹æˆ‘ç”¨çš„æ˜¯v8.3.0)</li></ul><h1 id="5986" class="kp kq hu bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">ç¬¬ä¸€éƒ¨åˆ†:æ„å»ºangularåº”ç”¨ç¨‹åº(æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç‰ˆæœ¬)ğŸ”¨</h1><h2 id="75b2" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">1.å®‰è£…å…¨å±€ä¾èµ–é¡¹</h2><p id="3302" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">æˆ‘ä»¬å°†åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨<code class="eh mj mk ml mm b">@angular/cli</code>å’Œ<code class="eh mj mk ml mm b">firebase-tools</code>æ¥æ„å»ºå’Œéƒ¨ç½²æ‚¨çš„åº”ç”¨ç¨‹åºã€‚</p><ul class=""><li id="e31e" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/angular/angular-cli" rel="noopener ugc nofollow" target="_blank"> @angular/cli â‰¥ v1.3.0 </a></li><li id="472a" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/firebase/firebase-tools" rel="noopener ugc nofollow" target="_blank">firebase-tools 3 . 9 . 2ç‰ˆ</a></li></ul><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="3e71" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ npm install --global @angular/cli firebase-tools</strong></span></pre><h2 id="c32f" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">2.åˆ›å»ºæ–°çš„è§’åº¦é¡¹ç›®</h2><p id="fd97" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ä½¿ç”¨<code class="eh mj mk ml mm b">@angular/cli</code>ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„<code class="eh mj mk ml mm b">angular</code>åº”ç”¨ç¨‹åºã€‚æ—¢ç„¶è¿™æ ·ï¼Œæˆ‘å°±æŠŠå®ƒå‘½åä¸º<code class="eh mj mk ml mm b">angular-universal-firebase</code>ã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="063a" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ ng new angular-universal-firebase<br/>$ cd angular-universal-firebase</strong></span></pre><h2 id="0b78" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">3.å®‰è£…<code class="eh mj mk ml mm b">@angular/platform-server</code></h2><p id="6936" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ä¸ºäº†æ„å»ºå’Œå‘ˆç°æ‚¨çš„<code class="eh mj mk ml mm b">universal</code>åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…<code class="eh mj mk ml mm b">@angular/platform-server</code>ã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="6044" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ npm install --save @angular/platform-server</strong></span></pre><h2 id="59f2" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">4.ä¸€ç§<strong class="ak"> dd </strong> S <code class="eh mj mk ml mm b">erver Side Rendering </code>é…ç½®</h2><p id="25f5" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">æˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯å¤åˆ¶é»˜è®¤çš„<code class="eh mj mk ml mm b">app</code>é…ç½®ï¼Œå¹¶é’ˆå¯¹æœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR)é…ç½®å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚å¯¹äºSSRé…ç½®ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ·»åŠ <code class="eh mj mk ml mm b">polyfill</code>(å› ä¸ºä»£ç å°†åœ¨<code class="eh mj mk ml mm b">node</code>æœåŠ¡å™¨è€Œä¸æ˜¯æµè§ˆå™¨ä¸­è¿è¡Œ)å’Œ<code class="eh mj mk ml mm b">styles</code>(å› ä¸ºè¿™å°†åœ¨æˆ‘ä»¬é€šè¿‡<code class="eh mj mk ml mm b">@angular/platform-server</code>æ„å»ºæœåŠ¡å™¨HTMLæ—¶å¼•ç”¨ä¸»<code class="eh mj mk ml mm b">index.html</code>æ—¶æ·»åŠ )ã€‚<strong class="je hv">è¿˜è¦æ³¨æ„</strong>ï¼Œæˆ‘ä»¬æ·»åŠ äº†<code class="eh mj mk ml mm b">"platform": "server"</code>ï¼Œè¿™æ˜¯<code class="eh mj mk ml mm b">@angular/cli#v1.3.0</code>ä¸­å¼•å…¥çš„ä¸€ä¸ªç‰¹æ€§ã€‚è¿™å°†å…è®¸æˆ‘ä»¬ä½¿ç”¨<code class="eh mj mk ml mm b">@angular/cli</code>æ„å»ºæ‚¨çš„åº”ç”¨ç¨‹åºçš„SSRç‰ˆæœ¬ã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="ae4d" class="ls kq hu mm b fv mv mw l mx my">// .angular-cli.json<br/>{<br/>    ...<br/>    apps: [<br/>        { /* default config */ },<br/>        <strong class="mm hv">{<br/>            "name": "ssr",<br/>            "root": "src",<br/>            "outDir": "functions/dist-ssr",<br/>            "assets": ["assets", "favicon.ico"],<br/>            "index": "index.html",<br/>            "main": "main-ssr.ts",<br/>            "test": "test.ts",<br/>            "tsconfig": "tsconfig.app-ssr.json",<br/>            "prefix": "app",<br/>            "scripts": [],<br/>            "environmentSource": "environments/environment.ts",<br/>            "environments": {<br/>                "dev": "environments/environment.ts",<br/>                "prod": "environments/environment.prod.ts"<br/>            },<br/>            "platform": "server"<br/>        }   </strong> <br/>    ],<br/>    ...<br/>}</span></pre><h2 id="487d" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">5.ä¸ºåº”ç”¨æœåŠ¡å™¨ç‰ˆæœ¬åˆ›å»ºå¿…è¦çš„æ–‡ä»¶</h2><ul class=""><li id="3e16" class="kb kc hu je b jf ln jj lo jn lp jr lq jv lr jz kg kh ki kj dt translated"><code class="eh mj mk ml mm b">src/app/app.server.module.ts</code> <br/>ä¸ºappçš„<code class="eh mj mk ml mm b">server</code>ç‰ˆæœ¬åˆ›å»ºæ–°æ¨¡å—ã€‚</li></ul><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="c099" class="ls kq hu mm b fv mv mw l mx my">// src/app/app.server.module.ts</span><span id="2efb" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">import { NgModule } from '@angular/core';<br/>import { ServerModule } from '@angular/platform-server';<br/>import { AppModule } from './app.module';<br/>import { AppComponent } from './app.component';</strong></span><span id="d05b" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">@NgModule({<br/>    imports: [<br/>        ServerModule,<br/>        AppModule<br/>    ],<br/>    bootstrap: [AppComponent]<br/>})</strong></span><span id="8a94" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">export class AppServerModule { }</strong></span></pre><ul class=""><li id="bd22" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><code class="eh mj mk ml mm b">src/main-ssr.ts<br/></code>ä¸º<code class="eh mj mk ml mm b">server</code>æ¨¡å—åˆ›å»ºå…¥å£ç‚¹ã€‚è¿™æ˜¯æˆ‘ä»¬åœ¨<code class="eh mj mk ml mm b">.angular-cli.json</code>ä¸­åº”ç”¨çš„æœåŠ¡å™¨ç‰ˆæœ¬ä¸­å¼•ç”¨çš„<code class="eh mj mk ml mm b">main</code>æ–‡ä»¶ã€‚</li></ul><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="76e6" class="ls kq hu mm b fv mv mw l mx my">// src/main-ssr.ts</span><span id="fcc4" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">export { AppServerModule } from './app/app.server.module';</strong></span></pre><ul class=""><li id="87ba" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><code class="eh mj mk ml mm b">src/tsconfig.app-ssr.json</code> <br/>ä¸ºæœåŠ¡å™¨ç‰ˆæœ¬åˆ›å»º<code class="eh mj mk ml mm b">tsconfig</code>ã€‚ç±»ä¼¼äºæµè§ˆå™¨ç‰ˆæœ¬ï¼Œé™¤äº†<code class="eh mj mk ml mm b">angularCompilerOptions.entryModule</code>å°†å¼•ç”¨æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„æœåŠ¡å™¨ç‰ˆæœ¬çš„å…¥å£æ¨¡å—ã€‚è¿™åœ¨<code class="eh mj mk ml mm b">.angular-cli.json</code>é…ç½®ä¸­ä¹Ÿè¢«ç§°ä¸º<code class="eh mj mk ml mm b">tsconfig</code>ã€‚</li></ul><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="1acc" class="ls kq hu mm b fv mv mw l mx my">// src/tsconfig.app-ssr.json</span><span id="8a48" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">{<br/>    "extends": "../tsconfig.json",<br/>    "compilerOptions": {<br/>        "outDir": "../out-tsc/app",<br/>        "baseUrl": "./",<br/>        "module": "commonjs",<br/>        "types": []<br/>    },<br/>    "exclude": [<br/>        "test.ts",<br/>        "**/*.spec.ts"<br/>    ],<br/>    "angularCompilerOptions": {<br/>        "entryModule": "app/app.server.module#AppServerModule"<br/>    }<br/>}</strong></span></pre><h2 id="0394" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">6.åœ¨åº”ç”¨ç¨‹åºçš„æµè§ˆå™¨æ¨¡å—ä¸­åŒ…å«æœåŠ¡å™¨è½¬æ¢</h2><p id="58a6" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ç”±äºæˆ‘ä»¬æ˜¯åœ¨æµè§ˆå™¨ç‰ˆæœ¬ä¹‹å‰å°†æ‚¨çš„åº”ç”¨çš„æœåŠ¡å™¨ç‰ˆæœ¬å‘é€åˆ°æµè§ˆå™¨ï¼Œæ‰€ä»¥å½“åœ¨åº”ç”¨çš„æµè§ˆå™¨æ¨¡å—çš„<code class="eh mj mk ml mm b">imports</code>ä¸­æ·»åŠ <code class="eh mj mk ml mm b">BrowserModule</code>æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ è°ƒç”¨<code class="eh mj mk ml mm b">.withServerTransition()</code>ã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="bf6a" class="ls kq hu mm b fv mv mw l mx my">// src/app/app.module.ts</span><span id="4bbd" class="ls kq hu mm b fv mz mw l mx my">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { AppComponent } from './app.component';</span><span id="23c8" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">const APP_ID = 'angular-universal-firebase';</strong></span><span id="2f2b" class="ls kq hu mm b fv mz mw l mx my">@NgModule({<br/>    declarations: [<br/>        AppComponent<br/>    ],<br/>    imports: [<br/>        <strong class="mm hv">BrowserModule.withServerTransition({ appId: APP_ID })</strong><br/>    ],<br/>    providers: [],<br/>    bootstrap: [AppComponent]<br/>})</span><span id="d10f" class="ls kq hu mm b fv mz mw l mx my">export class AppModule { }</span></pre><p id="730c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½æ„å»ºåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨å’Œæµè§ˆå™¨ç‰ˆæœ¬äº†ï¼</p><h2 id="2928" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">7.æ„å»ºåº”ç”¨ç¨‹åºçš„æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç‰ˆæœ¬</h2><p id="10a0" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ä½¿ç”¨<code class="eh mj mk ml mm b">@angular/cli</code>ï¼Œæˆ‘ä»¬å°†æ„å»ºåº”ç”¨ç¨‹åºçš„ä¸¤ä¸ªç‰ˆæœ¬ã€‚<br/><code class="eh mj mk ml mm b">ng build -prod</code>:å°†ä½¿ç”¨<code class="eh mj mk ml mm b">prod</code>é…ç½®æ„å»ºæµè§ˆå™¨ç‰ˆæœ¬(å³ç¼©å°çš„html/js/cssã€aotç­‰)ã€‚)<br/><code class="eh mj mk ml mm b">ng build -aot -app ssr</code>:å°†æ„å»ºæœåŠ¡å™¨ç‰ˆæœ¬ã€‚å®ƒå°†ç”Ÿæˆä¸€ä¸ª<code class="eh mj mk ml mm b">ngFactory</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ¸²æŸ“<code class="eh mj mk ml mm b">node</code>ä¸­çš„åº”ç”¨ç¨‹åºã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="6580" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ ng build -prod<br/>$ ng build -aot -app ssr</strong></span></pre><p id="ebe1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">å½“ä¸¤ä¸ªæ„å»ºéƒ½å®Œæˆæ—¶ï¼Œç°åœ¨ä½ åº”è¯¥åœ¨ä½ çš„<code class="eh mj mk ml mm b">root</code>ç›®å½•ä¸­æœ‰ä¸€ä¸ª<code class="eh mj mk ml mm b">dist</code>æ–‡ä»¶å¤¹ï¼Œåœ¨ä½ çš„<code class="eh mj mk ml mm b">functions</code>ç›®å½•ä¸­æœ‰ä¸€ä¸ª<code class="eh mj mk ml mm b">dist-ssr</code>ã€‚ä¸‡å²ï¼ğŸ‰</p></div><div class="ab cl na nb hc nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="hn ho hp hq hr"><h1 id="efa4" class="kp kq hu bd kr ks nh ku kv kw ni ky kz la nj lc ld le nk lg lh li nl lk ll lm dt translated">ç¬¬äºŒéƒ¨åˆ†:ä½¿ç”¨Firebaseéƒ¨ç½²ğŸš€</h1><p id="d92d" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">[1] <em class="nm">åœ¨ç»§ç»­ä¹‹å‰ï¼Œæ‚¨åº”è¯¥å·²ç»åˆ›å»ºäº†ä¸€ä¸ªfirebaseé¡¹ç›®</em> <a class="ae ka" href="https://console.firebase.google.com" rel="noopener ugc nofollow" target="_blank"> <em class="nm">è¿™é‡Œæ˜¯</em> </a> <em class="nm">ã€‚æˆ‘ä¸ºè¿™ä¸ªæ¡ˆä¾‹å‘½åæˆ‘çš„</em> <code class="eh mj mk ml mm b"><em class="nm">angular-universal-firebase</em></code> <em class="nm">ã€‚</em></p><h2 id="0a6d" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">1.åœ¨å‘½ä»¤è¡Œä¸­ç™»å½•åˆ°`<code class="eh mj mk ml mm b">firebase</code>'</h2><p id="ddd0" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨æ‚¨åœ¨[1]ä¸­åˆ›å»ºfirebaseé¡¹ç›®æ—¶ä½¿ç”¨çš„googleå¸æˆ·ç™»å½•firebaseã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="6ecc" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ firebase login</strong></span></pre><h2 id="7be1" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">2.åœ¨â€œangularâ€é¡¹ç›®ä¸­åˆå§‹åŒ–Firebase</h2><p id="1d5a" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">é€šè¿‡å‘½ä»¤è¡Œåˆå§‹åŒ–firebaseé…ç½®:</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="6914" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ firebase init</strong></span></pre><ul class=""><li id="586b" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">é€‰æ‹©<code class="eh mj mk ml mm b">Functions</code>å’Œ<code class="eh mj mk ml mm b">Hosting</code>è¿›è¡ŒåŠŸèƒ½è®¾ç½®</li></ul><figure class="mn mo mp mq fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nn"><img src="../Images/c7e998915265ed1833c7e47fd3f47c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GbJ4R-GhuHh4UDNtrSiDaA.png"/></div></div><figcaption class="no np fg fe ff nq nr bd b be z ek">Firebase setup configuration</figcaption></figure><ul class=""><li id="334b" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">é€‰æ‹©æ‚¨åœ¨[1]ä¸­åˆ›å»ºçš„firebaseé¡¹ç›®ã€‚(æˆ‘çš„æƒ…å†µæ˜¯<code class="eh mj mk ml mm b">angular-universal-firebase</code>ã€‚</li></ul><figure class="mn mo mp mq fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ns"><img src="../Images/23a0f36eee16a1da0452b9a210805647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwE87izZt7lyKihzJHrmVg.png"/></div></div></figure><ul class=""><li id="2446" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">æ¥å—æ­¤é˜¶æ®µçš„æ‰€æœ‰é»˜è®¤å€¼ï¼›æˆ‘ä»¬å°†åœ¨åé¢çš„æ­¥éª¤ä¸­é…ç½®å…¶ä½™éƒ¨åˆ†ã€‚</li></ul><h2 id="8940" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">3.å°†åŒ…ä¾èµ–é¡¹æ·»åŠ åˆ°â€œå‡½æ•°â€</h2><p id="687b" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">å› ä¸ºæˆ‘ä»¬é€šè¿‡<code class="eh mj mk ml mm b">firebase-functions</code>ä½¿ç”¨èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨<code class="eh mj mk ml mm b">functions/package.json</code>ä¸­åŒ…å«<code class="eh mj mk ml mm b">angular</code>ä¾èµ–é¡¹æ¥å‘ˆç°åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ç‰ˆæœ¬ã€‚</p><p id="d5a3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="nm">å…ˆä¸è¯´:ç›®å‰ï¼Œæˆ‘ä¸çŸ¥é“æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥å‡è½»è¿™ç§ä¾èµ–å£°æ˜çš„é‡å¤ï¼Œå› ä¸ºæ®æˆ‘æ‰€çŸ¥ï¼Œä½ ä¸èƒ½åœ¨ä»»ä½•</em> <code class="eh mj mk ml mm b"><em class="nm">firebase-functions</em></code> <em class="nm"> javascriptæ–‡ä»¶ä¸­è®¿é—®</em> <code class="eh mj mk ml mm b"><em class="nm">functions</em></code> <em class="nm">ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚ä½†æ˜¯å¦‚æœä½ çŸ¥é“ä¸€ä¸ªæ–¹æ³•ï¼Œè¯·è®©æˆ‘çŸ¥é“ï¼</em></p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="bc22" class="ls kq hu mm b fv mv mw l mx my">// functions/package.json<br/>{<br/>    "name": "functions",<br/>    "description": "Cloud Functions for Firebase",<br/>    "dependencies": {<br/>        <strong class="mm hv">"@angular/animations": "^4.3.5",<br/>        "@angular/common": "^4.3.5",<br/>        "@angular/compiler": "^4.3.5",<br/>        "@angular/core": "^4.3.5",<br/>        "@angular/forms": "^4.3.5",<br/>        "@angular/http": "^4.3.5",<br/>        "@angular/platform-browser": "^4.3.5",<br/>        "@angular/platform-server": "^4.3.5",<br/>        "express": "^4.15.4",</strong><br/>        "firebase-admin": "~4.2.1",<br/>        "firebase-functions": "^0.5.7",<br/>        <strong class="mm hv">"rxjs": "^5.4.3",<br/>        "zone.js": "^0.8.16"</strong><br/>    },<br/>    "private": true<br/>}</span></pre><h2 id="572d" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">4.åœ¨`<code class="eh mj mk ml mm b">functions</code>'ç›®å½•ä¸‹å®‰è£…åŒ…</h2><p id="c548" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">å®‰è£…daä¾èµ–é¡¹ï¼</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="0f3c" class="ls kq hu mm b fv mv mw l mx my"># in project root<br/><strong class="mm hv">$ npm --prefix functions install</strong></span><span id="d0c5" class="ls kq hu mm b fv mz mw l mx my">or </span><span id="401f" class="ls kq hu mm b fv mz mw l mx my"># in `functions` directory<br/><strong class="mm hv">$ npm install</strong></span></pre><h2 id="3b88" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">5.å°†`<code class="eh mj mk ml mm b">dist</code>æ–‡ä»¶å¤¹å¤åˆ¶åˆ°`<code class="eh mj mk ml mm b">functions/dist</code>`ä¸­</h2><p id="da3f" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ç”±äºæ‚¨ä¸èƒ½åœ¨<code class="eh mj mk ml mm b">firebase-functions</code>ä¸­è®¿é—®<code class="eh mj mk ml mm b">functions</code>ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»å°†<code class="eh mj mk ml mm b">dist</code>ç›®å½•å¤åˆ¶åˆ°<code class="eh mj mk ml mm b">functions</code>ç›®å½•ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½åœ¨<code class="eh mj mk ml mm b">firebase-functions</code>ä¸­è®¿é—®å®ƒã€‚</p><figure class="mn mo mp mq fq iv fe ff paragraph-image"><div class="fe ff nt"><img src="../Images/0f4d8ac2e9b85643a42ab30b940e5cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*lYbueS_mQvcti6p3isjiMg.png"/></div><figcaption class="no np fg fe ff nq nr bd b be z ek">dist should now exist in root folder AND functions folder</figcaption></figure><h2 id="5816" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">6.åˆ›å»ºFirebaseå‡½æ•°ä»¥æœåŠ¡äºåº”ç”¨ç¨‹åº</h2><p id="316f" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">æˆ‘ä»¬å°†ä½¿ç”¨<code class="eh mj mk ml mm b">functions.https.onRequest</code> Firebaseå‡½æ•°ç±»å‹ä»expressæœåŠ¡å™¨å‘é€å“åº”ã€‚è¯¥æ–‡ä»¶ä¸­æœ‰è®¸å¤šå†…å®¹ï¼Œä½†æœ€å€¼å¾—æ³¨æ„çš„æ˜¯:</p><ul class=""><li id="0f49" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">å¯¼å…¥ä»<strong class="je hv">ç¬¬ä¸€éƒ¨åˆ†ç”Ÿæˆçš„<code class="eh mj mk ml mm b">AppServerModuleNgFactory</code>:æ­¥éª¤7â€”â€”æœåŠ¡å™¨ç‰ˆæœ¬</strong>ã€‚</li><li id="8ceb" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">åˆ›å»ºä¸€ä¸ª<code class="eh mj mk ml mm b">index</code>å˜é‡ï¼Œè¯¥å˜é‡è·å–æˆ‘ä»¬ä»<strong class="je hv">ç¬¬ä¸€éƒ¨åˆ†ç”Ÿæˆçš„<code class="eh mj mk ml mm b">index.html</code>æ–‡ä»¶:æ­¥éª¤7 â€”æµè§ˆå™¨ç‰ˆæœ¬ã€‚</strong></li><li id="a889" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">ä½¿ç”¨<code class="eh mj mk ml mm b">renderModuleFactory</code>ç”Ÿæˆä¸€ä¸ª<code class="eh mj mk ml mm b">html</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨<code class="eh mj mk ml mm b">url</code>å’Œ<code class="eh mj mk ml mm b">document</code>å‚æ•°ä½œä¸ºå“åº”å‘é€è¯¥æ–‡ä»¶ã€‚<br/><code class="eh mj mk ml mm b">url</code>å‚æ•°å†³å®šäº†appè¦æ¸²æŸ“çš„è·¯çº¿ã€‚æŒ‡å®šè¿™ä¸€ç‚¹å…è®¸<code class="eh mj mk ml mm b">renderModuleFactory</code>æ„å»ºè¯¥è·¯çº¿çš„<code class="eh mj mk ml mm b">html</code>ã€‚<br/><code class="eh mj mk ml mm b">document</code>æ˜¯è¦å‘ˆç°çš„é¡µé¢çš„å®Œæ•´æ–‡æ¡£HTMLã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†æ˜¯åº”ç”¨ç¨‹åºçš„æµè§ˆå™¨ç‰ˆæœ¬<code class="eh mj mk ml mm b">index.html</code>ã€‚</li></ul><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="e736" class="ls kq hu mm b fv mv mw l mx my">// functions/index.js</span><span id="756b" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">require('zone.js/dist/zone-node');</strong></span><span id="035c" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">const functions = require('firebase-functions');<br/>const express = require('express');<br/>const path = require('path');<br/>const { enableProdMode } = require('@angular/core');<br/>const { renderModuleFactory } = require('@angular/platform-server');</strong></span><span id="ebcd" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">const { AppServerModuleNgFactory } = require('./dist-ssr/main.bundle');</strong></span><span id="34f4" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">enableProdMode();</strong></span><span id="5cec" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">const index = require('fs')<br/>    .readFileSync(path.resolve(__dirname, './dist/index.html'), 'utf8')<br/>    .toString();</strong></span><span id="74dc" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">let app = express();</strong></span><span id="01a1" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">app.get('**', function(<em class="nm">req</em>, <em class="nm">res</em>) {<br/>    renderModuleFactory(AppServerModuleNgFactory, {<br/>        url: req.path,<br/>        document: index<br/>    }).then(<em class="nm">html</em> =&gt; res.status(200).send(html));<br/>});</strong></span><span id="5916" class="ls kq hu mm b fv mz mw l mx my"><strong class="mm hv">exports.ssr = functions.https.onRequest(app);</strong></span></pre><h2 id="9ef1" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">7.é…ç½®Firebaseæ‰˜ç®¡</h2><p id="f28a" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»æ„å»ºäº†å‘ˆç°é¡µé¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ”¹firebaseä¸»æœºé…ç½®æ¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ›´æ”¹<code class="eh mj mk ml mm b">public</code>ç›®å½•ï¼Œä»¥ä¾¿ä½¿ç”¨<code class="eh mj mk ml mm b">dist</code>ç›®å½•æ¥è®¿é—®æ‚¨çš„èµ„äº§ã€‚</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="8774" class="ls kq hu mm b fv mv mw l mx my">// firebase.json<br/>{</span><span id="605f" class="ls kq hu mm b fv mz mw l mx my">    "hosting": {<br/>        <strong class="mm hv">"public": "dist",<br/>        "rewrites": [{<br/>            "source": "**",<br/>            "function": "ssr"<br/>        }]</strong><br/>    }<br/>}</span></pre><h2 id="1b00" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">8.ä»æ ¹ç›®å½•ä¸­åˆ é™¤`<code class="eh mj mk ml mm b">dist/index.html</code>'</h2><ul class=""><li id="825d" class="kb kc hu je b jf ln jj lo jn lp jr lq jv lr jz kg kh ki kj dt translated">è¿™æ˜¯å› ä¸ºFirebaseä¸ä¼šæœåŠ¡äº<code class="eh mj mk ml mm b">html</code>æ–‡ä»¶ï¼Œè€Œæ˜¯è¿è¡Œ<code class="eh mj mk ml mm b">ssr</code>å‡½æ•°ã€‚<strong class="je hv">æ³¨</strong>:ä»<code class="eh mj mk ml mm b">root</code>ç›®å½•ä¸­åˆ é™¤<code class="eh mj mk ml mm b">dist/index.html</code>ã€‚<strong class="je hv">ä¸åˆ é™¤</strong> <code class="eh mj mk ml mm b">functions/dist/index.html</code>ã€‚</li></ul><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="e9e5" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ rm dist/index.html</strong></span></pre><h2 id="a75f" class="ls kq hu bd kr lt lu lv kv lw lx ly kz jn lz ma ld jr mb mc lh jv md me ll mf dt translated">9.éƒ¨ç½²åˆ°ç«åŠ›åŸºåœ°ğŸš€ ğŸ”¥</h2><p id="be1d" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿå°†æ‚¨çš„åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°Firebase:</p><pre class="mn mo mp mq fq mr mm ms mt aw mu dt"><span id="9b02" class="ls kq hu mm b fv mv mw l mx my"><strong class="mm hv">$ firebase deploy</strong></span></pre></div><div class="ab cl na nb hc nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="hn ho hp hq hr"><h1 id="c04e" class="kp kq hu bd kr ks nh ku kv kw ni ky kz la nj lc ld le nk lg lh li nl lk ll lm dt translated">å°±æ˜¯è¿™æ ·ï¼ğŸ‘</h1><p id="0b6d" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn mg jp jq jr mh jt ju jv mi jx jy jz hn dt translated">ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æºä»£ç <a class="ae ka" href="https://github.com/aaronte/angular-universal-firebase" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="681d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">æˆ‘å¸Œæœ›è¿™ç¯‡æ•™ç¨‹åœ¨æŸäº›æ–¹é¢æœ‰æ‰€å¸®åŠ©ï¼å¦‚æœä½ æœ‰ä»»ä½•åé¦ˆæˆ–é—®é¢˜ï¼Œæˆ‘å¾ˆä¹æ„å¬åˆ°ï¼</p><p id="9fff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">å…¶ä»–æœ‰ç”¨çš„èµ„æº<br/></strong><a class="ae ka" rel="noopener" href="/@feloy/creating-an-angular-universal-app-with-the-angular-cli-5ef26c9fd9a5">ä½¿ç”¨Angular CLIåˆ›å»ºAngular Universal app</a><br/><a class="ae ka" rel="noopener" href="/@cdeniz/angular-universal-on-firebase-dynamic-hosting-4fdd034af3db">Angular Universal with Firebase Dynamic Hosting</a>(åªæœ‰ä¸€ä¸ªè·¯å¾„å¤„ç†)</p><figure class="mn mo mp mq fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure></div></div>    
</body>
</html>