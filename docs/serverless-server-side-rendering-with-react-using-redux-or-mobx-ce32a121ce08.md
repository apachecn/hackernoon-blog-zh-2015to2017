# ä½¿ç”¨ Redux æˆ– MobX çš„ React çš„æ— æœåŠ¡å™¨æœåŠ¡å™¨ç«¯æ¸²æŸ“

> åŸæ–‡ï¼š<https://medium.com/hackernoon/serverless-server-side-rendering-with-react-using-redux-or-mobx-ce32a121ce08>

å¤§çº¦ä¸¤å¹´å‰ï¼Œæˆ‘å¼€å§‹ä½¿ç”¨ Reactï¼Œæˆ‘ä¸€ç›´å¯¹åšæœåŠ¡å™¨ç«¯æ¸²æŸ“å¾ˆå¥½å¥‡ï¼Œä½†ä»æ¥æ²¡æœ‰çƒ¦æ¼è¿‡ã€‚éƒ¨åˆ†åŸå› æ˜¯æˆ‘æ­£åœ¨å¼€å‘çš„æœ€å¤§çš„åº”ç”¨ç¨‹åºçš„å¤§éƒ¨åˆ†å†…å®¹éƒ½åœ¨ç™»å½•ä¹‹åï¼Œä¸éœ€è¦åœ¨æ¯ä¸ªé¡µé¢ä¸Šéƒ½è¿›è¡Œå¤§è§„æ¨¡çš„æœç´¢å¼•æ“ä¼˜åŒ–(SEO )( T1 ),ä½†ä¹Ÿå› ä¸ºè¿™çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå·¨å¤§çš„éº»çƒ¦ï¼Œè€Œä¸”å·¥å…·ï¼Œæ¯”å¦‚è¯´ï¼Œå‘å±•å¾—éå¸¸å¿«ã€‚

å› æ­¤ï¼Œå½“æˆ‘çš„æœ‹å‹[ä¹”çº³æ£®](https://twitter.com/jotto)å‘Šè¯‰æˆ‘ä»–æ­£åœ¨å¼€å‘[çƒ¤è‚‰ã€‚io](https://www.roast.io/) æ—¶ï¼Œæˆ‘è®¤ä¸ºè¿™å°†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼æ¥æ»¡è¶³æˆ‘çš„å¥½å¥‡å¿ƒå’Œç”¨ React è¿›è¡ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“çš„æ‡’æƒ°ã€‚

switch . io æ˜¯ä¸€ä¸ªå‰ç«¯ä¸»æœºï¼Œåœ¨éƒ¨ç½²åˆ° CDN ä¹‹å‰ä½¿ç”¨ headless Chrome æ¸²æŸ“é¡µé¢ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä¸ºæ‚¨å®Œæˆæ‰€æœ‰çš„æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œè€Œä¸å¿…æœ‰ä¸€ä¸ªâ€œå‰ç«¯æœåŠ¡å™¨â€ï¼Œå®ƒçŸ¥é“å¦‚ä½•åšæ‰€æœ‰çš„äº‹æƒ…ï¼Œâ€œé¢„åŠ è½½æ‚¨çš„æ ¹ç»„ä»¶ï¼Œç”¨ props æ³¨å…¥å®ƒï¼Œæ¸²æŸ“åˆ°å­—ç¬¦ä¸²ï¼Œæ³¨å…¥æ¨¡æ¿ï¼Œç­‰ç­‰ã€‚â€å‡è®¾å®ƒæ˜¯ä¸€ä¸ª CDNï¼Œ(å³å®ƒæ˜¯ä¸€ä¸ªç¼“å­˜ï¼)å¯¹äºéœ€è¦ SEOï¼Œä½†ä¸éœ€è¦ç™»å½•çš„é¡µé¢æ¥è¯´éå¸¸å¥½ç”¨ã€‚æ‰€ä»¥å®ƒä¸ä¼šè§£å†³æ‰€æœ‰çš„æœåŠ¡å™¨ç«¯æ¸²æŸ“é—®é¢˜ï¼Œä½†æ˜¯ç¡®å®è§£å†³äº†ä¸€äº›é«˜ä»·å€¼çš„é—®é¢˜ã€‚

å¥½ï¼Œå¥½ï¼Œæ‰€ä»¥ä¸æ˜¯å°è®¡ç®—åŠŸèƒ½æ„ä¹‰ä¸Šçš„ capital-S æ— æœåŠ¡å™¨ï¼Œè€Œæ˜¯æˆ‘ä¸ç”¨è¿è¡ŒæœåŠ¡å™¨æ„ä¹‰ä¸Šçš„æ— æœåŠ¡å™¨ã€‚è¿™å¯¹äºåªæƒ³ç©ç©æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„æˆ‘æ¥è¯´å¾ˆæœ‰å¸®åŠ©ï¼Œä½†æ˜¯å¯¹äºé‚£äº›æ‹¥æœ‰å•é¡µé¢åº”ç”¨ç¨‹åºçš„äººæ¥è¯´å´å¾ˆéš¾è¿è¡ŒèŠ‚ç‚¹æœåŠ¡å™¨ã€‚

æ‰€ä»¥æˆ‘å¼€å§‹åˆ›å»ºä¸€ä¸ªé¡¹ç›®æ¥éƒ¨ç½² scatter . ioï¼Œå¹¶æƒ³åˆ†äº«ä¸€ä¸‹æˆ‘çš„ç»éªŒã€‚å‰§é€:å®ƒéå¸¸ç®€å•ï¼Œåªéœ€è¦ 0-10 è¡Œä»£ç å°±å¯ä»¥å®ç°æœåŠ¡å™¨ç«¯æ¸²æŸ“ã€‚é™¤äº†åŠ è½½é€Ÿåº¦æ›´å¿«ä¹‹å¤–ï¼Œæˆ‘è¿˜å°†å®¢æˆ·ç«¯è¯·æ±‚æ•°é‡ä¸­çš„ API è°ƒç”¨æ•°é‡ä» O(n)æ›´æ”¹ä¸º O(1)ã€‚æˆ‘æ¢ç´¢äº†å¦‚ä½•ä½¿ç”¨ç»„ä»¶çŠ¶æ€ã€ [Redux](https://hackernoon.com/tagged/redux) å’Œ MobXï¼Œæ‰€ä»¥æˆ‘æƒ³çœ‹çœ‹ä¸åŒçš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆå¦‚ä½•ä¸ scatter . io ä¸€èµ·å·¥ä½œ

*å…è´£å£°æ˜:çƒ˜ç„™. io çš„åˆ›ä½œè€…ä¹”çº³æ£®æ˜¯æˆ‘çš„æœ‹å‹ã€‚ä»–è®©æˆ‘å»è¯•ä¸€ä¸‹ bake . ioï¼Œç„¶åå†™åšå®¢ï¼Œä½†æ˜¯ä»–æ²¡æœ‰ä»˜é’±ç»™æˆ‘ã€‚æˆ‘ä»¬æœ€åä¸€æ¬¡å‡ºå»çš„æ—¶å€™ï¼Œä»–ç¡®å®æè®®ç»™æˆ‘ä¹°å’–å•¡ï¼Œä½†æ˜¯é‚£å¤©å¤ªæ™šäº†ï¼Œæˆ‘æ²¡æ—¶é—´å–å’–å•¡ã€‚ç›¸åï¼Œæˆ‘æŠ“ä½äº†æœºä¼šï¼Œå†™äº†ä¸€ç¯‡æ ‡é¢˜ä¸­æœ‰ç€ä»¤äººéš¾ä»¥ç½®ä¿¡çš„é«˜æµè¡Œè¯å¯†åº¦çš„æ–‡ç« ï¼Œæˆ‘ä»¬éƒ½åœ¨è¿™é‡Œã€‚*

# è®©æˆ‘ä»¬åŒ–å¦†å§

ä¸ºäº†å……åˆ†åˆ©ç”¨ scatter . ioï¼Œæˆ‘éœ€è¦ä¸€ä¸ª API æ¥åŠ è½½ä¸€äº›æ•°æ®ã€‚æµè§ˆ[è¿™ä¸ªä»¤äººæ•¬ç•çš„å…¬å…± API åˆ—è¡¨](https://github.com/toddmotto/public-apis)ï¼Œæˆ‘å‘ç°äº†[åŒ–å¦† API](http://makeup-api.herokuapp.com/) ï¼Œå®ƒéå¸¸å®Œç¾â€”â€”å®ƒåœ¨ JSON ä¸­å¼€æ”¾äº†å¤§é‡ç»†èŠ‚å’Œå›¾ç‰‡é“¾æ¥ã€‚æˆ‘å¼€å§‹åˆ¶ä½œä¸€ä¸ªéå¸¸ç®€å•çš„ React åº”ç”¨ç¨‹åºï¼ŒæŒ‰å“ç‰Œæ˜¾ç¤ºåŒ–å¦†å“ã€‚(æˆ‘æœ€å–œæ¬¢çš„ API æ•°æ®æ˜¯ï¼Œå®ƒä¸ºè®¸å¤šäº§å“çš„ä¸åŒé¢œè‰²é€‰é¡¹æä¾›äº†åå…­è¿›åˆ¶ä»£ç ã€‚é‚£æ˜¯ä¸€ä¸ª[å¥½ç©çš„ååº”ç»„ä»¶](https://github.com/emilong/makeup/blob/master/src/ProductColors.js)ã€‚ğŸ’…)

![](img/e06d7912e08b72115398d0e05ee9b65d.png)

The makeup app

å¥½å§ï¼Œæ‰€ä»¥åŒ–å¦†æ¯”æˆ‘çš„åº”ç”¨ç¨‹åºå¥½çœ‹å¤šäº†ï¼Œä½†å®ƒåº”è¯¥æœ‰åŠ©äºæˆ‘ä»¬æµ‹è¯•æœåŠ¡å™¨ç«¯çš„æ¸²æŸ“ã€‚ä½ å¯ä»¥å»æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„[æºä»£ç å’Œéƒ¨ç½²çš„åº”ç”¨ç¨‹åº](https://github.com/emilong/makeup)çš„[ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°å®ƒçœ‹èµ·æ¥æ›´åƒæ˜¯ä¸€ä¸ª(ç²—ç³™çš„)ååº”åº”ç”¨ç¨‹åºã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘å˜å¾—æ‡’æƒ°ï¼Œåœ¨è®©æœåŠ¡å™¨ç«¯æ¸²æŸ“å·¥ä½œæ—¶å‡ ä¹ä»€ä¹ˆéƒ½ä¸åšã€‚æˆ‘ä¼šåœ¨ä¸‹é¢æè¿°æˆ‘åšäº†ä»€ä¹ˆã€‚](https://broken-apparel-8185.roast.io/revlon)

F é¦–å…ˆï¼Œæˆ‘å°è¯•ä½¿ç”¨[ç»„ä»¶çŠ¶æ€](https://github.com/emilong/makeup/tree/component-state)æŒ‰å“ç‰ŒåŠ è½½æ•°æ®ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºå¹¶ä¸å¤ªå¤æ‚ã€‚æ¢å¥è¯è¯´ï¼Œå½“ React è·¯ç”±å™¨åŠ è½½ä¸€ä¸ªå“ç‰Œæ—¶ï¼Œå“ç‰Œç»„ä»¶ä¼šæŸ¥çœ‹è·¯å¾„ï¼Œä» API è¯·æ±‚è¯¥å“ç‰Œçš„æ•°æ®ï¼Œç„¶åä½¿ç”¨ setState()å°†å…¶ä¿å­˜åœ¨æœ¬åœ°ã€‚

Saving data in component state

å½“æˆ‘éƒ¨ç½²æ—¶ï¼Œæˆ‘éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º [_ssr.json](https://github.com/emilong/makeup/blob/master/_ssr.json) çš„å°æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æˆ‘å¸Œæœ›åœ¨æœåŠ¡å™¨ä¸Šå‘ˆç°çš„è·¯å¾„åˆ—è¡¨ã€‚è®¸å¤šåº”ç”¨ç¨‹åºå¯èƒ½ä¸éœ€è¦è¿™æ ·åšï¼Œå› ä¸º scatter . io ä¼šæŠ“å–ä½ çš„ç½‘ç«™ï¼Œä½†æˆ‘å¿…é¡»ç‰¹åˆ«åšä¸€ä¸ªæ²¡æœ‰é»˜è®¤ç™»é™†é¡µé¢çš„åº”ç”¨ç¨‹åºã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘å–œæ¬¢é›ªèŠ±ã€‚â„ï¸

![](img/c0506efd4664a286579667a9a2516213.png)

é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»€ä¹ˆä¹Ÿæ²¡åšã€‚è¯¥åº”ç”¨ç¨‹åºå·²éƒ¨ç½²ï¼Œæ‰€æœ‰æ ‡è®°éƒ½åœ¨ç¬¬ä¸€æ¬¡ä¸‹è½½æ—¶å‘ˆç°ã€‚ä¸‡å²ã€‚

è¿™ç§æ–¹æ³•çš„å”¯ä¸€é—®é¢˜æ˜¯ï¼Œå°½ç®¡é¡µé¢å¯ä»¥å¿«é€ŸåŠ è½½æ‰€æœ‰å‘ˆç°çš„æ ‡è®°ï¼Œä½†å½“æ¯ä¸ªç”¨æˆ·è®¿é—®æ—¶ï¼Œå®ƒä»ç„¶ä¼šè¿›è¡Œé¢å¤–çš„è·å–ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºæ— æ³•çŸ¥é“å®ƒæ˜¯åœ¨æœåŠ¡å™¨ç«¯å‘ˆç°çš„ã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»„ä»¶çŠ¶æ€æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ Redux ç¤¾åŒºæœ‰å¾ˆå¤šå…³äºçŠ¶æ€â€œå†æ°´åŒ–â€çš„æ–‡æ¡£ã€‚æ‰€ä»¥æˆ‘è¯•ç€æŠŠåº”ç”¨ç¨‹åºè½¬æ¢æˆ Reduxâ€¦

å”± Redux " [é¸­å­](https://github.com/erikras/ducks-modular-redux)"é£æ ¼ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå‡é€Ÿå™¨ä¸è¡ŒåŠ¨å’Œè¡ŒåŠ¨çš„åˆ›é€ è€…å¦‚ä¸‹æ‰€ç¤ºã€‚(ä½ å¯ä»¥æµè§ˆä»£ç ï¼Œæˆ‘åœ¨åé¢æ€»ç»“äº†é‡è¦çš„éƒ¨åˆ†ã€‚)

Reducer, actions, and action creators for the API

æˆ‘åœ¨è¿™é‡Œä½¿ç”¨äº† [redux-thunk](https://github.com/gaearon/redux-thunk) æ¥å®ç°å¼‚æ­¥ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªè°ƒç”¨ã€‚åŸºæœ¬çš„è·å–æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯æœ‰ä¸€äº›æ˜¾è‘—çš„å˜åŒ–:

*   å®ƒæ˜¯å¯è¿˜åŸçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸éœ€è¦å¯¹ä»»ä½•ç»“æ„è¿›è¡Œä¿®æ”¹ï¼Œreducer å°†æ‰€æœ‰ä¸œè¥¿é›†æˆåˆ°ä¸€ä¸ªçŠ¶æ€æ ‘ä¸­ã€‚
*   çŠ¶æ€æ ‘ä¿å­˜äº†æˆ‘ä»¬é‡åˆ°çš„ä»»ä½•å“ç‰Œçš„æ‰€æœ‰æ•°æ®ï¼Œå› æ­¤åˆ‡æ¢å›æˆ‘ä»¬å·²ç»è§è¿‡çš„å“ç‰Œä¼šæ›´å¿«ã€‚
*   è¯¥ç»„ä»¶ç°åœ¨æ£€æŸ¥å®ƒæ‰€å‘ˆç°çš„å“ç‰Œæ˜¯å¦åœ¨çŠ¶æ€æ ‘ä¸­å¯ç”¨ï¼Œå¦‚æœä¸å¯ç”¨ï¼Œåˆ™åªè·å–ã€‚
*   çŠ¶æ€æ ‘è¿˜ä¿å­˜äº†ä¸€ä¸ªâ€œè¿›è¡Œä¸­â€çš„å“ç‰Œåˆ—è¡¨ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªå¾®è°ƒå™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šè·å–ä¸€ä¸ªå·²ç»åœ¨è¿›è¡Œä¸­çš„å“ç‰Œã€‚

ä¸è¿‡æœ€é‡è¦çš„æ˜¯ï¼Œæ³¨æ„æˆ‘ä»¬ä» __PRELOADED_STATE__ è·å–åˆå§‹ Redux çŠ¶æ€ï¼Œå¦‚æœå®ƒå¯ç”¨çš„è¯ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºä½¿ç”¨è¿™ä¸ªå˜é‡çš„è¯ï¼Œå®ƒå¯ä»¥ä½œä¸ºä¿å­˜å’ŒåŠ è½½é¢„åŠ è½½çŠ¶æ€çš„å¥æŸ„ã€‚åœ¨ reducer ä¸­ï¼Œæˆ‘ä»¬æœºä¼šæ€§åœ°ä½¿ç”¨å®ƒï¼Œä½†æ˜¯å¦‚æœå®ƒä¸åœ¨é‚£é‡Œï¼Œå°±é€€å›åˆ°ç©ºçŠ¶æ€ã€‚

å¦‚æœå®ƒæ˜¯å¯ç”¨çš„ï¼Œå¹¶ä¸”å…·æœ‰æˆ‘ä»¬è¯•å›¾å‘ˆç°çš„å“ç‰Œçš„æ•°æ®ï¼Œåˆ™ç»„ä»¶ä¸ä¼šè·å–ã€‚å®ƒåªä¼šä½¿ç”¨é¢„åŠ è½½çŠ¶æ€ä¸‹çš„å†…å®¹ã€‚æ­¤å¤–ï¼Œå¦‚æœå·²ç»å‘ˆç°äº†æ ‡è®°ï¼ŒReact ä¸éœ€è¦æ›´æ”¹ DOMï¼Œå› ä¸ºå®ƒä¼šæ„è¯†åˆ°å®ƒåªæ˜¯å‘ˆç°äº†ä¸æœåŠ¡å™¨ç«¯ç”± soat . io å‘ˆç°çš„ä¸€æ ·çš„ä¸œè¥¿ï¼Œå› ä¸º[æ ¡éªŒå’Œ](https://stackoverflow.com/questions/34311221/what-is-checksum-in-react-and-how-to-use-it)åœ¨ç¼“å­˜çš„é¡µé¢ä¸Šæ˜¯å®Œæ•´çš„ã€‚

é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åˆ°è¾¾é‚£é‡Œçš„å‘¢ï¼Ÿå¥½å§ï¼Œå› ä¸ºåœ¨å®ƒçš„æœåŠ¡å™¨æ¸²æŸ“é˜¶æ®µç»“æŸæ—¶ï¼Œscatter . io åªæ˜¯åºåˆ—åŒ– __PRELOADED_STATE__ æŒ‡å‘çš„ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† __PRELOADED_STATE__ è®¾ç½®ä¸ºç­‰äº reducer æ¯æ¬¡æ›´æ–°å®ƒæ—¶çš„çŠ¶æ€ã€‚Redux ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¼˜ç§€çš„ä¸­é—´ä»¶æ¡†æ¶æ¥ç›¸å¯¹å®¹æ˜“åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚

Configuring the store to use our preloaded state-saving middleware

å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ä¸Šé¢é™„åŠ çš„ä¸­é—´ä»¶æ¥è®¾ç½®æˆ‘ä»¬çš„å•†åº—ï¼Œé‚£ä¹ˆ scatter . io å°†ä¿å­˜æ•´ä¸ª Redux å•†åº—ï¼Œå¹¶å°†å…¶â€œè„±æ°´â€åˆ°ç¼“å­˜é¡µé¢ä¸­ã€‚å½“æˆ‘ä»¬å†æ¬¡åˆ›å»ºæˆ‘ä»¬çš„å­˜å‚¨æ—¶ï¼Œæˆ‘ä»¬å°†ä» __PRELOADED_STATE__ å¼€å§‹å¯¹å…¶è¿›è¡Œâ€œå†æ°´åˆâ€ã€‚

![](img/491558cdc5cb2a1194bfd0bc534da9fc.png)

æ¦‚æ‹¬åœ°è¯´ï¼Œå½“é¡µé¢åŠ è½½æ—¶ï¼Œæ ‡è®°å·²ç»å°±ä½ï¼Œå› æ­¤æµè§ˆå™¨å¯ä»¥ç«‹å³å¼€å§‹å‘ˆç°ï¼ŒRedux å­˜å‚¨çš„çŠ¶æ€å°†è¢«åŠ è½½ï¼Œå› æ­¤åœ¨ç¬¬ä¸€ä¸ªé¡µé¢è§†å›¾ä¸Šæ²¡æœ‰ API è°ƒç”¨ã€‚æˆ‘ä»¬æ­£åœ¨æœ‰æœºä¼šåœ°ä½¿ç”¨ __PRELOADED_STATE__ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…åœ¨æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒä¸­å¯¹æˆ‘ä»¬çš„ soat . io éƒ¨ç½²åšä»»ä½•ä¸åŒçš„äº‹æƒ…ã€‚(å¦å¤–ï¼Œå¦‚æœä½ æƒ³é€€å‡º switch . ioï¼Œä½ ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œä½†æ˜¯ä¸è¦å‘Šè¯‰ Jonathan æ˜¯æˆ‘è¯´çš„ã€‚)

> è¿™ä¸ªé¡µé¢åªéœ€è¦ä¸€ä¸ª API è°ƒç”¨**å°±å¯ä»¥æœç´¢åˆ°ä»»æ„æ•°é‡çš„å®¢æˆ·ç«¯ã€‚**

**è¿™æ ·ï¼Œå¯¹äºé€šè¿‡æœç´¢åˆ°è¾¾çš„ä»»æ„æ•°é‡çš„å®¢æˆ·ç«¯ï¼Œè¯¥é¡µé¢åªéœ€è¦ä¸€æ¬¡ API è°ƒç”¨ã€‚è™½ç„¶è¿™ä¸ªä¾‹å­ä¸­çš„ API æ˜¯å…è´¹çš„ï¼Œä½†æ˜¯ Firebase å’Œæ‚¨è‡ªå·±çš„è‡ªæ‰˜ç®¡ API å´ä¸æ˜¯ï¼Œæ‰€ä»¥è¿™ä¸ªæ¶æ„å¯ä»¥ä¸ºæ‚¨èŠ‚çœç›¸å½“å¤šçš„åç«¯æˆæœ¬ã€‚**

**è™½ç„¶ Redux æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¿›å…¥ React stateï¼Œä½†æˆ‘æœ€è¿‘ä¹Ÿå¼€å§‹å…³æ³¨ MobXã€‚æˆ‘çŸ¥é“ Redux æœ‰å¾ˆå¤šä½¿ç”¨é¢„åŠ è½½çŠ¶æ€çš„åŸºç¡€è®¾æ–½ï¼Œä½†æ˜¯æˆ‘ä¸å¤ªç†Ÿæ‚‰ MobX çš„æœåŠ¡å™¨ç«¯æ¸²æŸ“åŠŸèƒ½ã€‚æˆ‘éå¸¸æƒŠè®¶åœ°å‘ç°ï¼Œå®ƒä¸ä»…çœŸçš„å¾ˆå®¹æ˜“åšåˆ°ï¼Œè€Œä¸”å®ƒä¸ scatter . io çš„ __PRELOADED_STATE__ å˜é‡è®¾ç½®æ–¹æ³•é…åˆå¾—éå¸¸å¥½ã€‚æˆ‘å°†é¡¹ç›®è½¬æ¢ä¸ºåœ¨è¿™ä¸ª[åˆ†æ”¯](https://github.com/emilong/makeup/tree/mobx)ä¸Šä½¿ç”¨ MobXã€‚**

**å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ MobXï¼Œé‚£ä¹ˆå¯¹äºæœ¬æ–‡ï¼Œæ‚¨éœ€è¦çŸ¥é“çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œå®ƒå°±åœ°ä¿®æ”¹çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ååº”å¼æ¶æ„å‘å¸ƒæ›´æ”¹ã€‚*åˆ°ä½*çš„äº‹æƒ…æ‰æ˜¯é‡è¦çš„äº‹æƒ…ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å·å¯¹äºåŒ–å¦† app çš„æ ·å­:**

**MobX store for brand data**

**é™¤äº†ç‰¹æ®Šçš„è£…é¥°è€…ï¼Œå®ƒå®é™…ä¸Šåªæ˜¯ä¸€ä¸ª ES6 ç±»ã€‚æˆ‘ä»¬ä¿ç•™çš„æ•°æ®ä¸ Redux æ–¹æ³•ç›¸åŒï¼Œåªæ˜¯åœ¨ ES6 é›†åˆå’Œ MobX å¯è§‚å¯Ÿåœ°å›¾ä¸­(å°±æˆ‘ä»¬çš„ç›®çš„è€Œè¨€ï¼Œè¿™ä¸ ES6 åœ°å›¾éå¸¸ç›¸ä¼¼)ã€‚åœ¨åˆå§‹åŒ–æ—¶ï¼Œæˆ‘ä»¬è·å–ä¸€äº›é¢„åŠ è½½çš„çŠ¶æ€ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºå¯è¢« MobX è§‚å¯Ÿåˆ°ï¼Œåšä¸€äº›å®šåˆ¶å·¥ä½œï¼Œä½†ä¸æ˜¯å¤ªå¤šã€‚è¿™ä¸ªç±»ç±»ä¼¼äºæˆ‘ä»¬åœ¨ä¸Šé¢ç”¨ Redux reducer æ‰€åšçš„ã€‚**

**é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®©é¢„åŠ è½½çš„çŠ¶æ€ä¿å­˜å’ŒåŠ è½½å‘¢ï¼Ÿå› ä¸ºå­˜å‚¨æ˜¯å°±åœ°ä¿®æ”¹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€åœ¨åˆ›å»ºæ—¶è®¾ç½® __PRELOADED_STATE__ ä¸€æ¬¡ã€‚**

**Initializing and saving the MobX store**

**å°±æ˜¯è¿™æ ·ï¼ğŸ‰æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦ç”¨æ¯ä¸ªåŠ¨ä½œæ›´æ–° __PRELOADED_STATE__ã€‚æˆ‘ä»¬è·å¾—äº†æœåŠ¡å™¨ç«¯å‘ˆç°æ ‡è®°çš„æ‰€æœ‰å¥½å¤„ï¼Œå¹¶ä¸”æ²¡æœ‰ API è°ƒç”¨ã€‚**

# **å»è¯•è¯•å§**

**![](img/b417cf0aa2f926047c423ef6ae84b17b.png)**

**æ‰€ä»¥æˆ‘ä¸çŸ¥é“è¿™æ¬¡ä½“éªŒç®—ä¸ç®—æˆ‘åœ¨åšè®¾ç½®æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œä½†æ˜¯æˆ‘*å¾—åˆ°äº†*æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œæ‰€ä»¥æˆ‘è¦æŠŠå®ƒç®—ä½œä¸€æ¬¡èƒœåˆ©ã€‚æ‰€ä»¥è¯•ä¸€è¯•å§â€”â€”è¿™é‡Œæœ‰ä¸€ä¸ªå…è´¹å±‚ï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯å¯åŠ¨ NPM install-g bakeï¼Œç„¶åè¿è¡Œ roast deployã€‚**

**æˆ‘å¸Œæœ›å°½å¿«å°è¯• Vueï¼Œçœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚å¦‚æœæœ‰äººå°è¯•ç”¨ bake . ioï¼Œè¯·åœ¨å›å¤ä¸­å‘Šè¯‰æˆ‘ï¼**

***ä½ çŸ¥é“ä¸ºä»€ä¹ˆçµåª’è¦ç”¨ç»¿å¿ƒå—ğŸ’šè€Œä¸æ˜¯çº¢è‰²æˆ–å…¶ä»–é¢œè‰²ï¼Ÿæˆ‘ä¹Ÿæ˜¯ï¼Œä½†æˆ‘çœŸçš„å¾ˆæ„Ÿæ¿€å–œæ¬¢æˆ‘å¸–å­çš„äººç‚¹å‡»ğŸ’šã€‚æ¥ä¸‹æ¥ä¹Ÿå¾ˆæ£’ã€‚:)è°¢è°¢ï¼***

**[![](img/50ef4044ecd4e250b5d50f368b775d38.png)](http://bit.ly/HackernoonFB)****[![](img/979d9a46439d5aebbdcdca574e21dc81.png)](https://goo.gl/k7XYbx)****[![](img/2930ba6bd2c12218fdbbf7e02c8746ff.png)](https://goo.gl/4ofytp)**

> **[é»‘å®¢ä¸­åˆ](http://bit.ly/Hackernoon)æ˜¯é»‘å®¢å¦‚ä½•å¼€å§‹ä»–ä»¬çš„ä¸‹åˆã€‚æˆ‘ä»¬æ˜¯ [@AMI](http://bit.ly/atAMIatAMI) å®¶åº­çš„ä¸€å‘˜ã€‚æˆ‘ä»¬ç°åœ¨[æ¥å—æŠ•ç¨¿](http://bit.ly/hackernoonsubmission)å¹¶ä¹æ„[è®¨è®ºå¹¿å‘Š&èµåŠ©](mailto:partners@amipublications.com)æœºä¼šã€‚**
> 
> **å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬æ¨èä½ é˜…è¯»æˆ‘ä»¬çš„[æœ€æ–°ç§‘æŠ€æ•…äº‹](http://bit.ly/hackernoonlatestt)å’Œ[è¶‹åŠ¿ç§‘æŠ€æ•…äº‹](https://hackernoon.com/trending)ã€‚ç›´åˆ°ä¸‹ä¸€æ¬¡ï¼Œä¸è¦æŠŠä¸–ç•Œçš„ç°å®æƒ³å½“ç„¶ï¼**

**![](img/be0ca55ba73a573dce11effb2ee80d56.png)**