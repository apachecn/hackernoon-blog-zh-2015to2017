# æ‰¾åˆ°åŠ«æŒæ‚¨äº‹ä»¶çš„è®¨åŒçš„ç›‘å¬å™¨(Javascript)

> åŸæ–‡ï¼š<https://medium.com/hackernoon/finding-that-pesky-listener-thats-hijacking-your-event-javascript-b590593f2a83>

è¿™æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•ç¡®å®šä»€ä¹ˆäº‹ä»¶ç›‘å¬å™¨æ­£åœ¨è°ƒç”¨`event.preventDefault()`æˆ–`event.stopPropagation()`æˆ–å…¶ä»–ä¸€äº›å®Œå…¨éšæœºçš„ä¸å…è®¸æ‚¨é¢„æœŸæ“ä½œçš„äº‹æƒ…çš„è°ƒè¯•æ•…äº‹ã€‚

## é—®é¢˜æ˜¯

æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªè¡¨å•ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»è¾“å…¥æ¡†æ—¶ï¼Œå®ƒä¸ä¼šèšç„¦ã€‚æ‰€ä»¥å¾ˆæ˜æ˜¾ï¼Œæœ‰ä»€ä¹ˆä¸œè¥¿åœ¨å¬è¿™ä¸ªè¾“å…¥æ¡†çš„ç„¦ç‚¹ï¼Œæˆ–è€…åœ¨å¬åˆ«çš„ä»€ä¹ˆä¸œè¥¿çš„æ¨¡ç³Šç‚¹ï¼Œå¹¶è¯•å›¾æŠŠç„¦ç‚¹æ”¾åœ¨å…¶ä»–ä¸€äº›ä¸åœ¨é‚£é‡Œæˆ–éšè—åœ¨å±å¹•ä¸Šçš„è¾“å…¥æ¡†ä¸Šã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåºå¤§çš„ä»£ç ï¼Œå…¶ä¸­åŒ…å«äº†å¤§é‡çš„æ„å¤§åˆ©é¢æ¡å¼çš„ä»£ç ï¼Œä¸çŸ¥ä½•æ•…ï¼Œè¿™äº›ä»£ç å¯ä»¥æ­£å¸¸å·¥ä½œã€‚(æˆ‘ä»¬æœ‰ React å’Œ Backboneï¼Œæˆ‘ä»¬æœ‰ [jQuery](https://hackernoon.com/tagged/jquery) å’Œä¸‹åˆ’çº¿ï¼Œæˆ‘ä»¬æ‹¥æœ‰ä¸€åˆ‡ã€‚æˆ‘ä»¬å³å°†å®Œæˆè¿ç§»),å› æ­¤å¾ˆéš¾æ‰¾å‡ºå¯¼è‡´è¿™ç§æƒ…å†µçš„åŸå› ã€‚äº‹ä»¶ä¾¦å¬å™¨æ˜¯ä»è®¸å¤šåœ°æ–¹æ·»åŠ çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å¤šå°‘ã€‚

## ä½¿ç”¨ Chrome DevTools æŸ¥æ‰¾ DOM ä¿®æ”¹

åœ¨ [Chrome](https://hackernoon.com/tagged/chrome) DevTools ä¸­ï¼Œè¦æ‰¾å‡ºæ˜¯å¦æœ‰ä¸œè¥¿æ­£åœ¨ä¿®æ”¹ DOM æ˜¯éå¸¸å®¹æ˜“çš„ï¼Œåªéœ€åœ¨å…ƒç´ çª—æ ¼ä¸­é€‰æ‹©å…ƒç´ ï¼Œå³é”®å•å‡»ï¼Œç„¶åå°±å¯ä»¥é€‰æ‹©ä¸­æ–­å­æ ‘ä¿®æ”¹ã€å±æ€§ä¿®æ”¹å’ŒèŠ‚ç‚¹åˆ é™¤ã€‚

![](img/7c0aca5c22c9747a79b60a7c7a1e16ce.png)

ä½†æ˜¯å¯¹äºæˆ‘ä»¬å½“å‰çš„é—®é¢˜ï¼ŒDOM æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥è¿™åœ¨è¿™é‡Œæ²¡æœ‰å¸®åŠ©ã€‚

## åˆ—å‡ºç‰¹å®šäº‹ä»¶çš„æ‰€æœ‰ DOM äº‹ä»¶ä¾¦å¬å™¨

åœ¨ Chrome DevTools çš„å…ƒç´ é¢æ¿ä¸­ï¼ŒStyles æ—è¾¹æœ‰ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨æ ‡ç­¾ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—å‡ºäº†æ‰€æœ‰äº‹ä»¶å’Œä¸ºè¯¥äº‹ä»¶æ·»åŠ çš„äº‹ä»¶ä¾¦å¬å™¨ï¼Œè¦†ç›–äº†åœ¨ Elements çª—æ ¼ä¸­é€‰æ‹©çš„å½“å‰ DOM å…ƒç´ çš„æ‰€æœ‰ç¥–å…ˆã€‚(*å¬èµ·æ¥åƒç»•å£ä»¤*ğŸ˜‚)

![](img/dd48df1717a574b21207cb31dada6be9.png)

è¿™é‡Œæœ‰åˆ é™¤ä¾¦å¬å™¨çš„é€‰é¡¹ï¼Œæˆ–è€…æ‚¨å¯ä»¥è½¬åˆ°ä¾¦å¬å™¨å‡½æ•°å®šä¹‰ã€‚ä½†æ˜¯å¦‚æœä½ ä½¿ç”¨ä»»ä½•åƒ jQuery æˆ– React è¿™æ ·çš„æ¡†æ¶ï¼Œå®ƒä¼šå¸¦ä½ åˆ°å®ƒçš„å†…éƒ¨å‡½æ•°ï¼Œæ‰€ä»¥è¿™æ˜¯æ²¡æœ‰å¸®åŠ©çš„ã€‚

æ‰€ä»¥æˆ‘ä»¬æƒ³ï¼Œè®©æˆ‘ä»¬å»æ‰ç›‘å¬å™¨ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾ˆå¹¸è¿ã€‚æˆ‘ä»¬ç§»é™¤äº†èšç„¦ã€æ¨¡ç³Šã€ç‚¹å‡»ç­‰çš„ç›‘å¬å™¨ã€‚å¦‚æœè¿™å°±æ˜¯é˜»ç¢æˆ‘ä»¬çš„åŸå› ã€‚ä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œæˆ‘ä»¬ç§»é™¤äº†æ‰€æœ‰ç¥–å…ˆä¸Šæ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ä¾¦å¬å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶æ— æ³•å°†æ³¨æ„åŠ›é›†ä¸­åœ¨æˆ‘ä»¬çš„è¾“å…¥æ¡†ä¸Šã€‚

## è¿™å‘Šè¯‰æˆ‘ä»¬ä»€ä¹ˆï¼Ÿ

è¿™ç¡®å®å‘Šè¯‰æˆ‘ä»¬ä¸€ä»¶äº‹ï¼Œç›‘å¬å™¨ä¸æ˜¯ç›‘å¬ç„¦ç‚¹æˆ–ç‚¹å‡»äº‹ä»¶ï¼Œè€Œæ˜¯ç›‘å¬æˆ‘ä»¬çš„å…ƒç´ çš„ä¸ç›¸äº¤æ ‘ä¸­çš„ä¸€äº›å…¶ä»–å…ƒç´ çš„æ¨¡ç³Šäº‹ä»¶ã€‚æˆ‘ä»¬åœ¨å­˜å‚¨åº“ä¸­æœç´¢äº†`'blur'`ã€`"blur"` & `onBlur`ï¼Œæ‰¾åˆ°äº†è¶…è¿‡ 25 ä¸ªå®ä¾‹ã€‚åºŸè¯ã€‚è¿™éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚æˆ‘çš„åŒäº‹å¼€å§‹åˆ°å¤„æ·»åŠ è°ƒè¯•å™¨è¯­å¥ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•è·é˜¶æ®µä¸º`focus`åœ¨çª—å£ä¸Šæ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°çªƒå–ç„¦ç‚¹çš„ç½ªé­ç¥¸é¦– DOMï¼Œä½†æ˜¯å®ƒæ²¡æœ‰ç»™æˆ‘ä»¬è®¾ç½®ç„¦ç‚¹çš„ç½ªé­ç¥¸é¦–å‡½æ•°ã€‚æˆ‘ä»¬éœ€è¦ä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥æ‰¾åˆ°å®ƒã€‚

## æˆ‘ä»¬èƒ½åšå¾—æ›´å¥½å—ï¼Ÿè¾“å…¥æ—¶é—´çº¿ã€‚

ä»è„šæœ¬åˆ°æ—¶é—´è½´é¢æ¿ä¸­çš„æ¸²æŸ“ï¼Œæ‚¨å¯ä»¥è®°å½•æµè§ˆå™¨ä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…çš„ç«ç„°å›¾ã€‚æ‰€ä»¥æˆ‘ä»¬å¼€å§‹è®°å½•ï¼Œç‚¹å‡»è¾“å…¥æ¡†å¹¶åœæ­¢ï¼Œç§ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†äº‹ä»¶å’Œå®ƒçš„å¬ä¼—ã€‚

![](img/a990df8be71529e764d1f525c76cd204.png)

å•å‡»åç§°ä¼šå°†æ‚¨å¸¦åˆ°æºä»£ç é¢æ¿ä¸­çš„å®šä¹‰ï¼Œå®ƒå°±åœ¨é‚£é‡Œ:

![](img/5b302e61473d0e6e6252758b40f29fcd.png)

æŸ¥çœ‹é¢„ç¼–è¯‘çš„ä»£ç ï¼Œæˆ‘ä»¬å‘ç°ä½œè€…ç•™ä¸‹äº†ä¸€ä¸ªæ³¨é‡Šã€‚

```
parent[0].addEventListener('blur', function(e) {
  if (!e.relatedTarget) {
    return;
  }
  // **if tab key is pressed, and something out of modal-container is focused, snatch it back.**
  if (!$(this).find(e.relatedTarget).length) {
    return this.focus();
  }
}, true);
```

## ä»€ä¹ˆï¼Ÿï¼Ÿ

å¦‚æœæœ‰åˆ«çš„ä¸œè¥¿è¢«èšç„¦ï¼Œå°±æŠŠå®ƒæŠ¢å›æ¥ã€‚ä»€ä¹ˆï¼Ÿï¼Ÿåƒè¿™æ ·çš„ä¸€æ®µä»£ç åœ¨åšä»€ä¹ˆï¼Ÿ

å› æ­¤ï¼Œè¿™æ®µä»£ç è¢«æ·»åŠ åˆ°äº†æ¨¡æ€åº“ä»£ç ä¸­ï¼Œè¿™æ ·ï¼Œå¦‚æœæœ‰äººå•å‡» tab æˆ– shift + tabï¼Œå¹¶ä¸”åœ¨æ¨¡æ€èƒŒæ™¯åé¢æœ‰å…¶ä»–è¾“å…¥æ¡†ï¼Œå…‰æ ‡å¯èƒ½ä¼šç§»åŠ¨åˆ°é‚£é‡Œï¼Œæˆ–è€…å¦‚æœæ‚¨åœ¨æ‚¨çš„èº«ä½“ä¸Šæ·»åŠ äº†ä¸€ä¸ªéšè—çš„æº¢å‡ºï¼Œå¹¶ä¸”æ‚¨çš„è¾“å…¥æ¡†åœ¨å±å¹•çš„åº•éƒ¨ï¼Œæµè§ˆå™¨å¯èƒ½ä¼šå‘ä¸‹æ»šåŠ¨ï¼Œç”¨æˆ·å¯èƒ½çœ‹åˆ°çš„åªæ˜¯èƒŒæ™¯ã€‚

è¿™æ˜¯ä¸€æ®µéå¸¸ç®€æ´çš„ä»£ç ã€‚æ„Ÿè°¢[æ™®æ‹‰çº³å¤«Â·å¤æ™®å¡”](https://medium.com/u/37aa88e9375d?source=post_page-----b590593f2a83--------------------------------)çš„åŠ å…¥ã€‚

## é‚£ä¹ˆæˆ‘ä»¬åšé”™äº†ä»€ä¹ˆï¼Ÿ

æ‰€ä»¥æ­£å¦‚æˆ‘ä¸Šé¢æåˆ°çš„ï¼Œæˆ‘ä»¬æ­£åœ¨å°†æˆ‘ä»¬çš„ä»£ç åº“ä»ä¸»å¹²è¿ç§»åˆ° Reactã€‚æˆ‘ä»¬æ‰€åšçš„æ˜¯åœ¨ä¸»å¹²æ¨¡å‹ä¹‹ä¸Šæ‰“å¼€äº†ä¸€ä¸ª React æ¨¡å‹(ç”¨ React ç¼–å†™çš„æ¨¡å‹)ã€‚æˆ‘ä»¬åˆ¶ä½œäº†ä¸¤ä¸ªä¸åŒçš„å®¹å™¨ï¼Œä¸€ä¸ªç”¨äºæ‰€æœ‰ä¸»å¹²æ¨¡æ€ï¼Œå¦ä¸€ä¸ªç”¨äºæ‰€æœ‰ååº”æ¨¡æ€ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ´»åŠ¨æ¨¡æ€å¤±å»ç„¦ç‚¹ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ã€‚æ·»åŠ äº†ä¸€äº›å°æ¡ä»¶ï¼Œæˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚

## å¸¦èµ°- Chrome DevTools æ—¶é—´è½´

è¿™å¯èƒ½ä¸æ˜¯æœ‰å²ä»¥æ¥æœ€éš¾çš„é”™è¯¯ï¼Œä½†æ˜¯ä½¿ç”¨æ—¶é—´çº¿å¯ä»¥æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å·¥å…·æ¥å‘ç°åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä¸€ä¸ªæ“ä½œæœ‰å¤šæ…¢æˆ–å¤šå¿«ã€‚å®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨äºå‘ç°æ€§èƒ½ä¸‹é™ã€‚äºæ˜¯**å¼€å§‹å½•åˆ¶**ã€‚

![](img/946a10258b54ddcde53efb86e0102e1e.png)

ä½ è®¤ä¸ºæœ‰æ›´å¥½çš„æ–¹æ³•æ¥è°ƒè¯•è¿™ä¸ªå—ï¼Ÿ(*é™¤äº†å†™å‡ºæ›´å¥½ä»£ç çš„æ˜æ˜¾æ–¹æ³•*ğŸ˜‚)è¯·åœ¨è¯„è®ºä¸­æåˆ°è¿™ä¸€ç‚¹ã€‚å¦‚æœä½ å­¦åˆ°äº†æ–°çš„ä¸œè¥¿ï¼Œæ¨èè¿™ä¸ªæ•…äº‹ã€‚

[![](img/50ef4044ecd4e250b5d50f368b775d38.png)](http://bit.ly/HackernoonFB)[![](img/979d9a46439d5aebbdcdca574e21dc81.png)](https://goo.gl/k7XYbx)[![](img/2930ba6bd2c12218fdbbf7e02c8746ff.png)](https://goo.gl/4ofytp)

> [é»‘å®¢ä¸­åˆ](http://bit.ly/Hackernoon)æ˜¯é»‘å®¢å¦‚ä½•å¼€å§‹ä»–ä»¬çš„ä¸‹åˆã€‚æˆ‘ä»¬æ˜¯ [@AMI](http://bit.ly/atAMIatAMI) å®¶åº­çš„ä¸€å‘˜ã€‚æˆ‘ä»¬ç°åœ¨[æ¥å—æŠ•ç¨¿](http://bit.ly/hackernoonsubmission)ï¼Œå¹¶ä¹æ„[è®¨è®ºå¹¿å‘Š&èµåŠ©](mailto:partners@amipublications.com)æœºä¼šã€‚
> 
> å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬æ¨èä½ é˜…è¯»æˆ‘ä»¬çš„[æœ€æ–°ç§‘æŠ€æ•…äº‹](http://bit.ly/hackernoonlatestt)å’Œ[è¶‹åŠ¿ç§‘æŠ€æ•…äº‹](https://hackernoon.com/trending)ã€‚ç›´åˆ°ä¸‹ä¸€æ¬¡ï¼Œä¸è¦æŠŠä¸–ç•Œçš„ç°å®æƒ³å½“ç„¶ï¼

![](img/be0ca55ba73a573dce11effb2ee80d56.png)