# ä¸ºä»€ä¹ˆæ‚¨åº”è¯¥ä½¿ç”¨ HOCs æ¥ä¿æŒ react ç»„ä»¶çš„çº¯å‡€

> åŸæ–‡ï¼š<https://medium.com/hackernoon/why-you-should-keep-your-react-components-pure-by-using-hocs-67e5c7f80c81>

![](img/d82fac5138788ce563c800dfdfa45527.png)

Image courtesy of [tahoepurewater](https://www.tahoepurewater.com)

å¦‚ä»Šæ„å»ºå‰ç«¯åº”ç”¨ç¨‹åºéå¸¸å¤æ‚ã€‚ä¸€äº› html åŠ ä¸Šä¸€ç‚¹ jQuery å°±èƒ½è§£å†³é—®é¢˜çš„æ—¥å­å·²ç»ä¸€å»ä¸å¤è¿”äº†ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å¸Œæœ›å“åº”è¿…é€Ÿã€ä¸°å¯Œã€åŠ¨æ€çš„å•é¡µé¢åº”ç”¨ç¨‹åº( **SPA** )èƒ½å¤Ÿåœ¨å¤§é‡çš„è®¾å¤‡å’Œæµè§ˆå™¨ä¸Šè¿è¡Œâ€”â€”è¿™ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰å¼ºå¤§çš„æ¡†æ¶å’Œåº“å¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ç”¨ä¸€äº› [React](https://facebook.github.io/react/) çš„ä¾‹å­å±•ç¤ºäº†ä»è¡¨ç¤ºå±‚åˆ†è§£çŠ¶æ€å¦‚ä½•æ—¢èƒ½é™ä½å¤æ‚æ€§åˆèƒ½ä¿ƒè¿›ä»£ç é‡ç”¨â€”â€”è¿™æ˜¯ä¸€ä¸ªåŒèµ¢çš„å±€é¢ï¼Œæœ‰åŠ©äºå…‹æœå¼€å‘ spa çš„æŒ‘æˆ˜ã€‚è™½ç„¶æˆ‘ä½¿ç”¨çš„æ˜¯ Reactï¼Œä½†è¿™äº›ç»éªŒæ˜¯é€šç”¨çš„ï¼Œå¯ä»¥åº”ç”¨äºä»»ä½• T4 æ¡†æ¶ã€‚

> è­¦å‘Šï¼Œä¸‹é¢æœ‰å¤§é‡ä»£ç 

è€ƒè™‘ä¸€ä¸ªç®€å•çš„ toggle React ç»„ä»¶ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºâ€œ **on** â€æˆ–â€œ **off** â€:

æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸€äº› ES7 è¯­æ³•ï¼Œä½†åŸºæœ¬ä¸Šç»„ä»¶å¯ä»¥å‘ˆç°ä¸¤ä¸ªä¸åŒçš„å…ƒç´ ï¼Œå¹¶é€šè¿‡ç”¨æˆ·ç‚¹å‡»å®ƒæ¥åˆ‡æ¢çŠ¶æ€ã€‚ä½œä¸ºè´Ÿè´£ä»»çš„å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¥æµ‹è¯•å®ƒ(å¦‚æœæˆ‘ä»¬çœŸçš„è´Ÿè´£ä»»ï¼Œæˆ‘ä»¬ä¼šé¦–å…ˆç¼–å†™è¿™äº›æµ‹è¯•ğŸ˜‹):

åˆ°ç›®å‰ä¸ºæ­¢å¾ˆç®€å•â€¦é™¤äº†åœ¨æµ‹è¯•æ•°é‡ä¸Šæœ‰ç‚¹å°‘â€”â€”æ²¡å…³ç³»ã€‚ä½†æ˜¯ï¼Œå‡è®¾æˆ‘ä»¬æœ‰å¦ä¸€ä¸ªæœ¬è´¨ä¸Šç±»ä¼¼ä½†ä¸åŒçš„ç»„ä»¶ï¼Œè¶³ä»¥ä¿è¯å®ƒæœ‰è‡ªå·±çš„ä»£ç ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥æ˜¾ç¤ºæˆ–éšè—æ¶ˆæ¯çš„ info ç»„ä»¶:

è¯¥ç»„ä»¶å…·æœ‰ä¸åŒçš„å±æ€§ï¼Œå¹¶æ˜¾ç¤ºä¸åŒçš„å…ƒç´ é›†ï¼›ç„¶è€Œï¼Œæµ‹è¯•ç»“æœéå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºåŸºæœ¬ä¸Šç»„ä»¶æ˜¯ç›¸åŒçš„:å¯¹å•ä¸ªå¸ƒå°”çŠ¶æ€å˜é‡çš„æ¡ä»¶å‘ˆç°ã€‚

åœ¨æ¯ä¸ªç»„ä»¶ä¸­ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†ä»£ç å’Œæµ‹è¯•éƒ½ä¸ç®¡ç†çŠ¶æ€æœ‰å…³ã€‚æƒ³è±¡ä¸€ä¸‹åœ¨ä¸€ä¸ªå¤§çš„ä»£ç åº“ä¸­é‡å¤è¿™ä¸ªè¿‡ç¨‹â€”â€”è¿™å¯èƒ½ä¼šæœ‰ç‚¹ä¹å‘³ã€‚é‚£ä¹ˆæˆ‘ä»¬èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿ

## å¼•å…¥é«˜é˜¶å…ƒä»¶ï¼Œå³ hoc

![](img/b9f93bc5334d68e4112d0bf426c3bdd9.png)

Image courtesy of [serenityatsummit](https://www.serenityatsummit.com)

ä»€ä¹ˆæ˜¯**ç‰¹è®¾**ï¼ï¼Ÿ

> é«˜é˜¶ç»„ä»¶(HOC)æ˜¯ React ä¸­é‡ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€æœ¯ã€‚æœ¬è´¨ä¸Šï¼Œhoc ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ã€‚å®ƒä»¬æ˜¯ä» React çš„ç»„åˆæ€§è´¨ä¸­å‡ºç°çš„ä¸€ç§æ¨¡å¼ã€‚
> 
> å…·ä½“è€Œè¨€ï¼Œ**é«˜é˜¶åˆ†é‡æ˜¯å–ä¸€ä¸ªåˆ†é‡å¹¶è¿”å›ä¸€ä¸ªæ–°åˆ†é‡çš„å‡½æ•°ã€‚**[https://Facebook . github . io/react/docs/higher-order-components . html](https://facebook.github.io/react/docs/higher-order-components.html)

ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†ä¸€ä¸ª **HOC** ï¼Œå®ƒå¯ä»¥åŒ…è£…ä»»ä½•å…·æœ‰å¼€/å…³å¸ƒå°”çŠ¶æ€çš„ç»„ä»¶ï¼Œä¸€ä¸ªç‚¹å‡»å¤„ç†ç¨‹åºæ¥åˆ‡æ¢æ ‡å¿—:

æ³¨æ„ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå¸¦æœ‰å•ä¸ªå‚æ•°`WrappedComponent`(æ·»åŠ é¢å¤–åŠŸèƒ½çš„ react ç»„ä»¶)çš„å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ–°çš„ react ç»„ä»¶ï¼›è¯¥ç»„ä»¶è´Ÿè´£å‘ˆç°åŸå§‹ç»„ä»¶ï¼Œä½†ç”¨å¸ƒå°”å±æ€§`on`å’Œç®¡ç†çŠ¶æ€çš„`toggle`å‡½æ•°è¿›è¡Œäº†ä¿®é¥°ï¼›å®ƒè¿˜ä¼šä¼ é€’æ‚¨æƒ³è¦çš„ä»»ä½•å…¶ä»–å±æ€§ã€‚

å…³äº **HOC** çš„æƒŠäººä¹‹å¤„åœ¨äºï¼Œå› ä¸ºå®ƒä»¬åªæ˜¯ç®€å•çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šä¸ª **HOC** ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥å¢åŠ æ½œåœ¨çš„æ— é™åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºç®€å•çš„ã€é€šç”¨çš„ã€ç»è¿‡è‰¯å¥½æµ‹è¯•çš„ç»„ä»¶ï¼Œæœ€ç»ˆå¾—åˆ°å¤æ‚çš„ã€åŠŸèƒ½å¼ºå¤§çš„ç»„ä»¶ã€‚

è®©æˆ‘ä»¬ä¸è¦å¿˜è®°å¯¹æˆ‘ä»¬çš„**ç‰¹è®¾**çš„æµ‹è¯•:

## ç°åœ¨æ¥çœ‹çœ‹æˆ‘ä»¬çš„çº¯ç»„ä»¶

![](img/24522871e8ee005e54ba96a54095f406.png)

Image courtesy of [eastcottvets](http://www.eastcottvets.co.uk)

> çº¯å‡½æ•°æ˜¯è¿™æ ·çš„å‡½æ•°ï¼Œç»™å®šç›¸åŒçš„è¾“å…¥ï¼Œå°†æ€»æ˜¯è¿”å›ç›¸åŒçš„è¾“å‡ºï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•å¯è§‚å¯Ÿåˆ°çš„å‰¯ä½œç”¨ã€‚[https://dr boolean . git books . io/mosely-sufficient-guide/CH3 . html](https://drboolean.gitbooks.io/mostly-adequate-guide/ch3.html)

çœ‹çœ‹æˆ‘ä»¬çš„ Toggle ç»„ä»¶ç°åœ¨æœ‰å¤šæ¼‚äº®ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ç»„ä»¶çš„å±æ€§ä¸Šä½¿ç”¨ææ„(`Toggle = ({on, toggle}) => ..`)ï¼Œè¿™ä½¿å¾—å¦‚ä½•ä½¿ç”¨ç»„ä»¶å˜å¾—éå¸¸å£°æ˜æ€§å’Œæ˜æ˜¾ï¼Œå³å®ƒéœ€è¦ä¸¤ä¸ªå‚æ•°:`on`å’Œ`toggle`ï¼›å¦‚æœæˆ‘ä»¬æ£€æŸ¥`propTypes`å¯¹è±¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°å®ƒä»¬åˆ†åˆ«æ˜¯ä¸€ä¸ªå¸ƒå°” and å‡½æ•°ã€‚*å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºææ„çš„çŸ¥è¯†ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘çš„æ–‡ç« * [*JAVASCRIPT ES6 ææ„å’Œä¸€äº›æœ‰ç”¨çš„æŠ€å·§*](/@DjamelH/javascript-es6-destructuring-and-a-few-useful-tricks-883c1c493783)

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„`withState` **HOC** ç”¨`on`çŠ¶æ€å’Œ`toggle`åŠŸèƒ½åŒ…è£…æˆ‘ä»¬çš„çº¯ç»„ä»¶ã€‚

æˆ‘ä»¬çš„æµ‹è¯•:

æˆ‘ä»¬çš„æµ‹è¯•ç°åœ¨å·²ç»æ”¹å˜äº†:æˆ‘ä»¬åªå…³å¿ƒå½“ç»„ä»¶è¢«ç‚¹å‡»æ—¶åˆ‡æ¢åŠŸèƒ½æ˜¯å¦è¢«è°ƒç”¨ï¼›æˆ‘ä»¬ç›¸ä¿¡å®é™…çš„çŠ¶æ€æ“ä½œå·²ç»è¢«æµ‹è¯•è¿‡äº†â€”â€”äº‹å®ä¹Ÿçš„ç¡®å¦‚æ­¤ï¼

è®©æˆ‘ä»¬çœ‹çœ‹ Info ç»„ä»¶æ˜¯å¦‚ä½•è¢«é‡å†™ä»¥ä½¿ç”¨`withState` **HOC** :

å¯çˆ±ï¼

æµ‹è¯•æ˜¯:

å°±åƒ Toggle ç»„ä»¶çš„æµ‹è¯•ä¸€æ ·éå¸¸ç®€å•ã€‚

# ç»“è®º

å¸Œæœ›æ‚¨å·²ç»çœ‹åˆ°äº†æˆ‘ä»¬å¦‚ä½•å°†ä¸€äº›çŠ¶æ€å§”æ‰˜ç»™ **HOC** sï¼Œè¿™é€šè¿‡å…è®¸æˆ‘ä»¬å¼€å‘å¯çˆ±çš„çº¯å‡½æ•°æ¥ç®€åŒ–æˆ‘ä»¬çš„ [React](https://hackernoon.com/tagged/react) ç»„ä»¶ã€‚ç”±äºæˆ‘ä»¬æœ€ç»ˆå¯èƒ½ä¼šå¤§é‡é‡ç”¨æˆ‘ä»¬çš„ **HOC** ï¼Œè¿™é¼“åŠ±æˆ‘ä»¬æŠ•å…¥æ—¶é—´å’Œç²¾åŠ›æ¥ç¼–å†™é«˜è´¨é‡çš„é€šç”¨ä»£ç ï¼Œå¹¶ç”¨å•å…ƒæµ‹è¯•å½»åº•è¦†ç›–ä»£ç ã€‚ä¾‹å¦‚ï¼Œæœ¬æ–‡ä¸­ä»‹ç»çš„ç®€å• withState **HOC** å¯èƒ½åº”è¯¥è¢«é‡æ„ï¼Œä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥è®¾ç½®çŠ¶æ€ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡(æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§æœ¬æ–‡[æ–‡ç« ](/@shopsifter/using-a-function-in-setstate-instead-of-an-object-1f5cfd6e55d1))ã€‚å¯¹äºæˆ‘ä»¬ä¸Šé¢çš„ç®€å•ç”¨ä¾‹ï¼Œè¿™ä¸ä¼šå¼•èµ·ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå®ƒæ˜¯ä¸€ä¸ªå¯é çš„å¯é‡ç”¨çš„ **HOC** ï¼Œæˆ‘ä»¬çœŸçš„åº”è¯¥è¿™æ ·åšã€‚

å¦‚æœæ‚¨æƒ³å°è¯•æœ¬æ–‡ä¸­çš„ä»£ç ï¼Œè¯·éšæ„å…‹éš†/æ´¾ç”Ÿæˆ‘çš„ [repo](https://github.com/dhassaine/reactPureVsClass) ã€‚

*å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨/æœ‰å¯å‘æ€§* ***ç‚¹å‡»*** ğŸ’šè¿™æ ·å…¶ä»–äººä¹Ÿå¯ä»¥äº«å—ã€‚

æ„Ÿè°¢æ‚¨çš„å®è´µæ—¶é—´ï¼å…³æ³¨æˆ‘çš„[*Twitter*](https://twitter.com/DjamelH)*å’Œ*[*LinkedIn*](https://www.linkedin.com/in/dhassaine/)*ã€‚*

å¦‚æœä½ å¯¹æ„å»ºå¤æ‚çš„åº”ç”¨ç¨‹åºæ„Ÿå…´è¶£ï¼Œä½ å¯èƒ½ä¼šå–œæ¬¢æˆ‘çš„æ–‡ç« [sentinurl.com SaaS çš„æ¶æ„](/@DjamelH/architecture-of-a-saas-sentinurl-com-a53a5c3724ee)æ¥è·å¾—ä¸€äº›é«˜å±‚æ¬¡çš„æ¶æ„å»ºè®®ã€‚

[![](img/50ef4044ecd4e250b5d50f368b775d38.png)](http://bit.ly/HackernoonFB)[![](img/979d9a46439d5aebbdcdca574e21dc81.png)](https://goo.gl/k7XYbx)[![](img/2930ba6bd2c12218fdbbf7e02c8746ff.png)](https://goo.gl/4ofytp)

> [é»‘å®¢ä¸­åˆ](http://bit.ly/Hackernoon)æ˜¯é»‘å®¢å¦‚ä½•å¼€å§‹ä»–ä»¬çš„ä¸‹åˆã€‚æˆ‘ä»¬æ˜¯ [@AMI](http://bit.ly/atAMIatAMI) å®¶åº­çš„ä¸€å‘˜ã€‚æˆ‘ä»¬ç°åœ¨[æ­£åœ¨æ¥å—æŠ•ç¨¿](http://bit.ly/hackernoonsubmission)å¹¶ä¹æ„[è®¨è®ºå¹¿å‘Š&èµåŠ©](mailto:partners@amipublications.com)æœºä¼šã€‚
> 
> å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬æ¨èä½ é˜…è¯»æˆ‘ä»¬çš„[æœ€æ–°ç§‘æŠ€æ•…äº‹](http://bit.ly/hackernoonlatestt)å’Œ[è¶‹åŠ¿ç§‘æŠ€æ•…äº‹](https://hackernoon.com/trending)ã€‚ç›´åˆ°ä¸‹ä¸€æ¬¡ï¼Œä¸è¦æŠŠä¸–ç•Œçš„ç°å®æƒ³å½“ç„¶ï¼

![](img/be0ca55ba73a573dce11effb2ee80d56.png)