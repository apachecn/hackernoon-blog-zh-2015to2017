# æˆ‘ä»¬æ”¹è¿› React åŸç”Ÿåº”ç”¨çš„ 5 ç§æ–¹å¼

> åŸæ–‡ï¼š<https://medium.com/hackernoon/5-ways-we-improved-our-react-native-app-2704d5098b20>

## æé«˜æ€§èƒ½çš„çœŸå®åœºæ™¯

![](img/8093795353b8b3e7072b749960f1e51d.png)

[unsplash](https://unsplash.com/photos/5DigPgSH27U)

åœ¨è¿‡å»çš„å‡ å¤©é‡Œï¼Œæˆ‘æœ‰æœºä¼šä¸“æ³¨äºæ”¹å–„æˆ‘ä»¬å…¬å¸å¼€å‘çš„ React åŸç”Ÿåº”ç”¨ç¨‹åºçš„æ€§èƒ½:ç”±äºå·²ç»åœ¨ä¸¤ä¸ªå¸‚åœº(iOS/Android)ä¸Šå¸‚ï¼Œæˆ‘é‡‡å–çš„æ–¹æ³•ä¸»è¦æ˜¯ä»¥ JS ä¸ºé‡ç‚¹ï¼Œä»¥ä¾¿èƒ½å¤Ÿé€šè¿‡å¾®è½¯çš„ [Codepush](https://github.com/Microsoft/react-native-code-push) å·¥å…·éƒ¨ç½²è°ƒæ•´ã€‚

æˆ‘å¿…é¡»æ‰¿è®¤ï¼Œæˆ‘å¯¹è¿™äº›æ”¹å˜çš„æœ‰æ•ˆæ€§æ„Ÿåˆ°éå¸¸æƒŠè®¶â€”â€”è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¸ä½ ä»¬åˆ†äº«å®ƒä»¬ï¼Œå¸Œæœ›å¸®åŠ©ä½ ä»¬ç†è§£æé«˜ç»©æ•ˆå¯ä»¥æ˜¯ç®€å•çš„**ï¼›æ­£å¦‚æˆ‘åœ¨ä¸Šå‘¨ä¹‹å‰æ‰€æƒ³çš„é‚£æ ·ï¼Œè¿™ä¸æ˜¯åªæœ‰é“æ†è€å…µæ‰èƒ½å®Œæˆçš„äº‹æƒ…ã€‚**

## **èµ·ç‚¹:éœ€è¦åŸºå‡†**

**æ­£å¦‚ä»»ä½•ä»äº‹è¡¨æ¼”å·¥ä½œçš„äººéƒ½ä¼šå‘Šè¯‰ä½ çš„é‚£æ ·ï¼Œåœ¨å¼€å§‹æ”¹å–„è¡¨æ¼”ä¹‹å‰ï¼Œä½ éœ€è¦ç»™è‡ªå·±é…å¤‡ä¸€äº› withâ€¦ğŸ¥æ¥è¡¡é‡å®ƒä»¬ğŸ‰**

**åœ¨`react-native`åŸºç¡€é¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º`PerfMonitor`çš„åŸºå‡†æµ‹è¯•å·¥å…·ã€‚æ ¹æ®æˆ‘çš„ç†è§£ï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯åŒä¸€ä¸ªæ ‡å‡†çš„ React Perf å·¥å…·â€”â€”ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº[çš„å†…å®¹ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒä¸ºä½ æä¾›äº†ä¸€ä¸ªå…³äºä½ çš„åº”ç”¨ç¨‹åºåœ¨æ— ç”¨çš„é‡æ–°æ¸²æŸ“ä¸­æµªè´¹äº†å¤šå°‘æ—¶é—´çš„åˆ†æï¼›ä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªç¼ºé™·ï¼Œé‚£å°±æ˜¯å®ƒåªèƒ½åœ¨è°ƒè¯•å™¨æ¨¡å¼ä¸‹è¿è¡Œï¼Œè¿™æ˜¯æ²¡æœ‰ä¼˜åŒ–çš„ã€‚](https://facebook.github.io/react/docs/perf.html)**

**æ— è®ºå¦‚ä½•ï¼Œå®ƒä»ç„¶æ˜¯ä¸€æ®µéå¸¸æœ‰ä»·å€¼çš„ä»£ç â€”â€”æˆ‘æ˜¯è¿™æ ·è®¾ç½®å®ƒçš„:**

**æˆ‘å°†è¿™å‡ è¡Œä»£ç æ”¾åœ¨æˆ‘ä»¬çš„æ ¹ç»„ä»¶ä¹‹ä¸€çš„ ComponentDidMount ä¸­ï¼Œè¿™ä¸ªæ ¹ç»„ä»¶å«åš Loggedâ€”â€”å®ƒåŸºæœ¬ä¸Šâ€œæ‹¥æœ‰â€ç™»å½•ç”¨æˆ·çš„ä¸»å¯¼èˆªã€‚åœ¨è¿™äº›è¡Œæœªè¢«æ³¨é‡Šçš„æƒ…å†µä¸‹ï¼Œåœ¨â€œå¯åŠ¨â€æ—¶ï¼Œè¯¥å·¥å…·å°†å¼€å§‹è®°å½•å‘ç”Ÿçš„ä¸€åˆ‡ï¼Œå¹¶åœ¨ 20 ç§’å(åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯å°†ä¸€åˆ‡æ­£ç¡®åŠ è½½åˆ°åº”ç”¨ç¨‹åºä¸­çš„è‰¯å¥½â€œå¹³ç¨³â€æ—¶é—´)ï¼Œå®ƒå°†æ‰“å°å‡ºå…³äºæ¸²æŸ“çš„åˆ†æã€‚**

**æˆ‘ä¸èƒ½è¿›å…¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ¶æ„çš„ç»†èŠ‚ï¼Œä½†æˆ‘è®¤ä¸ºä½ åº”è¯¥çŸ¥é“çš„æ˜¯ï¼Œæåˆ°çš„æ—¥å¿—ç»„ä»¶åŒ…å«ä¸»å¯¼èˆªæ ‡ç­¾æ (ç”± 4 ä¸ªæ ‡ç­¾ç»„æˆ)ï¼Œç¬¬ä¸€ä¸ªä¸»æ ‡ç­¾åŒ…å«è‡ªå·±çš„æ ‡ç­¾æ å¯¼èˆªï¼Œä¹Ÿæ˜¯ 4 ä¸ªæ ‡ç­¾(å…¶ä¸­ä¸€ä¸ªä½¿ç”¨ Airbnb çš„[åœ°å›¾](https://github.com/airbnb/react-native-maps)ç»„ä»¶)ã€‚
*(å¯¹äº†ï¼Œæˆ‘ä»¬ç”¨* [*ååº”-å¯¼èˆª*](https://github.com/react-community/react-navigation) *)***

**![](img/b76d901bdf5de389a0333f2029f2c0b2.png)**

**The actual starting point**

**è¿™æ˜¯æˆ‘ä½¿ç”¨çš„åŸºçº¿:åœ¨åº”ç”¨ä»»ä½•ä¼˜åŒ–ä¹‹å‰ï¼Œè¿™æ˜¯ Perf å·¥å…·æä¾›çš„åŸºå‡†ã€‚**

## **æ”¹è¿› 1:å¼ºåˆ¶æ‰§è¡Œæ— ç»‘å®šè§„åˆ™**

**ä½œä¸ºä¸€ä¸ªå·²ç»åœ¨ v2.x ä¸­çš„åº”ç”¨ç¨‹åºï¼Œç»è¿‡ä¸€å¹´å¤šçš„å¼€å‘ï¼Œéš¾æ€ªä»£ç åº“æ²¡æœ‰åœ¨æ¯ä¸ªè§’è½éƒ½å¾—åˆ°å®Œå–„â€”â€”è°¢å¤©è°¢åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ [Eslint](https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/jsx-no-bind.md) æˆåŠŸåœ°æ‰¾åˆ°å¹¶æ›´æ–°äº†æ‰€æœ‰ä¸éµå®ˆè§„åˆ™çš„æ–‡ä»¶ã€‚**

**![](img/76f364635eb9429487f1bc3ea7e55831.png)**

**æˆ‘ä»¬åœ¨å‰ 10 åä¸­è·å¾—äº†ä¸é”™çš„~ *50ms* (åªæœ‰å‡ ä¸ªä¾‹å¤–ï¼Œæ¯”å¦‚ CellRenderer)ã€‚å¾ˆå¥½ï¼Œä½†æ²¡ä»€ä¹ˆå¤§é—®é¢˜â€”â€”æ‰€ä»¥æˆ‘ç»§ç»­æŒ–ã€‚**

## **æ”¹è¿› 2:æ”¹å˜æ¯”è¾ƒå™¨**

**ç”±äºæˆ‘ä»¬çš„ä¸€äº›ç»„ä»¶æœ‰å¤§é‡çš„é¡¹ç›®è¦æ˜¾ç¤º(*åƒå¤§å¤šæ•°åº”ç”¨ç¨‹åº*)ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ç‰¹å®šçš„æ–¹å¼å¯¹é“å…·çš„å˜åŒ–åšå‡ºååº”ã€‚æˆ‘ä»¬åœ¨ componentWillReceiveProps ä¸­åšçš„ä¸€é¡¹æ£€æŸ¥æ˜¯å¯¹åˆ—è¡¨çš„æ•°æ®é›†è¿›è¡Œçš„ï¼Œå½“æˆ‘ä»¬å°†æ•°ç»„æ¯”è¾ƒä» standard ===æ›´æ”¹ä¸º [lodash](https://lodash.com/docs/4.17.4#isEqual) _ æ—¶ã€‚isEqual()æ–¹æ³•ï¼Œäº‹æƒ…æ˜¯è¿™æ ·çš„:**

**![](img/e56c2a33a7d575b316e6c78ea0266328.png)**

**è¿™æ˜¯æœ€æœ‰æ•ˆçš„ä¼˜åŒ–ä¹‹ä¸€:æ˜¾ç„¶ lodash æ–¹æ³•æ›´é€‚åˆæ¯”è¾ƒæ•°ç»„â€”â€”æˆ–è€…ä¹Ÿè®¸æˆ‘åªæ˜¯ä¸ªèœé¸Ÿï¼Œé™¤äº†æˆ‘ä¹‹å¤–ï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“å®ƒğŸ˜‡**

## **æ”¹è¿›#3:åŠŸèƒ½ç»„ä»¶ FTW**

**ä½¿ç”¨æˆ‘ä¸ä¹…å‰è¯»è¿‡çš„è¿™ç¯‡æ–‡ç« ä½œä¸ºåŸºçº¿ï¼Œæˆ‘ä»¬å†³å®šé‡æ„è®¸å¤šç»„ä»¶ï¼Œä»¥ä½¿å®ƒä»¬å…·æœ‰åŠŸèƒ½æ€§ã€‚ç»“æœè®©æˆ‘å¤§åƒä¸€æƒŠ:**

**![](img/a3eaa901e20a8dab69a8228758af4670.png)**

**å¦ä¸€ä¸ªå·¨å¤§çš„æ€§èƒ½æ”¹è¿›ï¼Œé€šè¿‡ç®€å•çš„ä»£ç é‡æ„ï¼æˆ‘éå¸¸å…´å¥‹:æˆ‘ä»¬åœ¨æœ€é‡çš„ç»„ä»¶ä¸Šæµªè´¹çš„æ—¶é—´ä»å¤§çº¦ 750 æ¯«ç§’å‡å°‘åˆ°äº†ä¸åˆ° 300 æ¯«ç§’ï¼ä½†æ˜¯å°±åœ¨æˆ‘å‡†å¤‡ğŸ¾â€¦**

> **ç°å®ã€‚**å‡»æ€**ã€‚å›æ¥äº†ã€‚**

**ä»»ä½•äººéƒ½ä¸ä¼šæ„Ÿåˆ°æƒŠè®¶ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºä¼šä¸æ–­åœ°ä¸åç«¯è¿›è¡Œé€šä¿¡ï¼Œåç«¯æä¾›äº†éœ€è¦åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­æ˜¾ç¤ºçš„å¤§å¤šæ•°æ•°æ®ã€‚**

**ç»“æœæ˜¯ï¼Œåœ¨æˆ‘æ‰€æœ‰çš„è°ƒæ•´å’Œä¿®å¤ä»¥åŠå¯¹æ€§èƒ½æ”¹è¿›æ„Ÿåˆ°å…´å¥‹çš„è¿‡ç¨‹ä¸­â€¦æˆ‘ä»¬çš„åç«¯å¹¶æ²¡æœ‰å®Œå…¨å·¥ä½œğŸ‘¾**

**å› æ­¤ï¼Œå°±åœ¨æˆ‘å‡†å¤‡è¿è¡Œæœ€åä¸€ä¸ªåŸºå‡†æµ‹è¯•æ—¶ï¼Œæˆ‘çš„è€æ¿é€šè¿‡ Slack é€šçŸ¥æˆ‘ï¼Œä»–å·²ç»ä¿®å¤äº†åç«¯çš„ä¸€ä¸ª bugï¼Œåœ°å›¾ä¸Šçš„å¤§å¤´é’ˆç»ˆäºåˆå‡ºç°äº†ã€‚**

> **å“¦ï¼Œä¸â€¦**

**æˆ‘è¿è¡ŒåŸºå‡†ã€‚**

**![](img/031f508d6a20db5958b72e48bd5f4962.png)****![](img/de47c7ca7d347905225db7042ab17a76.png)**

**My reaction #truefact**

**æ‹¥æœ‰(å†æ¬¡)æ»¡æ˜¯å¤§å¤´é’ˆçš„åœ°å›¾åˆ›é€ äº†ä¸€ä¸ªå…¨æ–°å±‚æ¬¡çš„æµªè´¹ msã€‚**

> **(å°å…è´£å£°æ˜:ä¸è¦è®¤ä¸ºè¿™æ˜¯å¯¹é‚£äº›åˆ›å»ºå’Œç»´æŠ¤åœ°å›¾ç»„ä»¶çš„å¼€å‘äººå‘˜çš„å’†å“®ï¼Œå¥½å—ï¼ï¼Ÿè¿™äº›å·¨å¤§çš„æ•°å­—è‚¯å®šæ˜¯ç”±æˆ‘ç¼ºä¹ç»éªŒé€ æˆçš„)**

**æ‰€ä»¥ï¼ŒåŸºæœ¬ä¸Šï¼Œæˆ‘åˆå›åˆ°äº†èµ·ç‚¹â€¦ä½†æˆ‘ç°åœ¨ä¸èƒ½åœä¸‹æ¥ï¼Œæˆ‘ç¦»è¡¨æ¼”å¤©å ‚æ˜¯å¦‚æ­¤ä¹‹è¿‘ï¼**

## **æ”¹è¿› 4:è®©æˆ‘ä»¬å…³æ³¨ TabMap**

**å¤šäºäº†è¿™ä¸ªå·¥å…·ï¼Œå¾ˆå®¹æ˜“å‘ç°åŒ…å«åœ°å›¾ç»„ä»¶çš„é€‰é¡¹å¡æ ¹æœ¬æ²¡æœ‰ä¼˜åŒ–ã€‚å› æ­¤ï¼Œæˆ‘é›†ä¸­äº†æˆ‘çš„æ™ºæ…§ï¼Œä¸º tabMap ç»„ä»¶æ·»åŠ äº†ä¸€äº›å°çš„ä¿®æ­£ï¼Œå¹¶æŠŠä¸€äº›éƒ¨åˆ†è½¬ç§»åˆ°äº†åŠŸèƒ½ä¸Š:**

**![](img/f4b3dcf6b1fead9608cb2a2740873698.png)**

**æˆ‘ä»¬åˆæœ‰äº†ä¸€äº›æ”¹è¿›ã€‚ä½†æ˜¯è¿˜ä¸å¤Ÿâ€¦æ˜¯æœ€åä¸€æ¬¡å°è¯•çš„æ—¶å€™äº†ğŸ’ª**

## **æ”¹è¿› 5:ä¿®æ”¹ TabMap çš„é€»è¾‘**

**é€šè¿‡æ”¹å˜ tabMap çš„`render()`æ–¹æ³•ä¸­çš„é€»è¾‘ï¼Œæˆ‘è®¾æ³•åªåœ¨ç»„ä»¶å®é™…â€œæ˜¾ç¤ºâ€æ—¶æ‰åŠ è½½å¼•è„š&æ ‡è®°â€”â€”ä»£ç ç±»ä¼¼äº:**

**è€ƒè™‘åˆ°æ‰€æœ‰è¿™äº›æµ‹é‡éƒ½æ˜¯åœ¨ä¸€ä¸ª *20000 ms* çš„æ—¶é—´è·¨åº¦å†…è¿›è¡Œçš„ï¼Œè¿™æœ€åçš„æ”¹è¿›è®¾æ³•è®©æˆ‘ä»¬â€œå›åˆ°äº†è‰¯å¥½çš„è¡¨ç°â€:**

**![](img/c48e33e62f02c19eb0c53da97b32b076.png)**

**æˆ‘æœ€ç»ˆå¯¹è¿™äº›æ”¹è¿›æ„Ÿåˆ°æ»¡æ„:ä¸€æ—¦æˆ‘ä»¬å°†å®ƒä»¬ä»£ç åŒ–ï¼Œâš›ï¸åº”ç”¨ç¨‹åºå‘å¸ƒç‰ˆæœ¬çš„å·®å¼‚å°±å¯ä»¥æ„Ÿè§‰åˆ°äº†ã€‚**

**![](img/0b380ffdb725c2a6cf0e6b1b8a065801.png)**

**this MAY have been my boss reaction**

**å½“ç„¶è¿˜å¯ä»¥åšå¾—æ›´å¤š:æˆ‘ä¸æ˜¯ JS ä¸“å®¶ï¼Œå½“ç„¶ [Tal Kol](https://medium.com/u/83a4f96844d0?source=post_page-----2704d5098b20--------------------------------) èƒ½å¤Ÿç¼–å†™å‡ºæ›´å¤šçš„æ€§èƒ½ä»£ç (*å¦‚æœä½ ä»æœªå¬è¯´è¿‡ä»–æˆ–è¯»è¿‡ä»–å…³äº React Native performances çš„æ–‡ç« ï¼Œè¯·è®¿é—®* ***ç°åœ¨***)â€”â€”ä½†æ˜¯ï¼Œå˜¿ï¼Œä»ç„¶å¾—åˆ°äº†ä¸€äº›å¯é çš„ç»“æœğŸ˜Š**

***æˆ‘çœŸè¯šåœ°å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯ä»¥å¸®åŠ©ä½ å¼€å‘è‡ªå·±çš„ React åŸç”Ÿåº”ç”¨ï¼Œå¹¶ä¸”æˆ‘ä¸Šé¢å†™çš„æ²¡æœ‰é‡å¤§é”™è¯¯ã€‚
ä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥è¯´ï¼Œæˆ‘çœŸçš„å¾ˆæœŸå¾…ä½ çš„åé¦ˆå’Œ/æˆ–å»ºè®®:è¯·éšæ„å‘è¡¨è¯„è®ºæˆ–æ¨æ–‡* [*me*](https://twitter.com/Kelset) *æˆ‘å¾ˆä¹æ„ä¸ä½ ä»¬äº¤è°ˆ*ğŸ¤“**

***å’Œä¸€å¦‚æ—¢å¾€çš„***

****å¿«ä¹ç¼–ç ï¼ğŸ¤–****

**[![](img/50ef4044ecd4e250b5d50f368b775d38.png)](http://bit.ly/HackernoonFB)****[![](img/979d9a46439d5aebbdcdca574e21dc81.png)](https://goo.gl/k7XYbx)****[![](img/2930ba6bd2c12218fdbbf7e02c8746ff.png)](https://goo.gl/4ofytp)**

> **[é»‘å®¢ä¸­åˆ](http://bit.ly/Hackernoon)æ˜¯é»‘å®¢å¦‚ä½•å¼€å§‹ä»–ä»¬çš„ä¸‹åˆã€‚æˆ‘ä»¬æ˜¯é˜¿ç¾æ—å®¶åº­çš„ä¸€å‘˜ã€‚æˆ‘ä»¬ç°åœ¨[æ¥å—æŠ•ç¨¿](http://bit.ly/hackernoonsubmission)å¹¶ä¹æ„[è®¨è®ºå¹¿å‘Š&èµåŠ©](mailto:partners@amipublications.com)æœºä¼šã€‚**
> 
> **å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬æ¨èä½ é˜…è¯»æˆ‘ä»¬çš„[æœ€æ–°ç§‘æŠ€æ•…äº‹](http://bit.ly/hackernoonlatestt)å’Œ[è¶‹åŠ¿ç§‘æŠ€æ•…äº‹](https://hackernoon.com/trending)ã€‚ç›´åˆ°ä¸‹ä¸€æ¬¡ï¼Œä¸è¦æŠŠä¸–ç•Œçš„ç°å®æƒ³å½“ç„¶ï¼**

**![](img/be0ca55ba73a573dce11effb2ee80d56.png)**