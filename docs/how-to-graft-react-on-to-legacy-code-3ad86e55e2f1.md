# å¦‚ä½•ç§»æ¤é—ç•™ä»£ç 

> åŸæ–‡ï¼š<https://medium.com/hackernoon/how-to-graft-react-on-to-legacy-code-3ad86e55e2f1>

![](img/d75b3d932f8700b4c87f6861654bc81b.png)

æœ‰å¾ˆå¤šæ´»çš„é¡¹ç›®æ˜¯ä½¿ç”¨æ—§çš„ web æŠ€æœ¯æ ˆæ„å»ºçš„ã€‚ä»å¤´å¼€å§‹é€šå¸¸æ˜¯ä¸å¯èƒ½çš„ï¼Œå‡çº§ä»£ç åº“å¯èƒ½æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨æ²¡æœ‰å•å…ƒæµ‹è¯•æˆ–åˆé€‚çš„æ„å»ºå·¥å…·çš„æƒ…å†µä¸‹ã€‚æœ¬æ–‡è®¨è®ºå¹¶æ¼”ç¤ºäº†ä¸€ä¸ªç®€å•çš„å·¥ä½œæ¼”ç¤ºï¼Œé€šè¿‡ä½¿ç”¨ Redux å’Œ [Ducks++](/@DjamelH/ducks-redux-reducer-bundles-44267f080d22) æ¨¡å¼ï¼Œå°† Backbone/jQuery åº”ç”¨ç¨‹åºä¸ [React](https://hackernoon.com/tagged/react) é›†æˆã€‚å¦‚æœä½ æ²¡æœ‰å¬è¯´è¿‡ Ducksï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªç®€å•çš„è®¾è®¡æ¨¡å¼ï¼Œç”¨äºæ¨¡å—åŒ–ä½ çš„ Redux ä»£ç ã€‚

# è¯¥åº”ç”¨ç¨‹åº

åœ¨ [CodePen](https://codepen.io/dhassaine/pen/ybwqQZ?editors=1011) å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç°åœºå·¥ä½œæ¼”ç¤ºï¼Œæ•´ä¸ªé¡¹ç›®ä¹Ÿå¯ä»¥åœ¨ [GitHub](https://github.com/dhassaine/legacy2react) ä¸Šæ‰¾åˆ°ã€‚app æ¼”ç¤ºäº†ä¸¤ä¸ªå¼€å…³:ä¸€ä¸ªæ˜¯ç”¨ Backbone/jQuery å®ç°çš„ï¼Œä¸€ä¸ªæ˜¯ç”¨ React å®ç°çš„ï¼›ç„¶è€Œï¼Œä¸¤è€…éƒ½æ˜¯é€šè¿‡ä¸»å¹²æ¨¡å‹å’Œ Redux å­˜å‚¨åŒæ­¥çš„ã€‚React ä»£ç è¢«æ‰“åŒ…å¹¶æ”¾å…¥åˆ°ä¼ ç»Ÿçš„åº”ç”¨ç¨‹åºä¸­â€”â€”å®é™…ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œè¡Œä¸ºå°±åƒä¸€ä¸ªåº“ã€‚

# ååº”æ¨¡å—

é—ç•™åº”ç”¨ç¨‹åºä»ç„¶å¤„äºä¸»å¯¼åœ°ä½ï¼Œè´Ÿè´£æ„å»ºå’Œå®‰è£… React ä»£ç :

```
var reactToggleApp = window.reactModule.make(
  { 
    el: document.getElementById('react-module') 
  }
);reactToggleApp.render();
```

React ä»£ç å¯é€šè¿‡ä¸€ä¸ªå·¥å‚å‡½æ•°è·å¾—ï¼Œè¯¥å‡½æ•°æ˜¯å…¨å±€å¯ç”¨çš„ã€‚è¿™å…è®¸æˆ‘ä»¬ä¼ å…¥å¿…è¦çš„å›è°ƒå’Œé€‰é¡¹ï¼Œä¾‹å¦‚é”™è¯¯å¤„ç†æœºåˆ¶æˆ–ç¿»è¯‘åŠŸèƒ½ã€‚React æ¨¡å—è¿˜éœ€è¦ä¸€ä¸ª DOM å…ƒç´ æ¥æŒ‚è½½ã€‚è¿è¡Œå·¥å‚å‡½æ•°åï¼Œå°†è¿”å›ä¸€ä¸ªå…·æœ‰ä»¥ä¸‹æ¥å£çš„å¯¹è±¡:

```
{
  render,
  destroy,
  store,
  ducks
}
```

æ¸²æŸ“å’Œé”€æ¯å…è®¸çˆ¶åº”ç”¨ç¨‹åºå¯åŠ¨å’Œåˆ é™¤ react åº”ç”¨ç¨‹åºã€‚Redux å­˜å‚¨å’Œ ducks æ¨¡å—æ˜¯å®ç°ä¸¤ä¸ªä¸–ç•ŒåŒæ­¥çš„å…³é”®ã€‚

# è¿™åº§æ¡¥

![](img/08e0b3294d7bdcbe82edbd846c63a75e.png)

å·¥å‚å‡½æ•°å…¬å¼€äº† Redux å­˜å‚¨ï¼Œè¿™å…è®¸æˆ‘ä»¬è®¢é˜…å­˜å‚¨ä¸­çš„ä»»ä½•æ›´æ”¹ï¼Œå¹¶å°†è¿™äº›æ›´æ”¹ä¼ æ’­åˆ°ä¸»å¹²æ¨¡å‹ã€‚ç±»ä¼¼åœ°ï¼Œå¯¹ä¸»å¹²æ¨¡å‹çš„æ›´æ”¹å¯ä»¥é€šè¿‡åˆ†æ´¾é€‚å½“çš„åŠ¨ä½œä¼ æ’­åˆ° Redux å­˜å‚¨ã€‚å®ç°è¿™ä¸€ç‚¹çš„è¯€çªæ˜¯éµå¾ª Ducks++æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å°†åŠ¨ä½œå’Œé€‰æ‹©å™¨æ†ç»‘åœ¨ä¸€èµ·ã€‚æ³¨æ„åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨`actionCreators`å’Œ`selectors`å°†ä¸»å¹²æ¨¡å‹çš„å±æ€§`on`åŒæ­¥åˆ°`keyValues`é¸­å­çš„å±æ€§`toggle` ã€‚

```
model.on('change:on', function (model, value) {
  window.reactModule.store.dispatch(
    window.reactModule.ducks.keyValues.actionCreators.setValue(
      'toggle', value
  ));
});window.reactModule.store.subscribe(function() {
  var state = window.reactModule.store.getState();
  var value = window.reactModule.ducks.keyValues.selectors.getValue(
    state, 'toggle'); model.set('on', value);
});
```

æˆ‘ä»¬ç°åœ¨æœ‰èƒ½åŠ›ç”¨ react æ¨¡å—æ›¿æ¢é—ç•™ç»„ä»¶ï¼Œå¹¶æœ€ç»ˆæ›¿æ¢æ‰€æœ‰é—ç•™ä»£ç ã€‚

# ç»“è®º

è€ƒè™‘åˆ°æˆ‘ä»¬æ­£åœ¨å°†ä¸€ä¸ªå…¨æ–°çš„ä»£ç åº“åˆå¹¶åˆ°ä¸€ä¸ªé—ç•™ç³»ç»Ÿä¸­ï¼Œè¿™ç§æ–¹æ³•å‡ºäººæ„æ–™åœ°ç›´æ¥ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨ä¸€ä¸ªå•ç‹¬çš„å­˜å‚¨åº“ä¸­å®ç° React ä»£ç ï¼Œå¹¶åƒå¯¹å¾…ä¸€ä¸ªç»¿åœ°é¡¹ç›®ä¸€æ ·å¯¹å¾…å®ƒâ€”â€”é¢å¯¹ç°å®å§ï¼Œè°ä¸æƒ³åœ¨ç»¿åœ°ä¸Šå·¥ä½œå‘¢ï¼ï¼Ÿ

è¯·è®°ä½ï¼Œå¦‚æœæ‚¨æƒ³å°è¯•æœ¬æ–‡ä¸­çš„ä»£ç ï¼Œè¯·éšæ„å…‹éš†/æ´¾ç”Ÿæˆ‘çš„ [repo](https://github.com/dhassaine/legacy2react) ã€‚

*å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨/é¼“èˆäººå¿ƒ* ***ç‚¹å‡»*** ğŸ’šè¿™æ ·å…¶ä»–äººä¹Ÿå¯ä»¥äº«å—ã€‚

æ„Ÿè°¢æ‚¨çš„å®è´µæ—¶é—´ï¼å…³æ³¨æˆ‘çš„[*Twitter*](https://twitter.com/DjamelH)*å’Œ*[*LinkedIn*](https://www.linkedin.com/in/dhassaine/)*ã€‚*

[![](img/50ef4044ecd4e250b5d50f368b775d38.png)](http://bit.ly/HackernoonFB)[![](img/979d9a46439d5aebbdcdca574e21dc81.png)](https://goo.gl/k7XYbx)[![](img/2930ba6bd2c12218fdbbf7e02c8746ff.png)](https://goo.gl/4ofytp)

> [é»‘å®¢ä¸­åˆ](http://bit.ly/Hackernoon)æ˜¯é»‘å®¢å¦‚ä½•å¼€å§‹ä»–ä»¬çš„ä¸‹åˆã€‚æˆ‘ä»¬æ˜¯é˜¿ç¾æ—å®¶åº­çš„ä¸€å‘˜ã€‚æˆ‘ä»¬ç°åœ¨[æ¥å—æŠ•ç¨¿](http://bit.ly/hackernoonsubmission)å¹¶ä¹æ„[è®¨è®ºå¹¿å‘Š&èµåŠ©](mailto:partners@amipublications.com)æœºä¼šã€‚
> 
> å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬æ¨èä½ é˜…è¯»æˆ‘ä»¬çš„[æœ€æ–°ç§‘æŠ€æ•…äº‹](http://bit.ly/hackernoonlatestt)å’Œ[è¶‹åŠ¿ç§‘æŠ€æ•…äº‹](https://hackernoon.com/trending)ã€‚ç›´åˆ°ä¸‹ä¸€æ¬¡ï¼Œä¸è¦æŠŠä¸–ç•Œçš„ç°å®æƒ³å½“ç„¶ï¼

![](img/be0ca55ba73a573dce11effb2ee80d56.png)