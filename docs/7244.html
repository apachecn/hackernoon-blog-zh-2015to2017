<html>
<head>
<title>React â€” Reusable component state</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React â€”å¯é‡ç”¨ç»„ä»¶çŠ¶æ€</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/react-reusable-component-state-805163dc355?source=collection_archive---------7-----------------------#2017-10-21">https://medium.com/hackernoon/react-reusable-component-state-805163dc355?source=collection_archive---------7-----------------------#2017-10-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="0645" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">å¦‚ä½•åœ¨ç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€å’Œæ–¹æ³•ã€‚</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/8933e4fa3854e49902a096a7f2866351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y6C4nSvy2Woe0m7bWEn4BA.png"/></div></div></figure><p id="32d4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">åˆ°ç°åœ¨å¤§å®¶éƒ½å­¦ä¼šäº†ï¼Œç”¨æ„å›¾è€Œä¸æ˜¯ç»§æ‰¿ã€‚ç„¶è€Œï¼Œå¯¹äºæŸäº›äº‹æƒ…ï¼Œå°¤å…¶æ˜¯å¯¹äºä¸ç†Ÿæ‚‰å‡½æ•°å¼<a class="ae kr" href="https://hackernoon.com/tagged/programming" rel="noopener ugc nofollow" target="_blank">ç¼–ç¨‹</a>çš„å¼€å‘äººå‘˜æ¥è¯´ï¼Œå¯èƒ½ä¸æ¸…æ¥šå¦‚ä½•æ­£ç¡®åœ°ä½¿ç”¨ç»„åˆã€‚</p><p id="8660" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯å¦‚ä½•<strong class="jx hv">é‡ç”¨</strong>ç»„ä»¶ä¹‹é—´çš„çŠ¶æ€å’Œå…±äº«æ–¹æ³•ã€‚</p><p id="595e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æˆ‘ç”¨ä¸€ä¸ªåˆ—è¡¨æ¥ä¸¾ä¾‹ã€‚åˆ—è¡¨å®šä¹‰å¦‚ä¸‹ï¼Œæœ‰çŠ¶æ€ä¸­çš„<code class="eh ks kt ku kv b">nextItem()</code>ã€<code class="eh ks kt ku kv b"> prevItem()</code>ã€<code class="eh ks kt ku kv b">onChange(selectedItem)</code>æ–¹æ³•ã€<code class="eh ks kt ku kv b">selectedItem</code>ç­‰åŸºæœ¬å†…å®¹ã€‚å®ƒæœŸå¾…<code class="eh ks kt ku kv b">props</code>ä¸­çš„<code class="eh ks kt ku kv b">items</code>ï¼Œå½“ç„¶æœ€åä¼šå‘ˆç°ä¸€ä¸ªåˆ—è¡¨ã€‚</p><pre class="jk jl jm jn fq kw kv kx ky aw kz dt"><span id="f270" class="la lb hu kv b fv lc ld l le lf"><strong class="kv hv">class </strong>List <strong class="kv hv">extends </strong>Component {<br/>  constructor(props) {<br/>    <strong class="kv hv">super</strong>(props);<br/>    <strong class="kv hv">this</strong>.<strong class="kv hv">state </strong>= {<br/>      <strong class="kv hv">selectedItem</strong>: 0,<br/>    }<br/>  }<br/><br/>  componentWillUpdate({onChange, items}, nextState) {<br/>    <strong class="kv hv">if </strong>(onChange &amp;&amp; nextState.<strong class="kv hv">selectedItem </strong>!== <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>.<strong class="kv hv">selectedItem</strong>) {<br/>      onChange(items[nextState.<strong class="kv hv">selectedItem</strong>]);<br/>    }<br/>  }<br/><br/>  nextItem() {<br/>    <strong class="kv hv">const </strong>{<strong class="kv hv">selectedItem</strong>} = <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>;<br/>    <strong class="kv hv">const </strong>{items} = <strong class="kv hv">this</strong>.<strong class="kv hv">props</strong>;<br/><br/>    <strong class="kv hv">if </strong>(items.length === <strong class="kv hv">selectedItem </strong>+ 1) {<br/>      <strong class="kv hv">return</strong>;<br/>    }<br/><br/>    <strong class="kv hv">this</strong>.setState({<strong class="kv hv">selectedItem</strong>: <strong class="kv hv">selectedItem </strong>+ 1});<br/>  }<br/><br/>  prevItem() {<br/>    <strong class="kv hv">const </strong>{<strong class="kv hv">selectedItem</strong>} = <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>;<br/><br/>    <strong class="kv hv">if </strong>(<strong class="kv hv">selectedItem </strong>=== 0) {<br/>      <strong class="kv hv">return</strong>;<br/>    }<br/><br/>    <strong class="kv hv">this</strong>.setState({<strong class="kv hv">selectedItem</strong>: <strong class="kv hv">selectedItem </strong>- 1});<br/>  }<br/><br/>  render() {<br/>    <strong class="kv hv">const </strong>{items} = <strong class="kv hv">this</strong>.<strong class="kv hv">props</strong>;<br/>    <strong class="kv hv">const </strong>{<strong class="kv hv">selectedItem</strong>} = <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>;<br/><br/>    <strong class="kv hv">return </strong>(<br/>      &lt;<strong class="kv hv">ul</strong>&gt;<br/>        {<br/>          items.map((item, index) =&gt; (<br/>            &lt;<strong class="kv hv">li className=</strong>{<strong class="kv hv">`</strong>${<strong class="kv hv">selectedItem </strong>=== index ? <strong class="kv hv">'selected' </strong>: <strong class="kv hv">''</strong>}<strong class="kv hv">`</strong>}&gt;<br/>              {item}<br/>            &lt;/<strong class="kv hv">li</strong>&gt;<br/>          ))<br/>        }<br/>      &lt;/<strong class="kv hv">ul</strong>&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="a70f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ç°åœ¨ï¼Œå½“æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ¸…æ™°çš„åˆ—è¡¨ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ã€‚</p><p id="ea32" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">é—®:å¦‚ä½•åˆ›å»ºListVerticalå’ŒListHorizontalï¼Ÿ</strong></p><p id="4f82" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¸¦<a class="ae kr" href="https://hackernoon.com/tagged/hoc" rel="noopener ugc nofollow" target="_blank"> HOC </a>(é«˜é˜¶ç»„ä»¶)<code class="eh ks kt ku kv b">withList</code> HOCã€‚æ‰€ä»¥åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯åˆ†ç¦»å¹¶ä¼ é€’æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ç»™åŒ…è£…çš„ç»„ä»¶ã€‚çœ‹å¥½äº†ã€‚</p><pre class="jk jl jm jn fq kw kv kx ky aw kz dt"><span id="7b12" class="la lb hu kv b fv lc ld l le lf"><strong class="kv hv">function </strong><em class="lg">withList</em>(WrappedComponent) {<br/>  <strong class="kv hv">return class extends </strong>Component {<br/>    constructor(props) {<br/>      <strong class="kv hv">super</strong>(props);<br/>      <strong class="kv hv">this</strong>.<strong class="kv hv">state </strong>= {<br/>        <strong class="kv hv">selectedIndex</strong>: 0,<br/>      }<br/>    }<br/><br/>    componentWillUpdate({onChange, items}, nextState) {<br/>      <strong class="kv hv">if </strong>(onChange &amp;&amp; nextState.<strong class="kv hv">selectedIndex </strong>!== <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>.<strong class="kv hv">selectedIndex</strong>) {<br/>        onChange(items[nextState.<strong class="kv hv">selectedIndex</strong>]);<br/>      }<br/>    }<br/><br/>    <em class="lg">nextItem </em>= () =&gt; {<br/>      <strong class="kv hv">const </strong>{selectedIndex} = <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>;<br/>      <strong class="kv hv">const </strong>{items} = <strong class="kv hv">this</strong>.<strong class="kv hv">props</strong>;<br/><br/>      <strong class="kv hv">if </strong>(items.<strong class="kv hv">length </strong>=== selectedIndex + 1) {<br/>        <strong class="kv hv">return</strong>;<br/>      }<br/><br/>      <strong class="kv hv">this</strong>.setState({<strong class="kv hv">selectedIndex</strong>: selectedIndex + 1});<br/>    };<br/><br/>    <em class="lg">prevItem </em>= () =&gt; {<br/>      <strong class="kv hv">const </strong>{selectedIndex} = <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>;<br/><br/>      <strong class="kv hv">if </strong>(selectedIndex === 0) {<br/>        <strong class="kv hv">return</strong>;<br/>      }<br/><br/>      <strong class="kv hv">this</strong>.setState({<strong class="kv hv">selectedIndex</strong>: selectedIndex - 1});<br/>    };<br/><br/>    <em class="lg">selectItem </em>= (selectedIndex) =&gt; {<br/>      <strong class="kv hv">this</strong>.setState({selectedIndex});<br/>    };<br/><br/>    render() {<br/>      <strong class="kv hv">const </strong>{selectedIndex} = <strong class="kv hv">this</strong>.<strong class="kv hv">state</strong>;<br/><br/>      <strong class="kv hv">return </strong>(<br/>        &lt;<strong class="kv hv">WrappedComponent<br/>          </strong>{...<strong class="kv hv">this</strong>.<strong class="kv hv">props</strong>}<br/>          <strong class="kv hv">prevItem=</strong>{<strong class="kv hv">this</strong>.<em class="lg">prevItem</em>}<br/>          <strong class="kv hv">nextItem=</strong>{<strong class="kv hv">this</strong>.<em class="lg">nextItem</em>}<br/>          <strong class="kv hv">selectItem=</strong>{<strong class="kv hv">this</strong>.<em class="lg">selectItem</em>}<br/>          <strong class="kv hv">selectedIndex=</strong>{selectedIndex}<br/>        /&gt;<br/>      );<br/>    }<br/>  }<br/>}</span></pre><p id="dc08" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æ‚¨æ‰€è§ï¼Œè¢«åŒ…è£…çš„ç»„ä»¶å°†æ‹¥æœ‰æ‰€æœ‰å¯ç”¨çš„æ–¹æ³•å’Œ<code class="eh ks kt ku kv b">selectedIndex</code>ã€‚ä¸æ˜¯ä»<code class="eh ks kt ku kv b">this</code>ä¸­ä½¿ç”¨ï¼Œè€Œæ˜¯ä»<code class="eh ks kt ku kv b">props</code>ä¸­ä½¿ç”¨ã€‚å¥½å¤šäº†ï¼</p><p id="5c7e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¯¹äºåŒ…è£…çš„ç»„ä»¶æ¥è¯´ï¼Œèƒ½å¤Ÿæ”¹å˜æ‰€ä½¿ç”¨çš„çˆ¶çŠ¶æ€æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™æ ·ï¼Œæ‚¨å°±å¯ä»¥ä¿æŒç”Ÿå‘½å‘¨æœŸï¼Œå¹¶å¯ä»¥åˆ›å»ºæ–°çš„æ–¹æ³•æ¥æ›´æ–°çŠ¶æ€ã€‚è¿™æ„å‘³ç€å®Œå…¨é‡ç”¨çŠ¶æ€ã€‚</p><blockquote class="lh li lj"><p id="9cac" class="jv jw lg jx b jy jz iv ka kb kc iy kd lk kf kg kh ll kj kk kl lm kn ko kp kq hn dt translated"><strong class="jx hv">æ³¨æ„</strong> <code class="eh ks kt ku kv b"><em class="hu">selectItem</em></code>æ˜¯é¢å¤–å®ç°çš„ï¼Œè¿™æ ·è¢«åŒ…è£…çš„ç»„ä»¶å¯ä»¥æ”¹å˜<code class="eh ks kt ku kv b"><em class="hu">selectedIndex</em></code>ï¼Œå°±åƒå®ƒæ˜¯å…¶çŠ¶æ€çš„ä¸€éƒ¨åˆ†ä¸€æ ·ã€‚é‚£æ˜¯ï¼é‡è¦ã€‚</p></blockquote><p id="0c10" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æ°´å¹³åˆ—è¡¨çš„å¤–è§‚ã€‚</p><pre class="jk jl jm jn fq kw kv kx ky aw kz dt"><span id="e9a5" class="la lb hu kv b fv lc ld l le lf"><strong class="kv hv">class </strong>ListHorizontal <strong class="kv hv">extends </strong>Component {<br/>  <em class="lg">customNextItem </em>= () =&gt; {<br/>    <em class="lg">// Not really custom -_-<br/>    </em><strong class="kv hv">const </strong>{selectedIndex, selectItem} = <strong class="kv hv">this</strong>.<strong class="kv hv">props</strong>;<br/>    selectItem(selectedIndex + 1);<br/>  }</span><span id="6a36" class="la lb hu kv b fv ln ld l le lf">  render() {<br/>    <strong class="kv hv">const </strong>{selectedIndex, prevItem, selectItem} = <strong class="kv hv">this</strong>.<strong class="kv hv">props</strong>;<br/>    <strong class="kv hv">return </strong>(<br/>      &lt;<strong class="kv hv">div</strong>&gt;<br/>        &lt;<strong class="kv hv">img src="https://imgflip.com/s/meme/Troll-Face.jpg" alt="Horizontal list" </strong>/&gt;<br/>        &lt;<strong class="kv hv">div</strong>&gt;Selected item index: {selectedIndex}&lt;/<strong class="kv hv">div</strong>&gt;<br/>        &lt;<strong class="kv hv">span onClick=</strong>{prevItem}&gt;Prev item&lt;/<strong class="kv hv">span</strong>&gt;<br/>        &lt;<strong class="kv hv">span onClick=</strong>{<strong class="kv hv">this</strong>.<em class="lg">customNextItem</em>}&gt;Next item&lt;/<strong class="kv hv">span</strong>&gt;<br/>      &lt;/<strong class="kv hv">div</strong>&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="3524" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å°±æ˜¯è¿™æ ·ï¼ç®€å•å¹²å‡€ã€‚ä¸€åˆ‡éƒ½åœ¨<code class="eh ks kt ku kv b">withList</code> HOCä¸­å®ç°ï¼Œç°åœ¨å¯ä»¥å¾ˆå®¹æ˜“åœ°åº”ç”¨äºä»»ä½•ç»„ä»¶ã€‚HOCæœ€ç¾å¥½çš„ä¸€ç‚¹å°±æ˜¯ï¼Œæƒ³åŒ…å¤šå°‘åŒ…å¤šå°‘ï¼</p><p id="80b4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å®¶åº­ä½œä¸š:ç°åœ¨åˆ—è¡¨çœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ</p><p id="b1d3" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è§‚å¯Ÿå’Œé¢„å…ˆè¯„è®º:</p><ul class=""><li id="5a39" class="lo lp hu jx b jy jz kb kc ke lq ki lr km ls kq lt lu lv lw dt translated">æˆ‘å‘ç°ä½¿ç”¨HOCæ¯”ä½¿ç”¨å®¹å™¨æ›´çµæ´»ğŸ‘</li><li id="c8ae" class="lo lp hu jx b jy lx kb ly ke lz ki ma km mb kq lt lu lv lw dt translated">æˆ‘çŸ¥é“CSSå¯ä»¥å®ç°æ¨ªå‘å’Œçºµå‘åˆ—è¡¨ğŸ˜’</li><li id="d4af" class="lo lp hu jx b jy lx kb ly ke lz ki ma km mb kq lt lu lv lw dt translated">ä¸Šé¢çš„ä»£ç è¿˜æ²¡æœ‰è¿è¡ŒğŸ˜±</li><li id="f7a7" class="lo lp hu jx b jy lx kb ly ke lz ki ma km mb kq lt lu lv lw dt translated">ä¸è¦è®©æˆ‘å†™ä¸€ä¸ªæ‰©å±•åˆ—è¡¨çš„ä¾‹å­ğŸ˜</li><li id="3d0d" class="lo lp hu jx b jy lx kb ly ke lz ki ma km mb kq lt lu lv lw dt translated">ç¼ºç‚¹æ˜¯ä½¿ç”¨<code class="eh ks kt ku kv b">ref</code>ğŸ˜­</li></ul><p id="e979" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">éƒ½è¯»è¿‡ã€‚å‘œå“‡ï¼</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mc md l"/></div></figure></div></div>    
</body>
</html>