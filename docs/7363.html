<html>
<head>
<title>Redux TDD: a deep dive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux TDD:æ·±åº¦æ½œæ°´</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/redux-tdd-a-deep-dive-344cd7682a54?source=collection_archive---------11-----------------------#2017-10-25">https://medium.com/hackernoon/redux-tdd-a-deep-dive-344cd7682a54?source=collection_archive---------11-----------------------#2017-10-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="2541" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">è¿™æ˜¯å¯¹</em><a class="ae jq" href="https://github.com/lmatteis/redux-tdd" rel="noopener ugc nofollow" target="_blank"><em class="jp">redux-TDD</em></a><em class="jp">é¡¹ç›®åŠå…¶APIå¦‚ä½•å·¥ä½œçš„æè¿°ã€‚å¦‚æœä½ æ­£åœ¨å¯»æ‰¾å…³äºreduxæµ‹è¯•é©±åŠ¨å¼€å‘çš„æ›´é«˜å±‚æ¬¡çš„è§£é‡Šï¼Œè¯·æŸ¥çœ‹</em> <a class="ae jq" href="https://medium.freecodecamp.org/test-driven-development-with-react-and-redux-using-redux-tdd-3fd3be299918" rel="noopener ugc nofollow" target="_blank"> <em class="jp">æˆ‘çš„freeCodeCampæ–‡ç« </em> </a> <em class="jp">ã€‚</em></p><p id="6c5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jq" href="https://github.com/lmatteis/redux-tdd" rel="noopener ugc nofollow" target="_blank"> Redux TDD </a>æ˜¯ä¸€ä¸ªç®€å•çš„åº“ï¼Œè®©ä½ ä»¥æµ‹è¯•é©±åŠ¨çš„<a class="ae jq" href="https://hackernoon.com/tagged/development" rel="noopener ugc nofollow" target="_blank">å¼€å‘</a> (TDD)æ–¹å¼æµ‹è¯•<a class="ae jq" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"> React </a>ç»„ä»¶ä»¥åŠReduxæ•°æ®æµã€‚</p><p id="e3b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">åœ¨APIçš„å‡ æ¬¡è¿­ä»£ä¹‹åï¼Œæˆ‘æƒ³åˆ°äº†ä¸€ä¸ªç®€å•çš„æŠ½è±¡ï¼Œå®ƒä¸å¤ªå…³æ³¨ç»„ä»¶æˆ–çŠ¶æ€çš„å®ç°ç»†èŠ‚ï¼Œè€Œæ˜¯æ›´å¤šåœ°å…³æ³¨åˆ†æ´¾çš„åŠ¨ä½œå’Œç»„ä»¶åº”è¯¥æ¥æ”¶çš„é“å…·:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="0a52" class="ka kb hu jw b fv kc kd l ke kf">import <strong class="jw hv">reduxTdd</strong> from 'redux-tdd';<br/><br/><strong class="jw hv">reduxTdd</strong>({ counter: counterReducer }, state =&gt; [<br/>  &lt;Counter<br/>    onClick={incrementAction}<br/>    counter={state.counter.count} /&gt;<br/>])<br/>.<strong class="jw hv">action</strong>(props =&gt; props.onClick())<br/>.<strong class="jw hv">toMatchProps</strong>({ counter: 1 })<br/>.<strong class="jw hv">contains</strong>(&lt;span&gt;1&lt;/span&gt;)</span></pre><p id="e8a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬<a class="ae jq" href="http://airbnb.io/enzyme/docs/api/shallow.html" rel="noopener ugc nofollow" target="_blank">æµ…æ¸²æŸ“</a>(æ¥è‡ªenzyme)äº†<strong class="it hv">è®¡æ•°å™¨</strong>ç»„ä»¶ï¼Œå¹¶å‘å…¶ä¼ é€’æ˜ å°„åˆ°çŠ¶æ€ç‰¹å®šéƒ¨åˆ†çš„é“å…·ã€‚</p><p id="1678" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">è®¡æ•°å™¨</strong>å±æ€§æ˜ å°„åˆ°çŠ¶æ€å€¼<strong class="it hv"> state.counter.count </strong>ã€‚äº‹å®ä¸Šï¼Œ<code class="eh kg kh ki jw b">state =&gt; []</code>å‡½æ•°ä¸ä»…å……å½“æˆ‘ä»¬çš„æ¸²æŸ“å‡½æ•°ï¼Œè¿˜å……å½“æˆ‘ä»¬çš„<strong class="it hv"> mapStateToProps </strong>å‡½æ•°ã€‚</p><p id="6cb1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°reduxTddé‡‡ç”¨æˆ‘ä»¬çš„reducersï¼Œå› æ­¤æˆ‘ä»¬çš„çŠ¶æ€çš„å½¢çŠ¶ã€‚</p><p id="d911" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ¥ä¸‹æ¥æˆ‘ä»¬ç§°ä¹‹ä¸º<code class="eh kg kh ki jw b">.action(props =&gt; props.onClick())</code>,è¿™æ˜¯å¥‡è¿¹å‘ç”Ÿçš„åœ°æ–¹ã€‚ä¼ é€’ç»™<strong class="it hv"> action </strong>æ“ä½œç¬¦çš„å›è°ƒæ‰€è¿”å›çš„ä»»ä½•å†…å®¹éƒ½å°†è¢«è°ƒåº¦(å°½ç®¡æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨reduxçš„è°ƒåº¦â€”â€”ç¨åä¼šè¯¦ç»†ä»‹ç»)ã€‚</p><p id="1af1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å› æ­¤ï¼ŒåŠ¨ä½œæ“ä½œç¬¦å°†æ›´æ–°å†…éƒ¨çŠ¶æ€ï¼Œå¹¶æ ¹æ®è¿™ç§æ–°çŠ¶æ€æ›´æ–°ç»„ä»¶çš„å±æ€§ã€‚</p><p id="be6e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> toMatchProps </strong>å’Œ<strong class="it hv"> contains </strong>æ­¤æ—¶åªéœ€æ£€æŸ¥æˆ‘ä»¬çš„ç»„ä»¶åœ¨åŠ¨ä½œè¢«è°ƒåº¦åæ˜¯å¦æ”¶åˆ°äº†æ­£ç¡®çš„å€¼ã€‚</p></div><div class="ab cl kj kk hc kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hn ho hp hq hr"><h1 id="8210" class="kq kb hu bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">TodoListç¤ºä¾‹</h1><p id="ed0d" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">åœ¨ä¸‹ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†å°è¯•ä»¥TDDçš„æ–¹å¼å®ç°ä¸€ä¸ªç®€å•çš„TodoListè¿˜æœ‰ä»€ä¹ˆğŸ˜„ï¼Ÿ</p><p id="d8a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬é¦–å…ˆç®€å•åœ°å°†å°šä¸å­˜åœ¨çš„TodoListç»„ä»¶ä¼ é€’ç»™reduxTdd:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="7e23" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({}, state =&gt; [ &lt;TodoList /&gt; ])</span></pre><p id="36ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬çš„åˆ—è¡¨é¡¹å¯èƒ½å­˜åœ¨äºstateä¸­ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è®©æˆ‘ä»¬å¼•å…¥ä¸€ä¸ª<code class="eh kg kh ki jw b">list</code>ç¼©å‡å™¨ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªåä¸ºâ€œlist itemsâ€çš„é“å…·ä¼ é€’ç»™æˆ‘ä»¬çš„ç»„ä»¶ã€‚</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="0d57" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({ list }, state =&gt; [ &lt;TodoList listItems={state.list} /&gt; ])</span></pre><p id="8ee0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿è¡Œè¿™ä¸ªå½“ç„¶ä¼šå¤±è´¥ï¼Œå› ä¸ºè¿˜æ²¡æœ‰å®ç°ä»»ä½•ä¸œè¥¿ï¼Œä½†æ˜¯è®©æˆ‘ä»¬åœ¨å®ç°æˆ‘ä»¬çš„é€»è¾‘ä¹‹å‰å†™æ›´å¤šçš„æµ‹è¯•ã€‚</p><p id="7c33" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">todo-listæ„å‘³ç€æœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ todoï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä¹Ÿæ·»åŠ ä¸€ä¸ªAddTodoç»„ä»¶(è®°ä½æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æµ‹è¯•å¤šä¸ªç»„ä»¶):</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="82a9" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({ list }, state =&gt; [ <br/>  &lt;TodoList listItems={state.list} /&gt;,<br/>  &lt;AddTodo onAdd={addTodo} /&gt;<br/>])</span></pre><p id="0a4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¾ˆå¥½ï¼Œç°åœ¨è®©æˆ‘ä»¬ç»§ç»­ä¸Šé¢ä¾‹å­ä¸­çš„ç‚¹é“¾æ¥ï¼Œå¹¶é€šè¿‡è°ƒç”¨<code class="eh kg kh ki jw b">onAdd</code>åŠ¨ä½œåˆ›å»ºå™¨æ¥å®é™…æ¨¡æ‹Ÿæ·»åŠ ä¸€ä¸ªtodo:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="9607" class="ka kb hu jw b fv kc kd l ke kf">.it('should add todo items')<br/>.switch(AddTodo) // the next dot-chained calls will work on AddTodo<br/>.action(props =&gt; props.onAdd('clean house')) // add 'clean house'</span></pre><p id="b1d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥ä¼šåœ¨TodoListçœ‹åˆ°â€œæ¸…æ´ä¹‹å®¶â€todoï¼Œå¯¹å—ï¼Ÿè®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="77f8" class="ka kb hu jw b fv kc kd l ke kf">.switch(TodoList) // back to TodoList<br/>.toMatchProps({ listItems: ["clean house"] })</span></pre><p id="1e00" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬ç”šè‡³å¯ä»¥æ·»åŠ å¦ä¸€ä¸ªtodo:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="652f" class="ka kb hu jw b fv kc kd l ke kf">.switch(AddTodo).action(props =&gt; props.onAdd('water plants'))<br/>.switch(TodoList).toMatchProps({ listItems: [<br/>  "clean house",<br/>  "water plants"<br/>]})</span></pre><p id="8156" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¾ˆå¥½ï¼Œè¿™å°±è¶³å¤Ÿäº†ï¼Œè®©æˆ‘ä»¬è¿è¡Œè¿™æ®µä»£ç ï¼Œå¼€å§‹å®ç°æˆ‘ä»¬çš„ç»„ä»¶ã€å‡å°‘å™¨å’ŒåŠ¨ä½œ:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="5bf3" class="ka kb hu jw b fv kc kd l ke kf">const TodoList = ({ listItems }) =&gt; <br/>  &lt;div&gt;{listItems.map(item =&gt; &lt;div&gt;{item}&lt;/div&gt;)}&lt;/div&gt;</span><span id="a1b0" class="ka kb hu jw b fv ls kd l ke kf">const AddTodo = ({ onAdd }) =&gt;<br/>  &lt;button onClick={onAdd}&gt;add todo&lt;/button&gt;</span></pre><p id="b0ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">(æç¤º:AddTodoä¸­æœ‰æ„çœç•¥äº†æ–‡æœ¬è¾“å…¥é€»è¾‘)</p><p id="73f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬çš„addTodoæ“ä½œ:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="c01a" class="ka kb hu jw b fv kc kd l ke kf">function addTodo(todoText) {<br/>  return { type: 'ADD_TODO', payload: todoText }<br/>}</span></pre><p id="c74f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æœ€åæ˜¯æˆ‘ä»¬çš„å‡é€Ÿå™¨:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="1dab" class="ka kb hu jw b fv kc kd l ke kf">function list(state = {}, action) {<br/>  switch (action.type) {<br/>    case 'ADD_TODO':<br/>      return { ...state, [action.payload]: {} }<br/>    default:<br/>      return state<br/>  }<br/>}</span></pre><p id="7110" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¦‚æœæˆ‘ä»¬å†æ¬¡è¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œæœ‰äº›äº‹æƒ…ä¼šå¤±è´¥:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="131f" class="ka kb hu jw b fv kc kd l ke kf">TypeError: listItems.map is not a function</span></pre><p id="d95d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„state.listæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†listItemså±æ€§éœ€è¦ä¸€ä¸ªæ•°ç»„ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜(å¦‚æœä½ æ„¿æ„ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨<a class="ae jq" href="https://github.com/reactjs/reselect" rel="noopener ugc nofollow" target="_blank">é‡æ–°é€‰æ‹©</a>)â¤ï¸</p><p id="157b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">åœ¨æˆ‘ä»¬æœ€åˆçš„reduxTddå®šä¹‰ä¸­ï¼Œè®©æˆ‘ä»¬æ”¹å˜çŠ¶æ€æ˜ å°„åˆ°TodoListç»„ä»¶çš„propsçš„æ–¹å¼:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="1a39" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({ list }, state =&gt; [ <br/>  &lt;TodoList listItems={getVisibleItems(state)} /&gt;,</span></pre><p id="1a6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">é€‰æ‹©å™¨:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="76ee" class="ka kb hu jw b fv kc kd l ke kf">function getVisibleItems(state) {<br/>  return Object.keys(state.list).length<br/>    ? Object.keys(state.list).map(key =&gt; key)<br/>    : []<br/>}</span></pre><p id="cf9c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="6dfa" class="ka kb hu jw b fv kc kd l ke kf">TodoList<br/>    âœ“ should add todo items (1ms)</span></pre><h1 id="f147" class="kq kb hu bd kr ks lt ku kv kw lu ky kz la lv lc ld le lw lg lh li lx lk ll lm dt">ğŸ‰</h1><p id="c415" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">è®©æˆ‘ä»¬ä¹ŸTDDä¸€ä¸‹â€œå°†å¾…åŠäº‹é¡¹è®¾ç½®ä¸ºå®Œæ•´â€çš„æƒ³æ³•ã€‚</p><p id="8182" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä¸ºæ­¤ï¼Œæˆ‘è®¤ä¸ºåº”è¯¥æœ‰ä¸€ä¸ªTodoItemç»„ä»¶ï¼Œæ˜¯å¯ç‚¹å‡»çš„å§ï¼Ÿè®©æˆ‘ä»¬å°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„åˆå§‹åˆ—è¡¨ä¸­:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="9fcd" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({ list }, state =&gt; [<br/>  &lt;TodoList listItems={getVisibleItems(state)} /&gt;,<br/>  &lt;AddTodo onAdd={addTodo} /&gt;,<br/>  &lt;TodoItem onClick={completeTodo} /&gt;<br/>])</span></pre><p id="9821" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼TodoItemå¿…é¡»çŸ¥é“å®ƒå¿…é¡»å®Œæˆå“ªä¸€é¡¹ã€‚å®ƒå¿…é¡»å¯¹å•ä¸ªé¡¹ç›®èµ·ä½œç”¨ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„çŠ¶æ€ä¸­ï¼Œæˆ‘ä»¬ä¿ç•™ä¸€ä¸ªå¯¹è±¡ï¼è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä»state.listå¯¹è±¡ä¸­ä¼ é€’ä¸€ä¸ªæ¡ç›®:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="b150" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({ list }, state =&gt; [<br/>  &lt;TodoList listItems={getVisibleItems(state)} /&gt;,<br/>  &lt;AddTodo onAdd={addTodo} /&gt;,<br/>  &lt;TodoItem onClick={completeTodo} <strong class="jw hv">item</strong>={state.list['water plants']}    <br/>/&gt;<br/>])</span></pre><p id="2abf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å…¶æ ‡è®°ä¸ºå®Œæˆ:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="7e00" class="ka kb hu jw b fv kc kd l ke kf">.switch(TodoItem)<br/>.action(props =&gt; props.onClick('water plants'))</span></pre><p id="8882" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ­¤æ—¶ï¼Œæˆ‘ä»¬æ„è¯†åˆ°æˆ‘ä»¬çš„TodoListç»„ä»¶æ— æ³•æ˜¾ç¤ºè¯¥é¡¹æ˜¯å¦å®Œæ•´(åº”è¯¥æœ‰ä¸€æ¡åˆ é™¤çº¿)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ–°çš„â€œcompletedItemsâ€å±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œæ•´é¡¹ç›®çš„æ•°ç»„:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="475c" class="ka kb hu jw b fv kc kd l ke kf">.switch(TodoList)<br/>.toMatchProps({ <br/>  listItems: ["clean house", "water plants"] <br/>  <strong class="jw hv">completedItems</strong>: ["water plants"]<br/>})</span></pre><p id="5736" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬å†æ¬¡æ”¹å˜æˆ‘ä»¬çš„å®šä¹‰æ¥ä¸ºè¿™æ ·çš„è¡Œä¸ºå·¥ä½œ:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="7857" class="ka kb hu jw b fv kc kd l ke kf">reduxTdd({ list }, state =&gt; [<br/>  &lt;TodoList <br/>    listItems={getVisibleItems(state)} <br/>    completedItems={getCompletedItems(state)} /&gt;,<br/>...</span></pre><p id="9d7f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¦‚æœæˆ‘ä»¬è¿è¡Œæµ‹è¯•ï¼Œä»–ä»¬ä¼šå‘Šè¯‰æˆ‘ä»¬ä¸€äº›éœ€è¦å®ç°çš„ä¸œè¥¿ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„completeTodoæ“ä½œåˆ›å»ºå™¨:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="f806" class="ka kb hu jw b fv kc kd l ke kf">function completeTodo(todoText) {<br/>  return { type: 'COMPLETE_TODO', payload: todoText }<br/>}</span></pre><p id="32ac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬ç›¸åº”åœ°æ›´æ–°äº†æˆ‘ä»¬çš„å‡é€Ÿå™¨:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="b171" class="ka kb hu jw b fv kc kd l ke kf">function list(state = {}, action) {<br/>  switch (action.type) {<br/>    case 'ADD_TODO':<br/>      return { ...state, [action.payload]: {} }<br/>    case 'COMPLETE_TODO':<br/>      return { ...state, [action.payload]: { status: 'complete' } }<br/>    default:<br/>      return state<br/>  }<br/>}</span></pre><p id="e26c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å†æ¬¡è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•å°†å‘Šè¯‰æˆ‘ä»¬getCompletedItemsä¸¢å¤±äº†:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="7bd2" class="ka kb hu jw b fv kc kd l ke kf">function getCompletedItems(state) {<br/>  return Object.keys(state.list)<br/>    .map(item =&gt; state.list[item])<br/>    .filter(item =&gt; item.status === 'complete')<br/>}</span></pre><p id="58f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬å®Œäº‹äº†ã€‚</p><p id="45b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œä½¿ç”¨å…¶ä»–æ“ä½œç¬¦ï¼Œå¦‚<strong class="it hv"> contains </strong>å’Œ<strong class="it hv"> view </strong>æ¥æµ‹è¯•UIä¸­æ›´ç»†ç²’åº¦çš„éƒ¨åˆ†ã€‚ä½†æ˜¯æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„ä¸»è¦éƒ¨åˆ†æ˜¯ä»¥TDDçš„æ–¹å¼ä¸€æ­¥ä¸€æ­¥å®ç°çš„ã€‚</p><p id="67e1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…äº‹å…ˆå°±æˆ‘ä»¬çš„çŠ¶æ€æˆ–é“å…·åšå‡ºå¤æ‚çš„å·¥ç¨‹å†³ç­–ã€‚æˆ‘ä»¬åœ¨å‰è¿›çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨çœ‹åˆ°éœ€è¦çš„æ—¶å€™ï¼Œå®æ–½äº†è¿™äº›æªæ–½ã€‚</p><p id="bb9f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘å¸Œæœ›è¿™äº›ä¾‹å­èƒ½å¸®åŠ©æ‚¨ç†è§£Redux TDDèƒŒåçš„æ€æƒ³ï¼Œä»¥åŠå¦‚ä½•åœ¨æ‚¨è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨å®ƒã€‚è¦æŸ¥çœ‹æ›´å¤æ‚çš„ç¤ºä¾‹ï¼Œè¯·æŸ¥çœ‹repoä¸­çš„<a class="ae jq" href="https://github.com/lmatteis/redux-tdd/tree/master/test" rel="noopener ugc nofollow" target="_blank"> tests/ </a>æ–‡ä»¶å¤¹ã€‚ä½ ä¼šå‘ç°å¦ä¸€ä¸ªé‡è¦çš„æ“ä½œç¬¦å«åš<strong class="it hv"> epic </strong>ï¼Œå®ƒå¯ä»¥ç”¨æ¥æµ‹è¯•å¼‚æ­¥è¡Œä¸ºï¼</p><p id="5265" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è°¢è°¢ï¼ŒTDDå¿«ä¹ğŸ¤—</p><figure class="jr js jt ju fq ly"><div class="bz el l di"><div class="lz ma l"/></div></figure></div></div>    
</body>
</html>