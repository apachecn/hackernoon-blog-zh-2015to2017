<html>
<head>
<title>Quick &amp; Easy Elixir Refactorings â€” Part 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¿«é€Ÿç®€å•çš„çµä¸¹å¦™è¯é‡æ„â€”ç¬¬4éƒ¨åˆ†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/quick-easy-elixir-refactorings-part-4-4096a8022988?source=collection_archive---------8-----------------------#2017-12-02">https://medium.com/hackernoon/quick-easy-elixir-refactorings-part-4-4096a8022988?source=collection_archive---------8-----------------------#2017-12-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="d59d" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">åµŒå¥—æ¡ä»¶å¥</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/05c2abf945219e3f34063fdf06591b64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Go_cRIV7eO_KC4djZ71bg.jpeg"/></div></div></figure><p id="98c7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">åœ¨å‰ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†å¦‚ä½•é€šè¿‡ä¼ å…¥ä¸€ä¸ªå‡½æ•°æ¥é‡æ„å‡½æ•°ä¸­é—´çš„æ¡ä»¶ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬çœ‹äº†åœ¨å‡½æ•°çš„å¼€å¤´å’Œç»“å°¾é‡æ„T4æ¡ä»¶å¥ã€‚</p><p id="edc7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœä½ è¿˜æ²¡æœ‰é€šè¯»è¿™ä¸ªç³»åˆ—ï¼Œæˆ‘å»ºè®®ä½ ä»å¤´å¼€å§‹</p><p id="3775" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><a class="ae kr" rel="noopener" href="/@efexen/quick-easy-elixir-refactorings-part-1-17376e9c455a">ç¬¬1éƒ¨åˆ†â€”ä»¥æ¡ä»¶</a> <a class="ae kr" rel="noopener" href="/@efexen/quick-easy-elixir-refactorings-part-2-4cd66bad1b20"> <br/>å¼€å¤´çš„å‡½æ•°ç¬¬2éƒ¨åˆ†â€”ä»¥æ¡ä»¶</a> <br/> <a class="ae kr" rel="noopener" href="/@efexen/quick-easy-elixir-refactorings-part-3-def1aae4b072">ç»“å°¾çš„å‡½æ•°ç¬¬3éƒ¨åˆ†â€”ä¸­é—´çš„æ¡ä»¶</a></p><p id="4a4c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å¦‚ä½•å¤„ç†åµŒå¥—æ¡ä»¶å¥ã€‚æœ‰äººè®¤ä¸ºæˆ‘ä¸å–œæ¬¢æ¡ä»¶å¥ï¼Œè¿™æ˜¯å¯ä»¥ç†è§£çš„ğŸ˜‰</p></div><div class="ab cl ks kt hc ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hn ho hp hq hr"><h2 id="c64a" class="kz la hu bd lb lc ld le lf lg lh li lj ke lk ll lm ki ln lo lp km lq lr ls lt dt translated">åµŒå¥—æ¡ä»¶å¥</h2><p id="3508" class="pw-post-body-paragraph jv jw hu jx b jy lu iv ka kb lv iy kd ke lw kg kh ki lx kk kl km ly ko kp kq hn dt translated">åµŒå¥—æ¡ä»¶åœ¨å…¶ä»–è¯­è¨€ä¸­æ˜¯ä¸€ä¸ªå¤§å¾—å¤šçš„é—®é¢˜ï¼Œé€šå¸¸æ˜¯å› ä¸ºå‡½æ•°å¤ªé•¿ï¼Œåº”è¯¥å·²ç»è¢«æ‹†åˆ†äº†ï¼Œä½†æœ‰æ—¶ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæœ€å¥½æœ‰ä¸€ç§ç®€æ´çš„æ–¹æ³•æ¥å¤„ç†å®ƒä»¬ã€‚</p><p id="0c50" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä¸€ä¸ªä¾‹å­å¯èƒ½æ˜¯è¿™æ ·çš„</p><pre class="jk jl jm jn fq lz ma mb mc aw md dt"><span id="ebf5" class="kz la hu ma b fv me mf l mg mh">defmodule Example do</span><span id="d7ac" class="kz la hu ma b fv mi mf l mg mh">  def authorised?(user) do<br/>    case UserAuthenticator.authorised?(user) do<br/>      {:ok, _user} -&gt;<br/>        true<br/>      {:error, _user} -&gt;<br/>        case LegacyUserAuthenticator.authorised?(user) do<br/>          {:ok, _user} -&gt;<br/>            true<br/>          {:error, _user} -&gt;<br/>            false<br/>        end<br/>    end<br/>  end</span><span id="8b70" class="kz la hu ma b fv mi mf l mg mh">end</span></pre><p id="14aa" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è¿™æ®µä»£ç å¹¶ä¸ååˆ†ä¼˜é›…ï¼Œé˜…è¯»èµ·æ¥ä¹Ÿæœ‰ç‚¹æ£˜æ‰‹ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ä¸è¿”å›ç®€å•çš„å¸ƒå°”å€¼ï¼Œè€Œæ˜¯æ‰§è¡Œä¸€äº›æ›´é•¿çš„é€»è¾‘ğŸ˜“</p><p id="9641" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·æ‹†åˆ†<code class="eh mj mk ml ma b">authorised?/1</code>å‡½æ•°æ¥æ¶ˆé™¤åµŒå¥—</p><pre class="jk jl jm jn fq lz ma mb mc aw md dt"><span id="7ed1" class="kz la hu ma b fv me mf l mg mh">def authorised?(user) do<br/>  case UserAuthenticator.authorised?(user) do<br/>    {:ok, _user} -&gt;<br/>      true<br/>    {:error, _} -&gt;<br/>      legacy_authorized?(user)<br/>  end<br/>end</span><span id="bb13" class="kz la hu ma b fv mi mf l mg mh">defp legacy_authorized?(user) do<br/>  case LegacyAuthenticator.authorised?(user) do<br/>    {:ok, _user} -&gt;<br/>      true<br/>    {:error, _} -&gt;<br/>      false<br/>  end<br/>end</span></pre><p id="8c23" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä¸‡å²ï¼Œä¸å†ç­‘å·¢ğŸ™Œé€šè¿‡ä½¿ç”¨æœ¬ç³»åˆ—å‰é¢çš„æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨æ¶ˆé™¤æ¡ä»¶å¥ï¼Œå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„ç»“æœ</p><pre class="jk jl jm jn fq lz ma mb mc aw md dt"><span id="cf4e" class="kz la hu ma b fv me mf l mg mh">def authorised?(user) do<br/>  user<br/>  |&gt; UserAuthenticator.authorised?()<br/>  |&gt; check_authorised()<br/>end</span><span id="396a" class="kz la hu ma b fv mi mf l mg mh">def check_authorised({:ok, _}), do: true<br/>def check_authorised({:error, user}) do<br/>  user<br/>  |&gt; LegacyAuthenticator.authorised?()<br/>  |&gt; check_legacy()<br/>end</span><span id="a01d" class="kz la hu ma b fv mi mf l mg mh">def check_legacy({:ok, _}), do: true<br/>def check_legacy(_), do: false</span></pre><p id="7b03" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å½“ä½ åœ¨åˆå§‹æ¡ä»¶çš„ä¸¤ä¸ªåˆ†æ”¯ä¸­éƒ½æœ‰åµŒå¥—çš„æ—¶å€™ï¼Œè¿™å¾ˆå¥½ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æŠŠæ‰€æœ‰çš„åˆ†æ”¯éƒ½æ”¾åœ¨å¾ˆå¤šå°å‡½æ•°ä¸Šã€‚</p><p id="82e6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¹¸è¿çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªåˆ†æ”¯ä¸­çš„åµŒå¥—æ¡ä»¶ï¼Œè¿™å…è®¸æˆ‘ä»¬ä½¿ç”¨<code class="eh mj mk ml ma b">with</code>è¯­å¥æ¥æŸ¥çœ‹æ›¿ä»£é€‰é¡¹</p><pre class="jk jl jm jn fq lz ma mb mc aw md dt"><span id="e99a" class="kz la hu ma b fv me mf l mg mh">def authorised?(user) do<br/>  with {:error, _} &lt;- UserAuthenticator.authorised?(user),<br/>       {:error, _} &lt;- LegacyAuthenticator.authorised?(user) do<br/>         false<br/>       else<br/>         {:ok, _} -&gt; true<br/>       end<br/>  end</span></pre><p id="9c17" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt">ğŸ˜® ğŸ˜</p></div><div class="ab cl ks kt hc ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hn ho hp hq hr"><p id="5a1f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„ä»ç„¶æ˜¯ä¸€ä¸ªæ¡ä»¶ï¼Œä½†æ˜¯ä¸æˆ‘ä»¬ä¸Šé¢çš„é€‰æ‹©ç›¸æ¯”ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è§£å†³åˆå§‹é—®é¢˜çš„æ–¹æ¡ˆã€‚</p><p id="92f3" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœä½ ä¸ç†Ÿæ‚‰<code class="eh mj mk ml ma b">with</code>è¯­å¥ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ å°è¯•ä¸€ä¸‹ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©ä»£ç æ›´å®¹æ˜“æ¨ç†ï¼Œè€Œä¸”è‚¯å®šæ¯”ä¸€å †åµŒå¥—çš„æ¡ä»¶è¯­å¥æ›´æ¸…æ™°ã€‚</p><p id="c202" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è¯·ç‚¹å‡»æŒå£°å›¾æ ‡ğŸ‘å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·åœ¨è¿™é‡Œæˆ–Twitterä¸Šå…³æ³¨æˆ‘ï¼Œ<a class="ae kr" href="https://twitter.com/efexen" rel="noopener ugc nofollow" target="_blank"> @efexen </a>æ¥å¯»æ‰¾ç®€çŸ­çš„å¯æ“ä½œçš„æ–‡ç« ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬ä¼šçœ‹åˆ°æ›´å¤šç®€å•çš„æŠ€å·§æ¥æå‡ä½ çš„<a class="ae kr" href="https://hackernoon.com/tagged/elixir" rel="noopener ugc nofollow" target="_blank">è¯å‰‚</a>ä»£ç ğŸ‘</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mm mn l"/></div></figure></div></div>    
</body>
</html>